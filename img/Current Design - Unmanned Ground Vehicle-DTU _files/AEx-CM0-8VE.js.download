if (self.CavalryLogger) { CavalryLogger.start_js(["cKD9o"]); }

__d("IrisProtocolMessageLifetime",[],(function a(b,c,d,e,f,g){f.exports={TTL_OFF:0,TTL_ON_UNKNOWN:1,TTL_30SECONDS:3e4,TTL_1MINUTE:6e4,TTL_3MINUTES:18e4,TTL_5MINUTES:3e5,TTL_10MINUTES:6e5,TTL_15MINUTES:9e5,TTL_30MINUTES:18e5,TTL_1HOUR:36e5,TTL_2HOURS:72e5,TTL_4HOURS:144e5,TTL_8HOURS:288e5,TTL_12HOURS:432e5,TTL_24HOURS:864e5}}),null);
__d("MercuryAudioType",[],(function a(b,c,d,e,f,g){f.exports={AudioClip:"fb_voice_message",VoiceMessageWithTranscript:"fb_voice_message_with_transcript"}}),null);
__d("MessagingTag",[],(function a(b,c,d,e,f,g){f.exports={GROUPS:"groups",UNREAD:"unread",FLAGGED:"flagged",ACTION_ARCHIVED:"action:archived",INBOX:"inbox",OTHER:"other",PENDING:"pending",MONTAGE:"montage",PAGES:"pages",PAGE_BACKGROUND:"page_background",EVENT:"event",SENT:"sent",SPAM:"spam",UPDATES:"broadcasts_inbox",BCC:"header:bcc",FILTERED_CONTENT:"filtered_content",FILTERED_CONTENT_BH:"filtered_content_bh",FILTERED_CONTENT_ACCOUNT:"filtered_content_account",FILTERED_CONTENT_QUASAR:"filtered_content_quasar",FILTERED_CONTENT_INVALID_APP:"filtered_content_invalid_app",UNAVAILABLE_ATTACHMENT:"unavailable_attachment",ARCHIVED:"archived",EMAIL:"email",VOICEMAIL:"voicemail",SPAM_SPOOFING:"spam:spoofing",SPOOF_WARNING:"MTA:spoof_warning",SMS_TAG_ROOT:"SMSShortcode:",APP_ID_ROOT:"app_id:",DOMAIN_AUTH_PASS:"MTA:dmarc:pass",DOMAIN_AUTH_FAIL:"MTA:dmarc:fail",MTA_SYSTEM_MESSAGE:"MTA:system_message",EMAIL_MESSAGE:"source:email",ONE_CLICK_MESSAGE:"page_one_click_message",MARKETPLACE:"marketplace",ROOM:"room",PAGE_FOLLOWUP:"page_followup",IRIS_MAPPING:{FOLDER_INVALID:null,FOLDER_INBOX:"inbox",FOLDER_OTHER:"other",FOLDER_SPAM:"spam",FOLDER_PENDING:"pending",FOLDER_MONTAGE:"montage",FOLDER_HIDDEN:"hidden",FOLDER_DISABLED:"disabled",FOLDER_PAGE_BACKGROUND:"page_background",FOLDER_PAGE_DONE:"page_done",FOLDER_BLOCKED:"blocked"}}}),null);
__d("StickerConstants",[],(function a(b,c,d,e,f,g){f.exports={MOBILE_LIKE_STICKER_PACK_ID:"227877430692340",GRAVEYARD_PACK_ID:"604597256247273",LIKE_STICKER_ID:"227878347358915",HOT_LIKE_SMALL_STICKER_ID:"369239263222822",HOT_LIKE_MEDIUM_STICKER_ID:"369239343222814",HOT_LIKE_LARGE_STICKER_ID:"369239383222810",MRU_STICKER_PACK:"599061016853145",SEARCH_PACK_ID:"680229632032514",OZ_PACK_ID:"1456625217993235",SPRITE_PADDING:"24",PayloadSource:{VIEW_ACTION:"view-action"},EMOTICON_PACK_ID:"1471127876485636",DEFAULT_FRAME_RATE:83,TRAY_SIZE:64,THREAD_SIZE:120}}),null);
__d("MercuryAttachmentSnippetType",["keyMirror"],(function a(b,c,d,e,f,g,h){var i=h({PHOTO:null,GIF:null,VIDEO:null,AUDIO_CLIP:null,STICKER:null,SHARE:null,ERROR:null,MIXED:null,GIFT:null,THIRDPARTYSTICKER:null,FILE:null,LIKE_STICKER:null});f.exports=i}),null);
__d("MercuryGiftSnippetRenderer",["fbt"],(function a(b,c,d,e,f,g,h){"use strict";var i={renderText:function j(k,l){return k?h._("You sent a Valentine."):h._("{name} sent a Valentine.",[h.param("name",l)])}};f.exports=i}),null);
__d("P2PSnippetStringUtils",["P2PPaymentRequestStatus","P2PTransferStatus","fbt"],(function a(b,c,d,e,f,g,h,i,j){__p&&__p();var k={getRequestCanceledSnippet:function l(m,n,o,p,q){if(m)return j._("Your request for {payment request amount} from {receiver's name} was cancelled.",[j.param("payment request amount",q),j.param("receiver's name",p)]);else if(n)return j._("{requester's name}'s request for {payment request amount} was cancelled.",[j.param("requester's name",o),j.param("payment request amount",q)]);else return j._("{requester's name}'s request for {payment request amount} from {receiver's name} was cancelled.",[j.param("requester's name",o),j.param("payment request amount",q),j.param("receiver's name",p)])},getRequestDeclinedSnippet:function l(m,n,o,p,q){if(m)return j._("{receiver's name} declined your request for {payment request amount}.",[j.param("receiver's name",p),j.param("payment request amount",q)]);else if(n)return j._("You declined {requester's name}'s request for {payment request amount}.",[j.param("requester's name",o),j.param("payment request amount",q)]);else return j._("{receiver's name} declined {sender's name}'s request for {payment request amount}.",[j.param("receiver's name",p),j.param("sender's name",o),j.param("payment request amount",q)])},getRequestSentSnippet:function l(m,n,o,p,q){if(m)return j._("You requested {amount} from {requestee name}.",[j.param("amount",q),j.param("requestee name",p)]);else if(n)return j._("{requester name} requested {amount} from you.",[j.param("requester name",o),j.param("amount",q)]);else return j._("{name} requested {amount} from {requestee name}.",[j.param("name",o),j.param("amount",q),j.param("requestee name",p)])},getRequestSnippetByStatus:function l(m,n,o,p,q,r){var s=m||h.INITED,t=[n,o,p,q,r];switch(s){case h.DECLINED:return this.getRequestDeclinedSnippet.apply(this,t);case h.TRANSFER_FAILED:case h.CANCELED:return this.getRequestCanceledSnippet.apply(this,t)}return this.getRequestSentSnippet.apply(this,t)},getTransferCanceledSnippet:function l(m,n,o,p,q){if(m)return j._("Your payment of {amount} to {receiver_name} was cancelled.",[j.param("amount",q),j.param("receiver_name",p)]);else if(n)return j._("{sender name}'s payment of {amount} was cancelled.",[j.param("sender name",o),j.param("amount",q)]);else return j._("{sender_name}'s payment of {amount} to {receiver_name} was cancelled.",[j.param("sender_name",o),j.param("amount",q),j.param("receiver_name",p)])},getTransferDeclinedSnippet:function l(m,n,o,p,q){if(m)return j._("{receiver_name} didn't accept your payment of {amount}.",[j.param("receiver_name",p),j.param("amount",q)]);else if(n)return j._("You didn't accept {sender name}'s payment of {amount}.",[j.param("sender name",o),j.param("amount",q)]);else return j._("{receiver_name} didn't accept {sender_name}'s payment of {amount}.",[j.param("receiver_name",p),j.param("sender_name",o),j.param("amount",q)])},getTransferSentSnippet:function l(m,n,o,p,q){if(m)return j._("You sent {amount} to {receiver name}.",[j.param("receiver name",p),j.param("amount",q)]);else if(n)return j._("{name} sent {amount} to you.",[j.param("name",o),j.param("amount",q)]);else return j._("{sender name} sent {amount} to {receiver name}.",[j.param("sender name",o),j.param("receiver name",p),j.param("amount",q)])},getTransferSnippetByStatus:function l(m,n,o,p,q,r){var s=[n,o,p,q,r],t=m||i.PENDING_SENDER_INITED;switch(t){case i.CANCELED_DECLINED:return this.getTransferDeclinedSnippet.apply(this,s);case i.CANCELED_SENDER_RISK:case i.CANCELED_RECIPIENT_RISK:case i.CANCELED_SYSTEM_FAIL:case i.CANCELED_EXPIRED:case i.CANCELED_SAME_CARD:return this.getTransferCanceledSnippet.apply(this,s)}return this.getTransferSentSnippet.apply(this,s)}};f.exports=k}),null);
__d("MercuryAttachmentSnippetRenderer",["CurrentUser","MercuryAttachmentSnippetType","MercuryAttachmentType","MercuryAudioType","MercuryGiftSnippetRenderer","MessengerLightweightActionUtils","P2PSnippetStringUtils","StickerConstants","StoryAttachmentStyle","fbt"],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){"use strict";__p&&__p();var r={getAttachmentSnippetType:function s(t){__p&&__p();if(this._hasOnlyPhotos(t))return i.PHOTO;if(this._hasOnlyAnimatedImages(t))return i.GIF;if(this._hasOnlyVideo(t))return i.VIDEO;if(this._hasAudioClip(t))return i.AUDIO_CLIP;if(this._hasLikeSticker(t))return i.LIKE_STICKER;if(this._hasSticker(t))return i.STICKER;if(this._hasThirdPartySticker(t))return i.THIRDPARTYSTICKER;if(this._hasShare(t))return i.SHARE;if(this._hasGift(t))return i.GIFT;if(this._hasError(t))return i.ERROR;if(this._hasFile(t))return i.FILE;return i.MIXED},renderAttachmentSnippetText:function s(t,u,v,w){__p&&__p();switch(t){case i.PHOTO:return this._renderPhotoAttachmentSnippetText(u,v,this._getPhotoAttachments(w));case i.GIF:return this._renderAnimatedImagesAttachmentSnippetText(u,v,this._getAnimatedImageAttachments(w));case i.VIDEO:return u?q._("You sent a video."):q._("{sender name} sent a video.",[q.param("sender name",v)]);case i.AUDIO_CLIP:return u?q._("You sent a voice message."):q._("{name} sent a voice message.",[q.param("name",v)]);case i.STICKER:case i.LIKE_STICKER:case i.THIRDPARTYSTICKER:return u?q._("You sent a sticker."):q._("{name} sent a sticker.",[q.param("name",v)]);case i.SHARE:if(w&&this._hasP2PPayment(w))return this._renderP2PPaymentSnippetText(w[0]);if(w&&this._hasP2PPaymentRequest(w))return this._renderP2PPaymentRequestSnippetText(w[0]);if(w&&this._hasBusinessMessage(w))return this._renderBusinessMessageSnippetText(w[0],v);if(w&&this._hasLocation(w))return u?q._("You sent a location."):q._("{sender name} sent a location.",[q.param("sender name",v)]);if(w&&this._hasLiveLocation(w))return u?q._("You sent a live location."):q._("{sender name} sent a live location.",[q.param("sender name",v)]);if(w&&w.length===1&&m.isLWAAttachment(w[0]))return m.getLWASnippetText(w);return u?q._("You sent a link."):q._("{sender name} sent a link.",[q.param("sender name",v)]);case i.GIFT:return l.renderText(u,v);case i.FILE:return u?q._("You sent an attachment."):q._("{sender name} sent an attachment.",[q.param("sender name",v)]);case i.ERROR:return u?q._("You sent an attachment."):q._("{sender name} sent an attachment.",[q.param("sender name",v)]);default:return""}},_hasOnlyPhotos:function s(t){return this._getPhotoAttachments(t).length===t.length},_hasThirdPartySticker:function s(t){return t.length===1&&t[0].attach_type===j.THIRDPARTYSTICKER},_hasOnlyAnimatedImages:function s(t){return this._getAnimatedImageAttachments(t).length===t.length},_hasOnlyVideo:function s(t){return t.length===1&&t[0].attach_type===j.VIDEO},_hasAudioClip:function s(t){var u=t[0].metadata&&t[0].metadata.type;return t.length===1&&(u===k.AudioClip||u===k.VoiceMessageWithTranscript)},_hasBusinessMessage:function s(t){return this._hasSingleShareAttachmentOfStyle(t,p.BUSINESS_MESSAGE_ITEMS)},_hasSticker:function s(t){return t.length===1&&t[0].attach_type===j.STICKER},_hasLikeSticker:function s(t){if(t.length<1)return false;var u=t[0].metadata&&t[0].metadata.stickerID;return t.length===1&&(u==o.LIKE_STICKER_ID||u==o.HOT_LIKE_SMALL_STICKER_ID||u==o.HOT_LIKE_MEDIUM_STICKER_ID||u==o.HOT_LIKE_LARGE_STICKER_ID)},_hasLocation:function s(t){return this._hasSingleShareAttachmentOfStyle(t,p.MESSAGE_LOCATION)},_hasLiveLocation:function s(t){return this._hasSingleShareAttachmentOfStyle(t,p.MESSAGE_LIVE_LOCATION)},_hasP2PPayment:function s(t){return this._hasSingleShareAttachmentOfStyle(t,p.ORION)},_hasP2PPaymentRequest:function s(t){return this._hasSingleShareAttachmentOfStyle(t,p.ORION_REQUEST)},_hasSingleShareAttachmentOfStyle:function s(t,u){return t.length===1&&t[0].attach_type===j.SHARE&&t[0].share.style_list.indexOf(u)>=0},_hasShare:function s(t){return t.length===1&&t[0].attach_type===j.SHARE},_hasError:function s(t){return t.length===1&&t[0].attach_type===j.ERROR},_hasGift:function s(t){return t.length===1&&t[0].attach_type===j.GIFT},_hasFile:function s(t){return t.length===1&&t[0].attach_type===j.FILE},_getPhotoAttachments:function s(t){if(!t)return[];return t.filter(function(u){return u.attach_type===j.PHOTO})},_getAnimatedImageAttachments:function s(t){if(!t)return[];return t.filter(function(u){return u.attach_type===j.ANIMATED_IMAGE})},_renderPhotoAttachmentSnippetText:function s(t,u,v){if(v.length===1)if(t)return q._("You sent a photo.");else return q._("{name} sent a photo.",[q.param("name",u)]);else if(t)return q._({"*":"You sent {num_photos} photos."},[q.param("num_photos",v.length,[0])]);else return q._({"*":"{name} sent {num_photos} photos."},[q.param("name",u),q.param("num_photos",v.length,[0])])},_renderAnimatedImagesAttachmentSnippetText:function s(t,u,v){if(v.length===1)if(t)return q._("You sent a GIF.");else return q._("{name} sent a GIF.",[q.param("name",u)]);else if(t)return q._("You sent {num_animated_images} GIFs.",[q.param("num_animated_images",v.length)]);else return q._("{name} sent {num_animated_images} GIFs.",[q.param("name",u),q.param("num_animated_images",v.length)])},_renderBusinessMessageSnippetText:function s(t,u){var v=t.share.target,w=v&&v.message||q._("{sender name} sent an attachment.",[q.param("sender name",u)]);return w},_renderP2PPaymentSnippetText:function s(t){var u=t.share.target;return this.renderP2PPaymentSnippetText(h.getID()===u.sender.id,u.sender.name,u.amountWithSymbol,u.status,h.getID()===u.receiver.id,u.receiver.name)},_renderP2PPaymentRequestSnippetText:function s(t){var u=t.share.target;return this.renderP2PPaymentRequestSnippetText(h.getID()===u.requester.id,u.requester.name,u.amountWithSymbol,u.currentStatus,h.getID()===u.requestee.id,u.requestee.name)},renderP2PPaymentSnippetText:function s(t,u,v,w,x,y){return n.getTransferSnippetByStatus(w,t,x||false,u||"",y||"",v)},renderP2PPaymentRequestSnippetText:function s(t,u,v,w,x,y){return n.getRequestSnippetByStatus(w,t,x||false,u||"",y||"",v)}};f.exports=r}),null);
__d("MMessagePayload",["ChannelEventType","CurrentUser","MercuryAttachmentSnippetRenderer","MercuryAttachmentType","MercuryAudioType","P2PPaymentRequestStatus","P2PTransferStatus","StoryAttachmentStyle","fbt","formatDate","idx"],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){"use strict";__p&&__p();var s=25,t=1e3,u="g:ia";function v(w){this.$MMessagePayload1=w}v.prototype.isPageMessage=function(){return this.$MMessagePayload1.type===h.PAGES_MESSAGE};v.prototype.getThreadFBID=function(){return this.$MMessagePayload1.thread_fbid&&this.$MMessagePayload1.thread_fbid.toString()};v.prototype.getHref=function(){return this.$MMessagePayload1.href};v.prototype.getAuthorFBID=function(){return this.$MMessagePayload1.sender_fbid.toString()};v.prototype.getAuthorName=function(){return this.$MMessagePayload1.sender_name};v.prototype.getThreadName=function(){return this.$MMessagePayload1.thread_name};v.prototype.getThreadUnreadCount=function(){return this.$MMessagePayload1.thread_unread_count};v.prototype.getSnippet=function(){__p&&__p();var w=this.$MMessagePayload1.body;if(w)if(w.length>s)return p._("{shortened body}{dot dot dot (for truncation)}",[p.param("shortened body",w.substring(0,s)),p.param("dot dot dot (for truncation)","...")]);else return w;var x=this.$MMessagePayload1.attachments.map(function(z){__p&&__p();if(z.sticker_attachment)return{attach_type:k.STICKER,metadata:{stickerID:z.sticker_attachment.id}};else if(z.blob_attachment)if(z.blob_attachment.__typename==="MessageImage")if(z.blob_attachment.render_as_sticker)return{attach_type:k.THIRDPARTYSTICKER};else return{attach_type:k.PHOTO};else if(z.blob_attachment.__typename==="MessageAnimatedImage")return{attach_type:k.ANIMATED_IMAGE};else if(z.blob_attachment.__typename==="MessageVideo")return{attach_type:k.VIDEO};else if(z.blob_attachment.audio_type&&(z.blob_attachment.audio_type==="VOICE_MESSAGE"||z.blob_attachment.audio_type==="VOICE_MESSAGE_WITH_TRANSCRIPT"))return{metadata:{type:l.AudioClip}};else if(z.blob_attachment.__typename==="MessageFile")if(z.blob_attachment.is_malicious)return{attach_type:k.ERROR};else return{attach_type:k.FILE};else return{attach_type:k.UNKNOWN};else if(z.extensible_attachment)if(z.extensible_attachment.story_attachment){var A,B=z.extensible_attachment.story_attachment,C=B.target,D=(A=C)!=null?A.__typename:A;if(D==="MessengerBusinessMessage"){var E;return{share:{style_list:B.style_list,target:{message:(E=C)!=null?E.message:E}},attach_type:k.SHARE}}else if(D==="PeerToPeerPaymentRequest"){var F,G,H,I,J,K,L=(F=C)!=null?F.request_status:F;return{share:{style_list:[o.ORION_REQUEST],target:{requester:{id:(G=C)!=null?(G=G.requester)!=null?G.id:G:G,name:(H=C)!=null?(H=H.requester)!=null?H.short_name:H:H},amountWithSymbol:(I=C)!=null?(I=I.amount)!=null?I.formatted:I:I,currentStatus:L?m[L]:null,requestee:{id:(J=C)!=null?(J=J.requestee)!=null?J.id:J:J,name:(K=C)!=null?(K=K.requestee)!=null?K.short_name:K:K}}},attach_type:k.SHARE}}else if(D==="PeerToPeerTransfer"){var M,N,O,P,Q,R=(M=C)!=null?M.transfer_status:M;return{share:{style_list:[o.ORION],target:{sender:(N=C)!=null?N.sender:N,amountWithSymbol:(O=C)!=null?(O=O.transaction_amount)!=null?O.formatted_amount:O:O,status:R?n[R]:null,receiver:{id:(P=C)!=null?(P=P.receiver_profile)!=null?P.id:P:P,name:(Q=C)!=null?(Q=Q.receiver_profile)!=null?Q.short_name:Q:Q}}},attach_type:k.SHARE}}else if(D==="MessageLiveLocation")return{share:{style_list:[o.MESSAGE_LIVE_LOCATION]},attach_type:k.SHARE};else if(D==="MessageLocation")return{share:{style_list:[o.MESSAGE_LOCATION]},attach_type:k.SHARE};return{attach_type:k.SHARE}}else return{attach_type:k.SHARE};else return{attach_type:k.UNKNOWN}}),y=j.getAttachmentSnippetType(x);return j.renderAttachmentSnippetText(y,this.getAuthorFBID()===i.getID(),this.getAuthorName(),x)};v.prototype.getMessage=function(){return this.$MMessagePayload1.body};v.prototype.getTime=function(){return q(this.$MMessagePayload1.timestamp/t,u)};v.prototype.getTimestamp=function(){return this.$MMessagePayload1.timestamp.toString()};v.prototype.getUUID=function(){return this.$MMessagePayload1.message_id};v.prototype.getFolder=function(){return this.$MMessagePayload1.folder};v.prototype.getMessageSource=function(){return this.$MMessagePayload1.source};v.prototype.getParticipantIDs=function(){var w=this.$MMessagePayload1.participant_ids||[];return w.map(function(x){return x.toString()})};v.prototype.hasThreadImage=function(){return this.$MMessagePayload1.has_thread_image};v.prototype.getAttachmentCount=function(){return this.$MMessagePayload1.attachments.length};v.prototype.getAttachments=function(){return this.$MMessagePayload1.attachments};v.prototype.isCanonicalThread=function(){return!!this.$MMessagePayload1.is_canonical};v.prototype.isUnread=function(){return this.$MMessagePayload1.is_unread};v.prototype.getOtherUserFBID=function(){__p&&__p();var w=this.$MMessagePayload1.participant_ids;if(!this.isCanonicalThread())return null;else if(w.length===1)return w[0].toString();else{if(w[0].toString()===i.getID()){if(this.isPageMessage())return w[0].toString();return w[1].toString()}return w[0].toString()}};v.prototype.getThreadNameWithUnreadCount=function(){if(!this.getThreadUnreadCount())return this.getThreadName();return p._("{thread name} ({unread count})",[p.param("thread name",this.getThreadName()),p.param("unread count",this.getThreadUnreadCount())])};f.exports=v}),null);
__d("MMessagesChannelPayloadPreparer",["Promise","MercuryIDs","MMessagePayload","MMessagesConfig","MMessagesThreadDataStore","MShortProfiles","StoryAttachmentStyle","Stratcom"],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){"use strict";__p&&__p();var p={fetchDataThenDispatch:function q(r){__p&&__p();r.message.folder=r.folder;r.message.sender_fbid=i.getUserIDFromParticipantID(r.message.author);if(k.msite_genie_xma_rendering)this._processGenieMessage(r.message);var s=r.targetFBID?r.targetFBID:r.realtime_viewer_fbid.toString(),t=[new h(function(u,v){var w=l.getForFBID(s);w.getForNewMessage(r.message.other_user_fbid,r.message.thread_fbid,r.message.message_id,r.message.is_unread,function(x){u(x)})}),new h(function(u,v){m.get(r.message.sender_fbid.toString(),function(w){u(w)})})];h.all(t).done(function(u){var v=u[0],w=u[1];Object.assign(r.message,{is_muted:v.mute_until!==undefined,thread_name:v.thread_name,participant_ids:v.participant_ids,has_thread_image:v.has_thread_image,is_canonical:v.is_canonical,href:v.href,thread_unread_count:v.thread_unread_count,pages_is_flagged:v.pages_is_flagged,sender_name:w.name,type:r.type});r.parsedPayload=new j(r.message);o.invoke(r.type,null,r)})},_processGenieMessage:function q(r){__p&&__p();if(!r.has_attachment||!r.attachments)return;for(var s=r.attachments.length-1;s>=0;s-=1){var t=r.attachments[s];if(!t.share||!t.share.style_list||t.share.style_list[0]!=n.GENIE_MESSAGE)continue;if(t.share.target.genie_id){r.sender_fbid=t.share.target.genie_id;r.sender="fbid:"+t.share.target.genie_id}if(t.share.target.genie_name)r.sender_name=t.share.target.genie_name;if(t.share.target&&!t.share.target.attachment){r.attachments.splice(s,1);r.has_attachment=r.attachments.length>0}}}};f.exports=p}),null);
__d("MercuryMessageCustomizations",[],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(j,k){var l=j.customizations;if(!l)return null;var m=l.filter(function(n){return n.customization_type===k});return m.length>0?m[0].customization_value:null}function i(j){var k=JSON.parse(j),l=[];Object.keys(k).forEach(function(m){l.push({customization_type:m,customization_value:k[m]})});return l}f.exports={getCustomizationValue:h,parseCustomizations:i}}),null);
__d("MercuryProfileRanges",["idx"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();function i(j){if(!j.id&&j.i)return{id:j.i,offset:j.o,length:j.l};return j}f.exports={extractFromDelta:function j(k){var l,m=(l=k)!=null?(l=l.data)!=null?l.prng:l:l;if(!m)return undefined;var n=[];try{n=JSON.parse(m);if(n.length>0)return n.map(i)}catch(o){}return n}}}),null);
__d("MercuryTimestamp",["MercuryTimePassed","fbt","formatDate"],(function a(b,c,d,e,f,g,h,i,j){__p&&__p();var k=864e5,l=6*k,m={getFormatedTimestamp:function n(o){var p=o/1e3;return m.getFormattedTimestampByBucket(p,this.getTimeBucket(o))},getAbsoluteTimestamp:function n(o){if(o==null)return null;else{var p=m.getFormatedTimestamp(o);return p.absolute}},getRelativeTimestamp:function n(o){var p=m.getFormatedTimestamp(o);return p.relative},getFormattedTimestampByBucket:function n(o,p){switch(p){case h.TODAY:return{absolute:i._("Today"),relative:j(o,"g:ia")};case h.WEEK_AGO:return{absolute:j(o,"l"),relative:j(o,"D")};case h.CURRENT_YEAR:return{absolute:j(o,"F j"),relative:j(o,"M j")};default:return{absolute:j(o,"F j, Y"),relative:j(o,"n/j/y")}}},getTimeBucket:function n(o){var p=new Date(o),q=new Date(),r=new Date(q.getFullYear(),q.getMonth(),q.getDate());if(r<p)return h.TODAY;else if(r-l<p)return h.WEEK_AGO;else if(r.getFullYear()===p.getFullYear())return h.CURRENT_YEAR;else return h.OTHER_YEAR},getPreciseTimestamp:function n(o){return j(new Date(o),m.getPreciseFormat(o))},getPreciseFormat:function n(o){var p=m.getTimeBucket(o);switch(p){case h.TODAY:return"g:ia";case h.WEEK_AGO:return"l g:ia";case h.CURRENT_YEAR:return"F jS, g:ia";case h.OTHER_YEAR:default:return"F j, Y g:i a"}}};f.exports=m}),null);
__d("MercurySyncDeltaTypes",[],(function a(b,c,d,e,f,g){"use strict";var h={AdminAddedToGroupThread:"AdminAddedToGroupThread",AdminRemovedFromGroupThread:"AdminRemovedFromGroupThread",AdminTextMessage:"AdminTextMessage",ChangeViewerStatus:"ChangeViewerStatus",DeliveryReceipt:"DeliveryReceipt",ForcedFetch:"ForcedFetch",MarkRead:"MarkRead",MarkUnread:"MarkUnread",MarkFolderSeen:"MarkFolderSeen",MessageDelete:"MessageDelete",NewMessage:"NewMessage",NoOp:"NoOp",PagesManagerEvent:"PagesManagerEvent",ParticipantLeftGroupThread:"ParticipantLeftGroupThread",ParticipantsAddedToGroupThread:"ParticipantsAddedToGroupThread",ReadReceipt:"ReadReceipt",ReplaceMessage:"ReplaceMessage",RTCEventLog:"RTCEventLog",ThreadAction:"ThreadAction",ThreadDelete:"ThreadDelete",ThreadFolder:"ThreadFolder",ThreadMuteSettings:"ThreadMuteSettings",ThreadName:"ThreadName",JoinableMode:"JoinableMode",ApprovalMode:"ApprovalMode",ApprovalQueue:"ApprovalQueue",ClientPayload:"ClientPayload",GenieMessage:"GenieMessage",MontageMessage:"MontageMessage",RtcCallData:"RtcCallData"};f.exports=h}),null);
__d("MercurySyncMarkFolderSeenTransformer",["MercuryGlobalActionType","MessagingTag"],(function a(b,c,d,e,f,g,h,i){"use strict";function j(k){return k.folders.map(function(l){return{action_type:h.MARK_ALL_SEEN,folder:i.IRIS_MAPPING[l],timestamp:parseInt(k.timestamp,10)}})}f.exports={transform:j}}),null);
__d("MercurySyncMarkReadTransformer",["MercuryActionType","MercuryGlobalActionType","MessagingTag"],(function a(b,c,d,e,f,g,h,i,j){"use strict";function k(l){if(l.folders&&l.folders.length>0)return l.folders.map(function(m){return{action_type:i.MARK_ALL_READ,action_id:null,folder:j.IRIS_MAPPING[m],timestamp:parseInt(l.watermarkTimestamp,10)}});return l.threadKeys.map(function(m){return{action_type:h.CHANGE_READ_STATUS,other_user_fbid:m.otherUserFbId,thread_fbid:m.threadFbId,mark_as_read:true,timestamp:parseInt(l.watermarkTimestamp,10),folder:j.INBOX}})}f.exports={transform:k}}),null);
__d("MercurySyncMarkUnreadTransformer",["MercuryActionType","MessagingTag"],(function a(b,c,d,e,f,g,h,i){"use strict";function j(k){return k.threadKeys.map(function(l){return{action_type:h.CHANGE_READ_STATUS,other_user_fbid:l.otherUserFbId,thread_fbid:l.threadFbId,mark_as_read:false,timestamp:parseInt(k.watermarkTimestamp,10),folder:i.INBOX}})}f.exports={transform:j}}),null);
__d("MercurySyncPagesManagerEventTransformer",["MercuryActionType","PagesMessagingEventType"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();function j(k){var l=JSON.parse(k.jsonBlob),m=l&&l.type;if(!m)return undefined;switch(m){case i.FLAG:var n=!!(l&&l.flagData&&l.flagData.state),o={action_type:h.CHANGE_FLAG,mark_as_flag:n,other_user_fbid:k.threadKey.otherUserFbId,thread_fbid:k.threadKey.threadFbId};return o;default:return undefined}}f.exports={transform:j}}),null);
__d("MercurySyncReadReceiptTransformer",[],(function a(b,c,d,e,f,g){"use strict";function h(i){var j={watermark:parseInt(i.watermarkTimestampMs,10),action:parseInt(i.actionTimestampMs,10)},k=i.threadKey.otherUserFbId||i.actorFbId,l=i.threadKey.otherUserFbId||i.threadKey.threadFbId,m={roger:{}};m.roger[l]={};m.roger[l][k]=j;return m}f.exports={transform:h}}),null);
__d("MMercurySyncDispatcher",["ChannelEventType","CurrentUser","MessagingEvent","MessagingTag","MercuryGlobalActionType","MercuryActionType","MercurySingletonProvider","MercurySyncDeltaTypes","MercurySyncMarkFolderSeenTransformer","MercurySyncMarkReadTransformer","MercurySyncMarkUnreadTransformer","MMercurySyncNewMessageTransformer","MercurySyncPagesManagerEventTransformer","MercurySyncReadReceiptTransformer","MMercurySyncReplaceMessageTransformer","MMessagesChannelPayloadPreparer","MMessagesReadReceipts","MMessagesThreadDataStore","MReplaceMessageProcessor","Stratcom","emptyFunction"],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B){"use strict";__p&&__p();C.getForFBID=function(E){return D.getForFBID(E)};C.get=function(){return D.get()};function C(E){this.$MMercurySyncDispatcher1=E;this.$MMercurySyncDispatcher2=i.getAccountID()===this.$MMercurySyncDispatcher1?h.MESSAGE:h.PAGES_MESSAGE}C.prototype.process=function(E){__p&&__p();var F=void 0,G=void 0;switch(E["class"]){case o.NewMessage:F=s.transform(this.$MMercurySyncDispatcher1,E);G={message:F,type:this.$MMercurySyncDispatcher2,folder:k.INBOX,targetFBID:this.$MMercurySyncDispatcher1};w.fetchDataThenDispatch(G);break;case o.MarkUnread:F=r.transform(E);F.map(function(J){G={message:J,type:this.$MMercurySyncDispatcher2,event:j.UNREAD,is_sync:true,targetFBID:this.$MMercurySyncDispatcher1};A.invoke(G.type,null,G)}.bind(this));break;case o.MarkRead:F=q.transform(E);F.map(function(J){if(J.action_type===l.MARK_ALL_READ)y.getForFBID(this.$MMercurySyncDispatcher1).clearAllUnread();else y.getForFBID(this.$MMercurySyncDispatcher1).clearUnreadCount(J.other_user_fbid,J.thread_fbid,B);G={message:J,type:this.$MMercurySyncDispatcher2,event:J.action_type===l.MARK_ALL_READ?j.MARK_ALL_READ:j.READ,is_sync:true,targetFBID:this.$MMercurySyncDispatcher1};A.invoke(G.type,null,G)}.bind(this));break;case o.MarkFolderSeen:F=p.transform(E);F.map(function(J){G={message:J,type:this.$MMercurySyncDispatcher2,event:j.MARK_ALL_SEEN,is_sync:true,targetFBID:this.$MMercurySyncDispatcher1};A.invoke(G.type,null,G)}.bind(this));break;case o.ReadReceipt:F=u.transform(E);var H=Object.keys(F.roger)[0],I=F.roger[H];x.update(H,I);G={message:F,type:this.$MMercurySyncDispatcher2,event:j.READ_RECEIPT,is_sync:true,targetFBID:this.$MMercurySyncDispatcher1};A.invoke(G.type,null,G);break;case o.PagesManagerEvent:F=t.transform(E);if(!F||F.action_type!==m.CHANGE_FLAG)return;y.getForFBID(this.$MMercurySyncDispatcher1).updateFlagStatus(F.other_user_fbid,null,F.mark_as_flag,B);G={event:h.PAGE_THREAD_FLAG_CHANGED,flagged:F.mark_as_flag,other_user_fbid:F.other_user_fbid,type:h.PAGES_MESSAGE};A.invoke(G.type,null,G);break;case o.ReplaceMessage:F=v.transform(this.$MMercurySyncDispatcher1,E);G={message:F,type:this.$MMercurySyncDispatcher2,folder:k.INBOX,targetFBID:this.$MMercurySyncDispatcher1};z.process(G);break;default:break}};var D=new n(C);f.exports=C}),null);
__d("MTouchChannelPayloadRouter",["ChannelEventType","MessagingEvent","MMercurySyncDispatcher","Stratcom"],(function a(b,c,d,e,f,g,h,i,j,k){"use strict";__p&&__p();function l(q){if(m(q)||o(q)||p(q))return;else if(n(q)){var r=q.queue.toString();j.getForFBID(r).process(q.delta)}else k.invoke(q.type,null,q)}function m(q){return(q.type===h.MESSAGE||q.type===h.PAGES_MESSAGE)&&q.message}function n(q){return q.type===h.DELTA}function o(q){return(q.type===h.MESSAGE||q.type===h.PAGES_MESSAGE)&&q.event===i.READ}function p(q){return q.type===h.PAGES_MESSAGE&&q.event===h.PAGE_THREAD_FLAG_CHANGED}g.route=l}),null);