if (self.CavalryLogger) { CavalryLogger.start_js(["C\/Z6W"]); }

__d("MInitJewelCounts",["Stratcom"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=[],j=false;function k(n){h.invoke("m:jewels:init-counts",null,n)}function l(n){k(n);if(!j)i.push(n)}function m(){if(j)return;j=true;var n=i.splice(0,i.length);n.forEach(function(o){k(o)})}f.exports={main:l,replayMissedEvents:m}}),null);
__d("Popover",["setTimeoutAcrossTransitions","CSS","DOM","MAria","MViewport","Stratcom","Vector","$","eventsMixinDeprecated"],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){__p&&__p();var q=40;function r(s){"use strict";__p&&__p();var t=s.flyout;this.flyout=typeof t=="string"?o(t):t;this.content=j.scry(this.flyout,"div","flyout-content")[0];this.options=s;this._onOrientationChange=this._reposition.bind(this);this.jewelRedirect=s.jewelRedirect;i.conditionClass(this.flyout,"popover_flyout",true);var u=s.button;if(u){this.button=typeof u=="string"?o(u):u;this.buttonClickListener=j.listen(this.button,"click",null,this._openHandler.bind(this));this.button.setAttribute("role","button");k.setupPopup(this.button,this.flyout)}var v=s.flyoutAnchor;if(v)this.flyoutAnchor=typeof v=="string"?o(v):v;else this.flyoutAnchor=this.button;if(this.options.flyoutFromRoot)this.flyoutClickListener=j.listen(this.flyout,"click",null,this._openHandler.bind(this));if(this.options.touchstart_callback)this.flyoutTouchStartListener=j.listen(this.flyout,"touchstart",null,this._touchStartHandler.bind(this));if(this.options.touchmove_callback)this.flyoutTouchMoveListener=j.listen(this.flyout,"touchmove",null,this._touchMoveHandler.bind(this));if(this.options.touchend_callback)this.flyoutTouchEndListener=j.listen(this.flyout,"touchend",null,this._touchEndHandler.bind(this));r._instances[this.flyout.id]=this}r.prototype.isOpen=function(){"use strict";return!!this._isOpen};r.prototype.open=function(){"use strict";__p&&__p();if(this.isOpen())return;if(r._activePopover)r._activePopover.close();r._activePopover=this;this._isOpen=true;this.constraint=null;if(!this.jewelRedirect)i.conditionClass(this.flyout,"popover_hidden",false);if(this.options.flyoutFromRoot)this._absolutePositionFlyout();this._position();if(!this.options.heightConstraint){i.conditionClass(document.body,"disableClicks",true);this.globalListener=m.listenCapture("click",null,this._closeHandler.bind(this))}window.addEventListener("orientationchange",this._onOrientationChange,false);k.showPopup(this.button,this.flyout);if(this.options.ensureVisible){var s=l.getScrollTop(),t=this._getElementPosition(this.flyout).y,u=t+this.flyout.offsetHeight,v=u-(s+l.getUseableHeight());if(v>0){var w=Math.min(v,Math.max(t-s-q,0));l.scrollTo(0,s+w)}}this.invoke("open")};r.prototype.close=function(s){"use strict";__p&&__p();if(!this.isOpen())return;r._activePopover=null;this._isOpen=false;i.conditionClass(this.flyout,"popover_hidden",true);if(this.options.flyoutFromRoot){this.flyoutParent.appendChild(this.flyout);delete this.flyoutParent}h(function(){i.conditionClass(document.body,"disableClicks",false)}.bind(this),400);this.globalListener&&this.globalListener.remove();window.removeEventListener("orientationchange",this._onOrientationChange,false);this._releaseConstraint();k.hidePopup(this.button,this.flyout);if(!s)this.invoke("close")};r.prototype.clear=function(){"use strict";this.globalListener&&this.globalListener.remove();this.buttonClickListener&&this.buttonClickListener.remove();this.flyoutClickListener&&this.flyoutClickListener.remove();this.flyoutTouchStartListener&&this.flyoutTouchStartListener.remove();this.flyoutTouchMoveListener&&this.flyoutTouchMoveListener.remove();this.flyoutTouchEndListener&&this.flyoutTouchEndListener.remove();delete r._instances[this.flyout.id]};r.prototype.refreshConstraints=function(){"use strict";__p&&__p();if(!this._isOpen||this.jewelRedirect)return false;var s=this.flyout;this._releaseConstraint();if(this.options.heightConstraint){s.style.minHeight=l.getUseableHeight()+"px";this.constraint=l.addHeightConstraint(n.getDim(this.content).y+this._getElementPosition(s).y)}else this.constraint=l.addMinHeightConstraint(n.getDim(s).y+this._getElementPosition(s).y+r._MARGIN)};r.prototype._getTouchPoint=function(event){"use strict";var s=event.getRawEvent().targetTouches[0],t={x:s?s.screenX:0,y:s?s.screenY:0};return t};r.prototype._touchStartHandler=function(event){"use strict";this.options.touchstart_callback(this._getTouchPoint(event))};r.prototype._touchMoveHandler=function(event){"use strict";if(this.isOpen())this.options.touchmove_callback(this._getTouchPoint(event))};r.prototype._touchEndHandler=function(event){"use strict";this.options.touchend_callback(this._getTouchPoint(event))};r.prototype._openHandler=function(event){"use strict";__p&&__p();if(!this.jewelRedirect)event.prevent();var s=this.isOpen();if(s&&!this.options.preventClose)this.close();else if(!s){var t=j.scry(document,"input");for(var u=0;u<t.length;u++)t[u].blur();this.open()}};r.prototype._closeHandler=function(event){"use strict";if(!event.getNode("popover"))this.close()};r.prototype._getElementPosition=function(s){"use strict";__p&&__p();var t=s.offsetLeft,u=s.offsetTop;s=s.offsetParent;while(s&&s!==document.documentElement){t+=s.offsetLeft;u+=s.offsetTop;var v=window.getComputedStyle(s);t+=parseInt(v.getPropertyValue("border-left-width").slice(0,-2),10);u+=parseInt(v.getPropertyValue("border-top-width").slice(0,-2),10);s=s.offsetParent}return new n(t,u)};r.prototype._absolutePositionFlyout=function(){"use strict";this.flyoutParent=this.flyout.parentNode;o("root").appendChild(this.flyout);var s=this._getElementPosition(this.flyout.parentNode),t=this._getElementPosition(this.flyoutAnchor),u=n.getDim(this.flyoutAnchor),v=t.y-s.y+u.y;this.flyout.style.position="absolute";this.flyout.style.top=v+"px"};r.prototype._position=function(){"use strict";var s=this.flyout;if(this.flyoutAnchor&&this.options.positionNub){var t=this._getElementPosition(this.flyoutAnchor),u=j.find(this.flyout,"*","nub"),v=n.getDim(u).x,w=n.getDim(this.flyoutAnchor).x,x=this._getElementPosition(s);new n(t.x-x.x+(w-v)/2,0).setPos(u)}this.refreshConstraints()};r.prototype._reposition=function(){"use strict";h(this._position.bind(this),0)};r.prototype._releaseConstraint=function(){"use strict";if(this.constraint){this.constraint.release();this.constraint=null}};r.getInstance=function(s){"use strict";return r._instances[s]};r.clearAll=function(){"use strict";for(var s=0;s<r._instances.length;s++)r._instances[s].clear()};p(r,["open","close"]);Object.assign(r,{_activePopover:null,_MARGIN:40,_instances:{}});f.exports=r}),null);
__d("MJewel",["CSS","DOM","MHistory","MJSEnvironment","MLogState","MTabbable","MViewport","Popover","Stratcom","URI","$","eventsMixinDeprecated","intlNumUtils","setTimeoutAcrossTransitions"],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){__p&&__p();var v=10,w="/friends/center/requests/";function x(y,z){"use strict";this._sigil=y;this.options=z||{};this._jewelNode=r(x.JEWEL_NAV_NODE_ID);this._softState=z.softState||"jewel="+x.nextID++;this._duringInit=false;this.jewelRedirect=z.jewelRedirect;this._createPopover();p.listen("m:history:change",null,this._updateJewelsOnHistoryChange.bind(this))}x.prototype._updateJewelsOnHistoryChange=function(event){"use strict";var y=new q(event.getData().path),z=y.getPath(),A=this.jewelRedirect&&this.isOpen()&&!event.getData().soft&&z===w;if(event.getData().soft===this._softState||A)this._popover&&this._popover.open();else this._popover&&this._popover.close()};x.prototype.isInitialized=function(){"use strict";var y=this.options.contentsSigil||"contents";return!!i.scry(this._jewelNode,"*",y)[0]};x.prototype._getJewelElement=function(){"use strict";return i.find(this._jewelNode,"div",this._sigil)};x.prototype._getCountElement=function(){"use strict";return i.find(this._getJewelElement(),"span","count")};x.prototype._getContentsElement=function(){"use strict";var y=this.options.contentsSigil||"contents";return i.find(this._getJewelElement(),"*",y)};x.prototype._getFlyoutElement=function(){"use strict";return i.find(this._getJewelElement(),"*","flyout")};x.prototype.getCount=function(){"use strict";return this._count};x.prototype.setDuringInit=function(y){"use strict";this._duringInit=y};x.prototype._updateCountElement=function(){"use strict";var y=this._getJewelCount();i.setContent(this._getCountElement(),t.formatNumberWithThousandDelimiters(y||0));var z=this._getJewelElement(),A=this._count>0;h.conditionClass(z,"noCount",!A);h.conditionClass(z,"hasCount",A)};x.prototype.setCount=function(y){"use strict";if(y<0)return;this._count=y;this._updateCountElement()};x.prototype.setHeaderText=function(y,z){"use strict";__p&&__p();if(!y||!z)return;var A=this._getFlyoutElement();if(!A)return;var B=i.scry(A,"*",y)[0];if(!B)return;var C=B.cloneNode(true);C.innerText=z;i.replace(B,C)};x.prototype.handleViewedContent=function(){"use strict";if(this.getCount()>0&&this.isInitialized()){this.setCount(0);this.invoke("cleared")}else this.invoke("jewel_click")};x.prototype.setMenuContent=function(y){"use strict";i.setContent(this._getFlyoutElement(),y);if(this.isOpen())this.handleViewedContent()};x.prototype.prependMenuContent=function(y){"use strict";i.prependContent(this._getContentsElement(),y)};x.prototype.removeMenuContent=function(y){"use strict";var z=document.getElementById(y);if(z)i.remove(z)};x.prototype.updateMenuColor=function(y,z,A){"use strict";A?u(this._updateMenuColor.bind(this,y,z),x.MARK_READ_DELAY):this._updateMenuColor(y,z)};x.prototype._updateMenuColor=function(y,z){"use strict";var A=document.getElementById(y);if(A){h.conditionClass(A,x.M_AREA_LIGHTBLUE,!z);h.conditionClass(A,x.M_AREA_WHITE,z)}};x.prototype._createPopover=function(){"use strict";var y=this._getJewelElement(),z=i.find(y,"div","flyout");this._popover=new o({button:i.find(y,"*","icon"),flyout:z,ensureVisible:false,heightConstraint:true,preventClose:true,jewelRedirect:this.jewelRedirect});this._onOpenListener=this._popover.listen("open",this._onOpen.bind(this));this._onCloseListener=this._popover.listen("close",this._onClose.bind(this));this._popoverClickListener=i.listen(z,"click",null,this._onPopoverClick.bind(this));if(k.IS_ANDROID&&k.GET_OS_VERSION>=4)this._scrollAreaNode=i.scry(z,"div","scroll-area")[0]};x.prototype.clear=function(){"use strict";this._onOpenListener&&this._onOpenListener.remove();this._onCloseListener&&this._onCloseListener.remove();this._popoverClickListener&&this._popoverClickListener.remove();this._popoverTouchStartListener&&this._popoverTouchStartListener.remove();this._touchMoveListener&&this._touchMoveListener.remove();this._touchStartListener&&this._touchStartListener.remove();this._popover&&this._popover.clear()};x.prototype._onPopoverClick=function(event){"use strict";l.updateLink(event,this.options.pos);this.options.clickCallback&&this.options.clickCallback(event)};x.prototype._onPopoverTouchStart=function(event){"use strict";event.kill()};x.prototype._getJewelCount=function(){"use strict";if(this._count>0)return this._count;else return this._unreadCount};x.prototype._onOpen=function(){"use strict";__p&&__p();if(this._scrollAreaNode){n.scrollToHeader();var y=document.documentElement;h.conditionClass(y,"hide-scroll",true);this._scrollAreaNode.style.maxHeight=y.offsetHeight-200+"px"}var z=this._getJewelCount();j.pushSoftState(this._softState);this.handleViewedContent();p.invoke("m:jewel:flyout:open",null,{jewel:this._sigil});h.conditionClass(this._getJewelElement(),"popoverOpen",true);var A=i.find(this._getJewelElement(),"div","flyout");m.focusTabbable(A)};x.prototype._onClose=function(){"use strict";if(this._scrollAreaNode){this._scrollAreaNode.style.minHeight="";h.conditionClass(document.documentElement,"hide-scroll",false)}p.invoke("m:jewel:flyout:close",null,{jewel:this._sigil});h.conditionClass(this._getJewelElement(),"popoverOpen",false);j.popSoftState(this._softState)};x.prototype.isOpen=function(){"use strict";return this._popover&&this._popover.isOpen()};x.prototype.openPopover=function(){"use strict";this._popover&&!this._popover.isOpen()&&this._popover.open()};x.prototype.reregisterListeners=function(){"use strict";var y=this.isOpen();this.clear();this._createPopover();if(y)this._popover.open()};s(x,["cleared","jewel_click"]);Object.assign(x,{M_AREA_WHITE:"acw",M_AREA_LIGHTBLUE:"aclb",MARK_READ_DELAY:3e3,JEWEL_NAV_NODE_ID:"mJewelNav",nextID:0});Object.assign(x.prototype,{_sigil:null,_currentJewel:null,_count:0,_popover:null});f.exports=x}),null);
__d("FriendingSurfaceVisitationTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function a(b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();function k(){this.clear()}k.prototype.log=function(){i.log("logger:FriendingSurfaceVisitationLoggerConfig",this.$FriendingSurfaceVisitationTypedLogger1,h.BASIC)};k.prototype.logVital=function(){i.log("logger:FriendingSurfaceVisitationLoggerConfig",this.$FriendingSurfaceVisitationTypedLogger1,h.VITAL)};k.prototype.clear=function(){this.$FriendingSurfaceVisitationTypedLogger1={};return this};k.prototype.updateData=function(m){this.$FriendingSurfaceVisitationTypedLogger1=babelHelpers["extends"]({},this.$FriendingSurfaceVisitationTypedLogger1,m);return this};k.prototype.setAppVersion=function(m){this.$FriendingSurfaceVisitationTypedLogger1.app_version=m;return this};k.prototype.setBadgeCount=function(m){this.$FriendingSurfaceVisitationTypedLogger1.badge_count=m;return this};k.prototype.setClientTimestamp=function(m){this.$FriendingSurfaceVisitationTypedLogger1.client_timestamp=m;return this};k.prototype.setRawRefTab=function(m){this.$FriendingSurfaceVisitationTypedLogger1.raw_ref_tab=m;return this};k.prototype.setRawTab=function(m){this.$FriendingSurfaceVisitationTypedLogger1.raw_tab=m;return this};k.prototype.setRefPage=function(m){this.$FriendingSurfaceVisitationTypedLogger1.ref_page=m;return this};k.prototype.setSurface=function(m){this.$FriendingSurfaceVisitationTypedLogger1.surface=m;return this};k.prototype.setTargetProfileID=function(m){this.$FriendingSurfaceVisitationTypedLogger1.target_profile_id=m;return this};k.prototype.setVC=function(m){this.$FriendingSurfaceVisitationTypedLogger1.vc=m;return this};var l={app_version:true,badge_count:true,client_timestamp:true,raw_ref_tab:true,raw_tab:true,ref_page:true,surface:true,target_profile_id:true,vc:true};f.exports=k}),null);
__d("XFriendRequestIHEventLoggingController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/requests/interaction_history_logging/",{target_id:{type:"FBID",required:true},log_event:{type:"String",required:true}})}),null);
__d("MFriendRequestIHEventLogger",["DOM","FBJSON","MRequest","XFriendRequestIHEventLoggingController"],(function a(b,c,d,e,f,g,h,i,j,k){__p&&__p();var l={listenToProfileClick:function m(n,o,p){var q=i.parse(n.getAttribute("data-store")),r=q.userid?q.userid.toString():null;h.listen(p,"click",null,function(){this.logClick(r)}.bind(this));h.listen(o,"click",null,function(){this.logClick(r)}.bind(this))},logImpression:function m(n){if(n)this._logEvent(n,"impression")},logClick:function m(n){if(n)this._logEvent(n,"click")},_logEvent:function m(n,event){if(isNaN(n))return;var o=k.getURIBuilder().setFBID("target_id",n).setString("log_event",event).getURI();new j(o).send()}};f.exports=l}),null);
__d("MJewels",[],(function a(b,c,d,e,f,g){f.exports={REQUESTS:"requests",MESSAGES:"messages",NOTIFICATIONS:"notifications",SEARCH:"search",MORE:"more",NEWS_FEED:"news-feed",BOOKMARKS:"bookmarks",VIDEOS:"videos",CASUAL_GROUPS:"casual_groups"}}),null);
__d("XCasualGroupsJewelTabActivityController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/mobile/casual_groups/jewel/update_activity/",{})}),null);
__d("XFBConfirmationCliffTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function a(b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();function k(){this.clear()}k.prototype.log=function(){i.log("logger:XFBConfirmationCliffLoggerConfig",this.$XFBConfirmationCliffTypedLogger1,h.BASIC)};k.prototype.logVital=function(){i.log("logger:XFBConfirmationCliffLoggerConfig",this.$XFBConfirmationCliffTypedLogger1,h.VITAL)};k.prototype.clear=function(){this.$XFBConfirmationCliffTypedLogger1={};return this};k.prototype.updateData=function(m){this.$XFBConfirmationCliffTypedLogger1=babelHelpers["extends"]({},this.$XFBConfirmationCliffTypedLogger1,m);return this};k.prototype.setCliffCaller=function(m){this.$XFBConfirmationCliffTypedLogger1.cliff_caller=m;return this};k.prototype.setError=function(m){this.$XFBConfirmationCliffTypedLogger1.error=m;return this};k.prototype.setSurface=function(m){this.$XFBConfirmationCliffTypedLogger1.surface=m;return this};k.prototype.updateExtraData=function(m){m=j(i.serializeMap(m));i.checkExtraDataFieldNames(m,l);this.$XFBConfirmationCliffTypedLogger1=babelHelpers["extends"]({},this.$XFBConfirmationCliffTypedLogger1,m);return this};k.prototype.addToExtraData=function(m,n){var o={};o[m]=n;return this.updateExtraData(o)};var l={cliff_caller:true,error:true,surface:true};f.exports=k}),null);
__d("XMessagesJewelContentController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/mobile/messages/jewel/content/",{spinner_id:{type:"String",required:true}})}),null);
__d("XNotificationJewelContentController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/mobile/notifications/jewel/content/",{spinner_id:{type:"String",required:true}})}),null);
__d("MJewelSet",["Banzai","BanzaiLogger","ChannelEventType","DOM","EventListener","FriendingSurfaceVisitationTypedLogger","MarauderLogger","MessagingEvent","MFriendRequestIHEventLogger","MInitJewelCounts","MJewel","MJewels","MLegacyDataStore","MLogState","MPymkFunnelLogger","MRequest","MTouchChannelManager","MURI","MViewport","Popover","ScriptPath","Stratcom","XCasualGroupsJewelTabActivityController","XFBConfirmationCliffTypedLogger","XMessagesJewelContentController","XNotificationJewelContentController","fbt","throttle"],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I){__p&&__p();var J={_viewerID:null,_requestsJewel:null,_messagesJewel:null,_notificationsJewel:null,_unseenNotificationIds:{},_unseenThreadIDs:{},_unreadThreadIDs:{},_jewelClickLogListener:null,_messengerCliff:false,_haveInitializedJewels:false,_pymkAndRequestImpressionLogged:false,MSG_ID_PREFIX:"msg_",OTHER_USER_FBID_PREFIX:"other_user_fbid_",THREAD_FBID_PREFIX:"thread_fbid_",NOTIF_ID_PREFIX:"notif_",JEWEL_NAV_NODE_ID:"mJewelNav",JEWEL_NAV_CACHE_KEY:"mJewelNavKey",JEWEL_MSG_LIST:"mJewelMsgThreadContents",_lazyLoadNotificationsReq:null,_lazyLoadMessagesReq:null,_hasCombinedTab:false,_diodeBadgeableQPCount:0,createJewels:function K(L){__p&&__p();if(L.showRequests){J._requestsJewel=new r("requests",{pos:u.CLICK_POSITION_REQUESTS_FLYOUT,softState:s.REQUESTS,jewelRedirect:L.shouldRedirectRequestsJewel},"friends_jewel_module");J._requestsJewel.listen("cleared",J._markRequestsRead);J._requestsJewel.listen("jewel_click",J._logRequestsJewelClick)}if(L.showCasualGroups){J._casualGroupsJewel=new r("casual_groups",{softState:s.CASUAL_GROUPS},"casual_groups_jewel_module");J._casualGroupsJewel.listen("jewel_click",J._updateCasualGroupsTabActivity)}if(L.hasCombinedTab)J._hasCombinedTab=true;J._messagesJewel=new r("messages",{contentsSigil:J.JEWEL_MSG_LIST,pos:u.CLICK_POSITION_MESSAGES_FLYOUT,softState:s.MESSAGES},"messages_jewel_module");J._messagesJewel.listen("cleared",J._markMessagesRead);J._notificationsJewel=new r("notifications",{pos:u.CLICK_POSITION_NOTIFICATIONS_FLYOUT,softState:s.NOTIFICATIONS},"notifications_jewel_module");J._notificationsJewel.listen("cleared",J._markNotificationsSeen);J._jewelClickLogListener=J._notificationsJewel.listen("jewel_click",J._logNotificationJewelClick);C.listen("m:jewel:flyout:open",null,J._onJewelOpen)},openMessageJewel:function K(){J._messagesJewel.openPopover()},setMessengerCliff:function K(L,M,N){J._messengerCliff=L},setMessengerCliffShouldLog:function K(L,M){},markFriendRequestsSeen:function K(event){if(J._requestsJewel===null)return;J._requestsJewel.setCount(0)},updateFriendRequests:function K(event){if(J._requestsJewel===null)return;if(J._requestsJewel.isOpen())return;var L=new w("/ajax/mobile/friends/jewel/requests_markup");L.send()},onAfterUpdateFriendRequests:function K(L){if(J._requestsJewel===null)return;J._setJewelCount(J._requestsJewel,L,J._markRequestsRead);A.getInstance("reqs_flyout").refreshConstraints();if(J._requestsJewel.isOpen()){var M=J._requestsJewel._getContentsElement();J._logPymkAndRequestImpression(M)}},onAfterLoadMoreFriendSuggestions:function K(){if(J._requestsJewel===null)return;A.getInstance("reqs_flyout").refreshConstraints()},onCombinedTabAsyncLoad:function K(){if(J._notificationsJewel&&J._notificationsJewel.isOpen()){var L=J._notificationsJewel._getContentsElement();J._logPymkAndRequestImpression(L)}},_logPymkAndRequestImpression:function K(L){__p&&__p();if(J._pymkAndRequestImpressionLogged)return;J._pymkAndRequestImpressionLogged=true;var M=k.scry(L,"div","undoable-action");for(var N=0;N<M.length;N++){var O=M[N].getAttribute("data-pymk-id");if(O){var P=M[N].getAttribute("data-signature");v.logImpression(O,P,"mobile_jewel")}else{var Q=t.get(M[N]).userid;n.log("request_seen","friend_request_waterfall",{request_id:Q,request_location:"requests_jewel"});p.logImpression(Q?Q.toString():null)}}},refreshNotificationsConstraints:function K(){A.getInstance("notifications_flyout").refreshConstraints()},refreshNotificationsConstraintsOnImageLoad:function K(){var L=document.getElementById("notifications_flyout");if(!L)return;J.refreshNotificationsConstraints();var M=I(J.refreshNotificationsConstraints,500);k.scry(L,"img","notif_thumb").forEach(function(N){var O=l.listen(N,"load",function(){O.remove();M()})})},refreshMessagesConstraints:function K(){A.getInstance("messages_flyout").refreshConstraints()},updateNotification:function K(event){__p&&__p();var L=event.getData();if(L&&L.data){if(L.data.type==="friend_confirmed")return;if(!J._notificationsJewel.isOpen()&&!J._unseenNotificationIds[L.data.alert_id])J._notificationsJewel.setCount(L.data.unread+J._notificationsJewel.getCount());J._notificationsJewel.removeMenuContent(J._getNotifNodeID(L.data.alert_id));J._unseenNotificationIds[L.data.alert_id]=true;if(J._notificationsJewel.isOpen())J._markNotificationsSeen();J._loadNotificationJewelContent()}},updateUnseenNotificationIds:function K(event){__p&&__p();var L=event.getData();if(!L)return;var M=event.getType()=="notifications_read";if(L.alert_ids){var N=0;for(var O=0;O<L.alert_ids.length;O++)if(J._unseenNotificationIds[L.alert_ids[O]]){delete J._unseenNotificationIds[L.alert_ids[O]];M&&J._notificationsJewel.updateMenuColor(J._getNotifNodeID(L.alert_ids[O]),true,false);N++}var P=J._notificationsJewel.getCount();J._notificationsJewel.setCount(P-N)}else{J._notificationsJewel.setCount(0);if(M)for(var Q in J._unseenNotificationIds)J._notificationsJewel.updateMenuColor(J._getNotifNodeID(Q),true,false);J._unseenNotificationIds={}}},updateMessageCounts:function K(event){__p&&__p();var L=event.getData();if(!L)return;if(L.event===o.READ&&L.message.folder==="inbox"){var M=L.message.thread_fbid||L.message.other_user_fbid;delete J._unseenThreadIDs[M];delete J._unreadThreadIDs[M]}else if(L.event===o.UNREAD&&L.message.folder==="inbox"){var N=L.message.thread_fbid||L.message.other_user_fbid;J._unreadThreadIDs[N]=1}else if(L.event===o.MARK_ALL_READ&&L.message.folder==="inbox"){J._unreadThreadIDs={};J._unseenThreadIDs={}}else if(L.event===o.MARK_ALL_SEEN&&L.message.folder==="inbox")J._unseenThreadIDs={};else if(L.parsedPayload&&L.folder==="inbox"){var O=L.parsedPayload;if(!J._viewerIsAParticipant(J._viewerID,O)||O.isUnread()===false||L.message.is_muted)return;var P=O.getThreadFBID()||O.getOtherUserFBID();J._unseenThreadIDs[P]=1;J._unreadThreadIDs[P]=1}else return;var Q=Object.keys(J._unseenThreadIDs).length,R=Object.keys(J._unreadThreadIDs).length;if(!J._messagesJewel.isOpen()&&Q!==J._messagesJewel.getCount())J._messagesJewel.setCount(Q+J._diodeBadgeableQPCount);var S=R>0?H._("Messages ({unread_message_count})",[H.param("unread_message_count",R)]):H._("Messages");J._messagesJewel.setHeaderText("messages_jewel_header_text",S)},updateMessage:function K(event){__p&&__p();var L=event.getData();if(!L)return;if(L.parsedPayload){var M=L.parsedPayload;if(M.getFolder()!=="inbox"||!J._viewerIsAParticipant(J._viewerID,M))return;if(J._messagesJewel.isInitialized()){J._messagesJewel.removeMenuContent(J._getMessageNodeID(M.getOtherUserFBID(),M.getThreadFBID()));if(J._messagesJewel.isOpen())J._markMessagesRead()}J._loadMessagesJewelContent()}else if(L.event===o.READ&&L.is_sync)J._messagesJewel.updateMenuColor(J._getMessageNodeID(L.message.other_user_fbid,L.message.thread_fbid),true,false)},_getMessageNodeID:function K(L,M){L=L?L:"";M=M?M:"";return J.MSG_ID_PREFIX+J.OTHER_USER_FBID_PREFIX+L+J.THREAD_FBID_PREFIX+M},_getNotifNodeID:function K(L){return J.NOTIF_ID_PREFIX+L},_markRequestsRead:function K(){C.invoke("m_requests_jewel_mark_read");var L=new w(new y("/a/jewel_requests_read.php").toString());L.send()},_markMessagesRead:function K(){var L=new w(new y("/a/jewel_messages_read.php").toString());L.send()},_markNotificationsSeen:function K(){__p&&__p();if(J._jewelClickLogListener){J._jewelClickLogListener.remove();J._jewelClickLogListener=null}if(J._hasCombinedTab)J._markRequestsRead();var L=J._unseenNotificationIds;J._unseenNotificationIds={};var M=[];for(var N in L)M.push(N);var O=new w(new y("/a/jewel_notifications_read.php").toString());O.addData({ids:M,count:M.length,seen:true});O.send()},_onJewelOpen:function K(event){__p&&__p();var L=event.getData();if(L&&L.jewel)if(L.jewel==="notifications")J._loadNotificationJewelContent();else if(L.jewel==="messages"){if(J._messengerCliff)new E().setSurface("messenger_seen").log();var M=J._messagesJewel.getCount()-J._diodeBadgeableQPCount;J._messagesJewel.setCount(M);J._diodeBadgeableQPCount=0;J._loadMessagesJewelContent()}B.set("topbar_"+L.jewel)},_loadNotificationJewelContent:function K(){__p&&__p();var L=J._notificationsJewel._getContentsElement(),M="notifications-flyout-loading";if(C.hasSigil(L,M)){var N=G.getURIBuilder().setString("spinner_id",L.getAttribute("id")).getURI();if(!J._lazyLoadNotificationsReq){J._lazyLoadNotificationsReq=new w(N);J._lazyLoadNotificationsReq.listen("finally",function(){J._lazyLoadNotificationsReq=null});J._lazyLoadNotificationsReq.send()}}},_loadMessagesJewelContent:function K(){__p&&__p();var L=J._messagesJewel._getJewelElement(),M="messages-flyout-loading",N=k.scry(L,"*",M);if(N.length>0){var O=F.getURIBuilder().setString("spinner_id",N[0].getAttribute("id")).getURI();if(!J._lazyLoadMessagesReq){J._lazyLoadMessagesReq=new w(O);J._lazyLoadMessagesReq.listen("finally",function(){J._lazyLoadMessagesReq=null});J._lazyLoadMessagesReq.send()}}},_logNotificationJewelClick:function K(){__p&&__p();if(J._jewelClickLogListener){J._jewelClickLogListener.remove();J._jewelClickLogListener=null}if(J._hasCombinedTab){var L=J._notificationsJewel._getContentsElement();J._logRequestsImpessions(L);if(J._notificationsJewel.isOpen())if(!C.hasSigil(L,"notifications-flyout-loading"))J._logPymkAndRequestImpression(L)}new w("/a/jewel_notifications_log.php").addData({click_type:"jewel_click",count:J._notificationsJewel.getCount()}).send()},_updateCasualGroupsTabActivity:function K(){var L=D.getURIBuilder().getURI();if(!J._updateCasualGroupsTabActivityReq){J._updateCasualGroupsTabActivityReq=new w(L);J._updateCasualGroupsTabActivityReq.listen("finally",function(){J._updateCasualGroupsTabActivityReq=null});J._updateCasualGroupsTabActivityReq.send()}J._casualGroupsJewel.setCount(0)},_logRequestsJewelClick:function K(){var L=J._requestsJewel._getContentsElement();J._logRequestsImpessions(L);new m().setSurface("jewel").setBadgeCount(J._requestsJewel.getCount()).log();if(J._requestsJewel.isOpen())if(C.hasSigil(L,"requests-flyout-loading"))new w("/ajax/mobile/friends/jewel/requests_markup").send();else{var M=J._requestsJewel._getContentsElement();J._logPymkAndRequestImpression(M)}},_logRequestsImpessions:function K(L){__p&&__p();if(!L)return;var M=k.scry(L,"div","attachment"),N=[];for(var O=0;O<M.length;O++){var P=M[O].getAttribute("id");if(P&&P.startsWith("m_jewel_req_"))N=N.concat(P.replace("m_jewel_req_",""))}if(N.length){var Q=new w("/friends/requests/log_impressions");Q.setMethod("POST");Q.addData({ids:N.join(","),ref:"m_jewel"});Q.send()}},_viewerIsAParticipant:function K(L,M){if(!M.getParticipantIDs())return false;if(M.getParticipantIDs().indexOf(L)>-1)return true;return M.getParticipantIDs().indexOf(L.toString())>-1},_initJewelCount:function K(L,M,N){L.setDuringInit(true);L.reregisterListeners();J._setJewelCount(L,M,N);L.setDuringInit(false)},_setJewelCount:function K(L,M,N){if(!L.isOpen())L.setCount(M);else if(M)N()},_initJewelCounts:function K(event){__p&&__p();var L=event.getData();J.initJewels(null,null);if(L.viewer_id)J._viewerID=L.viewer_id;if(L.unread_notification_ids)J._unseenNotificationIds=L.unread_notification_ids||{};if(L.unseen_thread_ids)J._unseenThreadIDs=L.unseen_thread_ids.reduce(function(O,P){O[P]=1;return O},{});if(L.unread_thread_ids)J._unreadThreadIDs=L.unread_thread_ids.reduce(function(O,P){O[P]=1;return O},{});if(L.request_count&&J._requestsJewel)J._initJewelCount(J._requestsJewel,L.request_count,J._markRequestsRead);if(L.unseen_thread_ids||L.diode_badgeable_qp_count){var M=L.unseen_thread_ids?L.unseen_thread_ids.length:0,N=M+(L.diode_badgeable_qp_count?L.diode_badgeable_qp_count:0);if(L.diode_badgeable_qp_count)J._diodeBadgeableQPCount=L.diode_badgeable_qp_count;J._initJewelCount(J._messagesJewel,N,J._markMessagesRead)}if(L.notification_count)J._initJewelCount(J._notificationsJewel,L.notification_count,J._markNotificationsSeen)},initJewels:function K(L,M){__p&&__p();if(J._haveInitializedJewels)return;J._haveInitializedJewels=true;x.initialize();J.createJewels(M||{});if(J._requestsJewel){if(!J._friendRequestAddListener)J._friendRequestAddListener=C.listen("jewel_requests_add",null,J.updateFriendRequests);if(!J._friendRequestRemoveListener)J._friendRequestRemoveListener=C.listen("jewel_requests_remove_old",null,J.updateFriendRequests);if(!J._friendAcceptedListener)J._friendAcceptedListener=C.listen("jewel_friending_notifs",null,J.updateFriendRequests);if(!J._friendRequestSeenListener)J._friendRequestSeenListener=C.listen("friend_requests_seen",null,J.markFriendRequestsSeen)}if(!J._notificationListener)J._notificationListener=C.listen("m_notification",null,J.updateNotification);if(!J._notificationRefreshListener)J._notificationRefreshListener=C.listen("m:jewel-set:notifications-jewel:refresh-flyout",null,J.refreshNotificationsConstraints);if(!J._messageListener)J._messageListener=C.listen(j.MESSAGE,null,J.updateMessage);if(!J._messageCountListener)J._messageCountListener=C.listen(j.MESSAGE,null,J.updateMessageCounts);if(!J._notifReadListener)J._notifReadListener=C.listen("notifications_read",null,J.updateUnseenNotificationIds);if(!J._notifSeenListener)J._notifSeenListener=C.listen("notifications_seen",null,J.updateUnseenNotificationIds);if(!J._friendRequestResponseListener)J._friendRequestResponseListener=C.listen("m:requests:refresh",null,function(){var N=J._hasCombinedTab?"notifications_flyout":"reqs_flyout";A.getInstance(N).refreshConstraints()});if(!J._orientationChangeListener)J._orientationChangeListener=C.listen("m:viewport:orientation-change",null,J._onOrientationChange)},_onOrientationChange:function K(){setTimeout(function(){var L=A._activePopover;if(!L)return;if(z.getHeight()+"px"!==L.flyout.style.minHeight)L.refreshConstraints()},800)}};(function(){C.listen("m:jewels:init-counts",null,J._initJewelCounts);q.replayMissedEvents()})();f.exports=J}),null);
__d("MJewelNotifications",["Bootloader","ChannelEventType","MRequest","MURI","Run","Stratcom","SubscriptionsHandler","isFacebookURI"],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){"use strict";__p&&__p();function p(q){this.$MJewelNotifications1=q;this.$MJewelNotifications2=[];this.$MJewelNotifications3=false;this.$MJewelNotifications4=false;this.$MJewelNotifications5=new n();this.$MJewelNotifications5.addSubscriptions(l.onLeave(function(){this.$MJewelNotifications5.release()}.bind(this)),m.listen(i.NOTIFICATIONS_NEW,null,this.onNotificationReceive.bind(this)))}p.prototype.getNotifications=function(){return this.$MJewelNotifications2};p.prototype.registerListeners=function(){this.$MJewelNotifications5.addSubscriptions(m.listen(i.NOTIFICATIONS_READ,null,this.onNotificationRead.bind(this)),m.listen("click","live-notifications",this.onNotificationClick.bind(this)),m.listen("m:jewel:flyout:open",null,this.onJewelOpen.bind(this)))};p.prototype.onJewelOpen=function(event){var q=event.getData(),r=q&&q.jewel&&q.jewel==="notifications";if(r&&this.$MJewelNotifications4)this.updateUI()};p.prototype.onNotificationClick=function(event){var q=event.getNode("live-notification");if(!q)return;var r=q.getAttribute("data-alertid");this.readNotification(r);this.updateUI();new j("/a/jewel_notifications_log.php").addData({click_type:"jewel_notif_click",id:r}).send()};p.prototype.onNotificationRead=function(event){var q=event.getData();if(q&&q.alert_ids){q.alert_ids.forEach(function(r){this.readNotification(r)}.bind(this));this.updateUI()}};p.prototype.readNotification=function(q){this.$MJewelNotifications2.forEach(function(r){if(r.alert_id==q){if(r.unread)this.$MJewelNotifications4=true;r.unread=false}}.bind(this))};p.prototype.addNotification=function(q){this.$MJewelNotifications2=this.$MJewelNotifications2.filter(function(r){return r.alert_id!==q.alert_id});q.timestamp=Date.now();this.$MJewelNotifications2.push(q);this.$MJewelNotifications4=true};p.prototype.onNotificationReceive=function(event){__p&&__p();var q=event.getData();if(q&&q.data){if(q.data.type==="friend_confirmed")return;if(!this.$MJewelNotifications3){this.$MJewelNotifications3=true;this.registerListeners()}this.addNotification(q.data);this.updateUI()}};p.prototype.updateUI=function(){if(!this.$MJewelNotifications3||!this.$MJewelNotifications4)return;h.loadModules(["React","ReactDOM","MJewelNotificationList.react","Popover"],function(q,r,s,t){if(!t.getInstance("notifications_flyout").isOpen())return;var u={notifications:this.$MJewelNotifications2};r.render(q.createElement(s,u),this.$MJewelNotifications1);t.getInstance("notifications_flyout").refreshConstraints();this.$MJewelNotifications4=false}.bind(this),"MJewelNotifications")};f.exports=p}),null);
__d("MJewelThreads",["Bootloader","ChannelEventType","MessagingEvent","Stratcom"],(function a(b,c,d,e,f,g,h,i,j,k){"use strict";__p&&__p();function l(m){this.$MJewelThreads1=m;this.$MJewelThreads2=[];this.$MJewelThreads3=false;this.$MJewelThreads4=false;k.listen(i.MESSAGE,null,this.onMessageEvent.bind(this))}l.prototype.getThreads=function(){return this.$MJewelThreads2};l.prototype.registerListeners=function(){k.listen("click","live-threads",this.onThreadClick.bind(this));k.listen("m:jewel:flyout:open",null,this.onJewelOpen.bind(this))};l.prototype.onJewelOpen=function(event){var m=event.getData(),n=m&&m.jewel&&m.jewel==="messages";if(n&&this.$MJewelThreads4)this.updateUI()};l.prototype.onThreadClick=function(event){var m=event.getNode("live-thread");if(!m)return;this.setThreadReadStatus(m.getAttribute("data-fbid"),m.getAttribute("data-canonical")==="true",true);this.updateUI()};l.prototype.onMessageEvent=function(event){__p&&__p();var m=event.getData();if(m.parsedPayload){var n=m.parsedPayload;if(n.getFolder()!=="inbox")return;if(!this.$MJewelThreads3){this.$MJewelThreads3=true;this.registerListeners()}this.addThread(n)}else if(Object.prototype.hasOwnProperty.call(m,"mark_as_read")){m.other_user_fbids.forEach(function(p){this.setThreadReadStatus(p.toString(),true,m.mark_as_read)}.bind(this));m.thread_fbids.forEach(function(p){this.setThreadReadStatus(p.toString(),false,m.mark_as_read)}.bind(this));this.updateUI()}else if(m.event===j.READ&&m.is_sync){var o=!!m.message.other_user_fbid,p=o?m.message.other_user_fbid:m.message.thread_fbid;this.setThreadReadStatus(p,o,true);this.updateUI()}};l.prototype.addThread=function(m){this.$MJewelThreads2=this.$MJewelThreads2.filter(function(n){var o=n.isCanonicalThread()?n.getOtherUserFBID():n.getThreadFBID();return!this.isSameThread(o,m.isCanonicalThread(),m)}.bind(this));m.unread=m.isUnread();this.$MJewelThreads2.push(m);this.$MJewelThreads4=true;this.updateThreadImage(m)};l.prototype.updateThreadImage=function(m){__p&&__p();h.loadModules(["MMessagesThreadMetadataCache","MShortProfiles"],function(n,o){if(m.hasThreadImage())n.get(m.getThreadFBID(),function(q){m.image_src=q.image_src;this.updateUI()}.bind(this));else{var p=m.isCanonicalThread()?m.getOtherUserFBID():m.getAuthorFBID();o.get(p,function(q){m.image_src=q.mThumbSrcSmall;this.updateUI()}.bind(this))}}.bind(this),"MJewelThreads")};l.prototype.setThreadReadStatus=function(m,n,o){this.$MJewelThreads2.forEach(function(p){if(this.isSameThread(m,n,p)){if(p.unread==o)this.$MJewelThreads4=true;p.unread=!o}}.bind(this))};l.prototype.isSameThread=function(m,n,o){var p=n?o.getOtherUserFBID():o.getThreadFBID();return m==p};l.prototype.updateUI=function(){if(!this.$MJewelThreads3||!this.$MJewelThreads4)return;h.loadModules(["React","ReactDOM","MJewelThreadList.react","Popover"],function(m,n,o,p){if(!p.getInstance("messages_flyout").isOpen())return;var q={threads:this.$MJewelThreads2};n.render(m.createElement(o,q),this.$MJewelThreads1);p.getInstance("messages_flyout").refreshConstraints();this.$MJewelThreads4=false}.bind(this),"MJewelThreads")};f.exports=l}),null);
__d("MRequestsJewelTitleBadge",["CSS","ge","DOM","Stratcom","DataStore"],(function a(b,c,d,e,f,g,h,i,j,k,l){__p&&__p();var m="friends-center-request-item",n={friendingListener:null,init:function o(){__p&&__p();var p=i("m-jewel-requests-title-badge");if(p){var q=parseInt(l.get(p,"count"),10);if(q<=0)h.hide(p)}var r=i("m-friend-center-requests-title-badge");if(r){q=parseInt(l.get(r,"count"),10);if(q<=0)h.hide(r)}if(!this.friendingListener)this.friendingListener=k.listen("m:optimistic-request-response:click",m,this.decrementBadgeCounts)},updateAfterNewReqs:function o(p){var q=i("m-jewel-requests-title-badge");if(q&&p>0){l.set(q,"count",p);h.show(q);j.setContent(q,p)}},decrementBadgeCounts:function o(p){__p&&__p();var q=i("m-jewel-requests-title-badge");if(q){var r=parseInt(l.get(q,"count"),10);r=Math.max(r,0)-1;l.set(q,"count",r);if(r>0){h.show(q);j.setContent(q,r)}else h.hide(q)}var s=i("m-friend-center-requests-title-badge");if(s){r=parseInt(l.get(s,"count"),10);r=Math.max(r,0)-1;l.set(s,"count",r);if(r>0){h.show(s);j.setContent(s,r)}else h.hide(s)}}};f.exports=n}),null);
__d("MSideNavMarauderLogger",["MLegacyDataStore","Stratcom","MarauderLogger","MTouchClick"],(function a(b,c,d,e,f,g,h,i,j,k){__p&&__p();var l="";function m(event){j.toggleModule("sidebar_menu",true)}function n(event){j.toggleModule("sidebar_menu",false)}function o(event){var x=event.getNode("tag:a"),y=event.getNode("tag:div");j.log("open_application","sidebar_menu",{application_link_type:"local_module",display_name:y?y.innerText:"unknown",url:x&&x.href});j.setNavigationModule("sidebar_menu")}function p(){u("session_start")}function q(){u("cancel")}function r(x){__p&&__p();var y=x.getData();if(y.node.rel<=0)return;var z=0,A="",B=h.get(y.node);if(B){z=B.bootstrap?1:0;A=B.type}var C=0,D=null;for(var E=0;E<y.results.length;E++){var F=y.results[E];if(F.rel>0){if(F.rel==y.node.rel){D=C;break}C++}}u("click",{query:y.query,is_bootstrapped:z,display_position:D},A,y.node.rel)}function s(x){var y=x.getData();u("click",{query:y.query,is_bootstrapped:y.node.bootstrap?1:0,display_position:y.position},y.node.type,y.node.id)}function t(x){if(l!==x)u("search_keystroke",{prev_query:l,new_query:x});l=x}function u(x,y,z,A){j.log(x,"search_typeahead",y,z,A)}function v(x){return x.listen("change",t)}i.listen("m:side-area:show",null,m);i.listen("m:side-area:hide",null,n);i.listen("click","side-menu-item",o);var w=k.hasTouchEvents()?"touchend":"click";i.listen(w,"search-activator",p);i.listen(w,"graph-search-activator",p);i.listen("click","graph-search-entry-point",p);i.listen("m:search-overlay:cancel",null,q);i.listen("m:search-overlay:cancel-react",null,q);i.listen("m:search-typeahead:select",null,r);i.listen("m:search-typeahead:select-react",null,s);f.exports={setupTypeaheadListener:v}}),null);
__d("MNotificationClick",["CSS","MLegacyDataStore","MRequest","Stratcom"],(function a(b,c,d,e,f,g,h,i,j,k){__p&&__p();var l="notification",m="list_",n="acw",o="aclb",p={},q=false;f.exports={init:function v(){if(q)return;k.listen("click",l,r);k.listen("m:page:render:cache:complete",null,s);q=true}};function r(event){var v=event.getNode("touchable");if(!v)return;var w=i.get(v).notif_id;if(!w)return;new j("/a/jewel_notifications_log.php").addData({click_type:"notification_click",id:w,target_id:i.get(v).target_id}).send();t(event)}function s(v){if(v.getData().path.indexOf("notifications")>-1)for(var w in p)u(w)}function t(event){__p&&__p();var v=event.getNode("marea");if(!v)return;var w=v.getAttribute("id");if(!w)return;u(w);var x=w.startsWith(m)?w.substring(m.length):m+w;u(x);p[w]=true;p[x]=true}function u(v){var w=document.getElementById(v);if(w){h.addClass(w,n);h.removeClass(w,o)}}}),null);
__d("MQuickPromotion",["DOM","Stratcom"],(function a(b,c,d,e,f,g,h,i){"use strict";var j=false;f.exports={main:function k(){if(j)return;j=true;i.listen("click","m-promo-close",function(event){var l=event.getNode("m-promo"),m=event.getNode("m-megaphone");h.hide(l,m)})}}}),null);
__d("MActionBubbleMask",["CSS","DOM","MViewport","Stratcom","cx","requestAnimationFrame"],(function a(b,c,d,e,f,g,h,i,j,k,l,m){__p&&__p();var n="_5nvw",o="_5nvx",p=300;function q(r){"use strict";this.$MActionBubbleMask1=null;this.$MActionBubbleMask2=null;this.$MActionBubbleMask3=r}q.prototype.enable=function(){"use strict";var r=this.$MActionBubbleMask3.getRoot().getAttribute("data-mask-class");if(!r)r=n;this.$MActionBubbleMask2=i.create("div",{className:r});this.$MActionBubbleMask1=[this.$MActionBubbleMask3.addListener("show",this.$MActionBubbleMask4.bind(this)),this.$MActionBubbleMask3.addListener("hide",this.$MActionBubbleMask5.bind(this)),this.$MActionBubbleMask3.addListener("reposition",this.$MActionBubbleMask6.bind(this)),i.listen(this.$MActionBubbleMask2,"touchend",null,function(s){s.stop()})];if(this.$MActionBubbleMask3.isShown())this.$MActionBubbleMask4()};q.prototype.disable=function(){"use strict";this.$MActionBubbleMask5();while(this.$MActionBubbleMask1.length)this.$MActionBubbleMask1.pop().remove();this.$MActionBubbleMask1=null;this.$MActionBubbleMask2=null};q.prototype.$MActionBubbleMask4=function(){"use strict";i.insertBefore(this.$MActionBubbleMask3.getRoot(),this.$MActionBubbleMask2);h.addClass(this.$MActionBubbleMask3.getCausalElement(),o);this.$MActionBubbleMask7=k.listen("scroll",null,this.$MActionBubbleMask6.bind(this));this.$MActionBubbleMask6()};q.prototype.$MActionBubbleMask5=function(){"use strict";i.remove(this.$MActionBubbleMask2);var r=this.$MActionBubbleMask3.getCausalElement();if(r)h.removeClass(r,o);this.$MActionBubbleMask7&&this.$MActionBubbleMask7.remove();this.$MActionBubbleMask7=null};q.prototype.$MActionBubbleMask6=function(){"use strict";m(function(){this.$MActionBubbleMask2.style.top=j.getScrollTop()-p+"px";this.$MActionBubbleMask2.style.height=j.getHeight()+p*2+"px"}.bind(this))};f.exports=q}),null);
__d("MLayerHideOnCloseClick",["DOM"],(function a(b,c,d,e,f,g,h){__p&&__p();function i(j){"use strict";this.$MLayerHideOnCloseClick1=null;this.$MLayerHideOnCloseClick2=null;this.$MLayerHideOnCloseClick3=j}i.prototype.enable=function(){"use strict";this.$MLayerHideOnCloseClick1=[this.$MLayerHideOnCloseClick3.addListener("show",this.$MLayerHideOnCloseClick4.bind(this)),this.$MLayerHideOnCloseClick3.addListener("hide",this.$MLayerHideOnCloseClick5.bind(this))];if(this.$MLayerHideOnCloseClick3.isShown())this.$MLayerHideOnCloseClick4()};i.prototype.disable=function(){"use strict";this.$MLayerHideOnCloseClick5();while(this.$MLayerHideOnCloseClick1.length)this.$MLayerHideOnCloseClick1.pop().remove();this.$MLayerHideOnCloseClick1=null};i.prototype.$MLayerHideOnCloseClick5=function(){"use strict";this.$MLayerHideOnCloseClick2&&this.$MLayerHideOnCloseClick2.remove()};i.prototype.$MLayerHideOnCloseClick4=function(){"use strict";this.$MLayerHideOnCloseClick2=h.listen(this.$MLayerHideOnCloseClick3.getRoot(),"click","mlayer-hide-on-click",this.$MLayerHideOnCloseClick3.hide.bind(this.$MLayerHideOnCloseClick3))};f.exports=i}),null);
__d("MSearchTabBar",["CSS","DOM","MActionBubbleMask","MFlyout","MLayerDestroyOnTransition","MLayerHideOnBlur","MLayerHideOnCloseClick","Stratcom","SubscriptionsHandler","containsNode","cx","throttle"],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){"use strict";__p&&__p();function t(u,v){__p&&__p();var w=arguments.length<=2||arguments[2]===undefined?{destroyOnTransition:true}:arguments[2];this.render=function(){__p&&__p();if(this.$MSearchTabBar3==null){this.$MSearchTabBar3=i.create("div",{className:"button touchable _x02 _x03"},i.create("div",{className:"_x04"}));this.$MSearchTabBar9.addSubscriptions(i.listen(this.$MSearchTabBar3,"click",null,this.$MSearchTabBar12));i.appendContent(this.$MSearchTabBar1,this.$MSearchTabBar3)}if(this.$MSearchTabBar4==null)this.$MSearchTabBar4=i.create("div",{className:"_x08"});if(this.$MSearchTabBar8==null){var x=[m,j,n];if(this.$MSearchTabBar10.destroyOnTransition)x.push(l);this.$MSearchTabBar8=new k({classNames:["_55i2","accelerate"],nubalign:"center",offsetY:5,position:"below",margin:"none",width:"wide",addedBehaviors:x,context:this.$MSearchTabBar3},this.$MSearchTabBar4)}var y=this.$MSearchTabBar5;if(y==null){y=[];for(var z=this.$MSearchTabBar2,A=Array.isArray(z),B=0,z=A?z:z[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var C;if(A){if(B>=z.length)break;C=z[B++]}else{B=z.next();if(B.done)break;C=B.value}var D=C;y.push(i.create("a",{href:D.uri,className:"_x0a"+(D.is_selected===true?" _x0b":""),"data-sigil":"mlayer-hide-on-click"},D.label))}i.prependContent(this.$MSearchTabBar1,y);this.$MSearchTabBar5=y}var E=this.$MSearchTabBar6;if(E==null){E=this.$MSearchTabBar3.offsetWidth;this.$MSearchTabBar6=E}var F=this.$MSearchTabBar1.offsetWidth-E,G=0,H=0,I=y.length,J=void 0;for(;H<y.length;H++){if(this.$MSearchTabBar2[H].is_selected)J=H;if(this.$MSearchTabBar7[H]==null)this.$MSearchTabBar7[H]=y[H].offsetWidth;G+=this.$MSearchTabBar7[H];if(I===y.length&&G>F)I=H}var K=y.slice();if(I<K.length&&J!=null&&J>=I){var L=K[J];K.splice(J,1);K.splice(I-1,0,L)}for(var M=0;M<K.length;M++)if(M<I)i.appendContent(this.$MSearchTabBar1,K[M]);else i.appendContent(this.$MSearchTabBar4,K[M]);i.appendContent(this.$MSearchTabBar1,this.$MSearchTabBar3);if(I<K.length)h.removeClass(this.$MSearchTabBar3,"_x03");else h.addClass(this.$MSearchTabBar3,"_x03")}.bind(this);this.$MSearchTabBar12=function(event){if(!q(this.$MSearchTabBar3,event.getTarget()))return;h.addClass(this.$MSearchTabBar3,"_x0d");o.addSigil(this.$MSearchTabBar3,"selected");o.removeCurrentListener()}.bind(this);this.$MSearchTabBar11=function(){h.removeClass(this.$MSearchTabBar3,"_x0d");o.removeSigil(this.$MSearchTabBar3,"selected");o.listen("click",null,this.$MSearchTabBar12)}.bind(this);this.$MSearchTabBar1=u;this.$MSearchTabBar7=[];this.$MSearchTabBar10=w;this.$MSearchTabBar9=new p();this.$MSearchTabBar9.addSubscriptions(o.listen("m:flyout:close",null,this.$MSearchTabBar11),o.listen(["m:viewport:orientation-change","resize"],null,s(this.render,200)));if(w.destroyOnTransition)this.$MSearchTabBar9.addSubscriptions(o.listen("m:page:unload",null,function(){this.$MSearchTabBar9.release()}.bind(this)));if(v!=null)this.setTabs(v)}t.prototype.setTabs=function(u){this.$MSearchTabBar2=u;if(this.$MSearchTabBar5!=null)this.$MSearchTabBar5.forEach(function(v){return i.remove(v)});this.$MSearchTabBar5=null;this.render();return this};t.init=function(u,v){var w=arguments.length<=2||arguments[2]===undefined?{destroyOnTransition:true}:arguments[2];return new t(u,v,w)};f.exports=t}),null);
__d("XGroupSearchResultsController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/groups/search/",{groupID:{type:"Int"},query:{type:"String"},name:{type:"String"},cursor:{type:"String"},source:{type:"String"}})}),null);
__d("MSearchSimplificationUtils",["MHistory","URI","XGroupSearchResultsController"],(function a(b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();var k=new RegExp("^/(search/top|graphsearch/str.+/keywords_(top|search))"),l=new RegExp("^/(search|graphsearch|groups/search)"),m=new RegExp("^/(groups/search)");function n(p){var q=h.getPath(),r=new i(q).getPath();return r.match(p)!=null}var o={getKeywordSemantic:function p(q){return"keywords_search("+q+")"},getKeywordURI:function p(q){return new i("/search/top/").addQueryData("q",q)},getGroupSearchURI:function p(q,r){return j.getURIBuilder().setInt("groupID",q).setString("query",r).getURI()},isSearchURI:function p(q){return q.getPath().match(l)!=null},isTopTabURI:function p(q){return q.getPath().match(k)!=null},isCurrentPathTopTabPath:function p(){return n(k)},isCurrentPathSERPPath:function p(){return n(l)},isCurrentPathScopedSearchPath:function p(){return n(m)},isTypeaheadOpen:function p(){return h.getParam(h.SOFT_STATE_KEY)==="search"},isTabOverlayOpen:function p(){return h.getParam(h.SOFT_STATE_KEY)!=null},getQueryFromCurrentPath:function p(){if(!o.isCurrentPathSERPPath())return null;var q=new i(h.getPath()),r=q.getQueryData();if(r.q!=null)return r.q;var s=q.getPath(),t=s.match(/\/graphsearch\/str\/([^\/]+)/);if(t!=null)return decodeURIComponent(t[1]).replace(/\+/g," ");return null}};f.exports=o}),null);
__d("MSearchTabsAboveBEM",["DOM","MSearchSimplificationUtils","MSearchTabBar","Stratcom","SubscriptionsHandler","URI","csx","cx","fbt"],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){"use strict";__p&&__p();function q(r){this.$MSearchTabsAboveBEM10=function(){this.$MSearchTabsAboveBEM12()}.bind(this);this.$MSearchTabsAboveBEM9=function(){this.$MSearchTabsAboveBEM12()}.bind(this);this.$MSearchTabsAboveBEM11=function(){var s=i.isCurrentPathSERPPath();if(!s)q.setTabs(this.$MSearchTabsAboveBEM8())}.bind(this);this.$MSearchTabsAboveBEM3=r}q.prototype.enable=function(){__p&&__p();this.$MSearchTabsAboveBEM1={isVisible:false};this.$MSearchTabsAboveBEM2=h.create("div",{className:"_1t4h"});var r=document.querySelector("._234-");if(r!=null)h.insertBefore(r,this.$MSearchTabsAboveBEM2);else h.appendContent(this.$MSearchTabsAboveBEM3.getRoot(),this.$MSearchTabsAboveBEM2);q.$MSearchTabsAboveBEM7=j.init(this.$MSearchTabsAboveBEM2,q.$MSearchTabsAboveBEM6!=null?q.$MSearchTabsAboveBEM6:this.$MSearchTabsAboveBEM8(),{destroyOnTransition:false});h.hide(this.$MSearchTabsAboveBEM2);this.$MSearchTabsAboveBEM4=new l();this.$MSearchTabsAboveBEM4.addSubscriptions(k.listen("m:page:render:complete",null,this.$MSearchTabsAboveBEM9),k.listen("m:history:change",null,this.$MSearchTabsAboveBEM10),k.listen("m:page:unload",null,this.$MSearchTabsAboveBEM11));this.$MSearchTabsAboveBEM12()};q.prototype.disable=function(){this.$MSearchTabsAboveBEM4.release();h.remove(this.$MSearchTabsAboveBEM2)};q.prototype.$MSearchTabsAboveBEM12=function(){var r=i.isCurrentPathSERPPath(),s=i.isTypeaheadOpen(),t=i.isCurrentPathScopedSearchPath();this.$MSearchTabsAboveBEM13({isVisible:r&&!s&&!t})};q.prototype.$MSearchTabsAboveBEM13=function(r){var s=babelHelpers["extends"]({},this.$MSearchTabsAboveBEM1);this.$MSearchTabsAboveBEM1=babelHelpers["extends"]({},this.$MSearchTabsAboveBEM1,r);if(s.isVisible!==this.$MSearchTabsAboveBEM1.isVisible)if(this.$MSearchTabsAboveBEM1.isVisible){h.show(this.$MSearchTabsAboveBEM2);q.$MSearchTabsAboveBEM7.render()}else h.hide(this.$MSearchTabsAboveBEM2)};q.prototype.$MSearchTabsAboveBEM8=function(){if(this.$MSearchTabsAboveBEM5==null)this.$MSearchTabsAboveBEM5=[{is_selected:true,label:p._("All"),uri:new m("#")},{label:p._("Posts"),uri:new m("#")},{label:p._("People"),uri:new m("#")},{label:p._("Photos"),uri:new m("#")},{label:p._("Videos"),uri:new m("#")},{label:p._("Pages"),uri:new m("#")},{label:p._("Places"),uri:new m("#")},{label:p._("Groups"),uri:new m("#")},{label:p._("Apps"),uri:new m("#")},{label:p._("Events"),uri:new m("#")}];return this.$MSearchTabsAboveBEM5};q.setTabs=function(r){q.$MSearchTabsAboveBEM6=r;var s=q.$MSearchTabsAboveBEM7;if(s!=null)s.setTabs(r)};f.exports=q}),null);
__d("MLink",["DOM","MLegacyDataStore","ErrorUtils","MLinkHack","FBLogger","MPageCache","MPageController","Stratcom","URI"],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){__p&&__p();var q="standalone"in window.navigator&&window.navigator.standalone,r=false;function s(){__p&&__p();if(r)return;r=true;h.listen(document.documentElement,"click",null,function(event){__p&&__p();if(event.getPrevented())return;j.applyWithGuard(function(){__p&&__p();var t=event.getNode("tag:a");if(!t)return;var u=event.getRawEvent();if(t.getAttribute("onclick")||(u.which||u.button)>=2)return;k.remove(t);var v=t.getAttribute("href"),w=new p(v),x=w.getProtocol();if(x&&x!="http"&&x!="https")return;var y=w.getDomain(),z=v&&v.charAt(0),A=!z||/[\/#]/.test(z),B=w.getPort()?[y,w.getPort()].join(":"):y,C=A||location.host===B,D=y&&!/\.facebook.com$/i.test(y);if(D&&!o.hasSigil(t,"MLinkshim"))l("FIXME").mustfix("Loading an external URL without shimming: %s",v);var E=t.getAttribute("target");if((E=="_blank"||D)&&q)return;if(E=="_blank")window.open(v,"_blank");else if(w.getPath().toLowerCase().indexOf("/dialog/oauth")>-1)return;else if(E||x&&x+":"!==location.protocol||o.hasSigil(t,"no_mpc")||D)window.location=v;else if(v)if(v.indexOf("#")===0){var F=document.getElementById(v.substr(1));F&&F.scrollIntoView()}else{var G=i.get(t);if(G.fromCache)m.setScrollHistory(v,0);n.load(v,{replace:G.behavior==="replace-state",expiration:G.fromCache?n.HISTORY_EXPIRE_MS:null})}else{if(t.hasAttribute("data-sigil"))return;var H="",I=event.getTarget();while(I&&I!=document.body){H=H+" <"+I.nodeName;if(I.id)H=H+" id="+I.id;if(I.className)H=H+" class="+I.className;H=H+" >";I=I.parentNode}l("FIXME").warn('handleClick: unknown link action: <a id="%s" class="%s" /> Path: %s',t.id,t.className,H);return}event.prevent()},null,[],null,"LinkController")})}g.setupListener=s}),null);
__d("MPopoverClose",["Popover"],(function a(b,c,d,e,f,g,h){var i=function i(){if(h._activePopover)h._activePopover.close()};g.main=i}),null);
__d("formatNumber",["fbt","intlNumUtils"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();function j(o,p){return i.formatNumber(o,p)}function k(o,p){var q=h._({"*":"{number}+"},[h.param("number",i.formatNumberWithThousandDelimiters(o,p),[0,o])]);return q.toString()}function l(o,p){var q=h._({"*":"\u003C {number}"},[h.param("number",i.formatNumberWithThousandDelimiters(o,p),[0,o])]);return q.toString()}function m(o,p,q){return o>p?k(p,q):i.formatNumberWithThousandDelimiters(o,q)}function n(o,p,q){return o<p?l(p,q):i.formatNumberWithThousandDelimiters(o,q)}j.withThousandDelimiters=i.formatNumberWithThousandDelimiters;j.withMaxLimit=m;j.withMinLimit=n;f.exports=j}),null);
__d("TokenizeUtil",["nullthrows"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=/[ ]+/g,j=/[^ ]+/g,k=new RegExp("[^ "+m()+"]+|"+n(),"g"),l=new RegExp(n(),"g");function m(){return".,+*?$|#{}()'\\^\\-\\[\\]\\\\\\/!@%\"~=<>_:;\u30fb\u3001\u3002\u3008-\u3011\u3014-\u301f\uff1a-\uff1f\uff01-\uff0f\uff3b-\uff40\uff5b-\uff65\u2e2e\u061f\u066a-\u066c\u061b\u060c\u060d\ufd3e\ufd3f\u1801\u0964\u104a\u104b\u2010-\u2027\u2030-\u205e\xa1-\xb1\xb4-\xb8\xba\xbb\xbf"}function n(){return"["+m()+"]"}var o={},p={a:"\u0430 \xe0 \xe1 \xe2 \xe3 \xe4 \xe5 \u0101",b:"\u0431",c:"\u0446 \xe7 \u010d",d:"\u0434 \xf0 \u010f \u0111",e:"\u044d \u0435 \xe8 \xe9 \xea \xeb \u011b \u0113",f:"\u0444",g:"\u0433 \u011f \u0123",h:"\u0445 \u0127",i:"\u0438 \xec \xed \xee \xef \u0131 \u012b",j:"\u0439",k:"\u043a \u0138 \u0137",l:"\u043b \u013e \u013a \u0140 \u0142 \u013c",m:"\u043c",n:"\u043d \xf1 \u0148 \u0149 \u014b \u0146",o:"\u043e \xf8 \xf6 \xf5 \xf4 \xf3 \xf2",p:"\u043f",r:"\u0440 \u0159 \u0155",s:"\u0441 \u015f \u0161 \u017f",t:"\u0442 \u0165 \u0167 \xfe",u:"\u0443 \u044e \xfc \xfb \xfa \xf9 \u016f \u016b",v:"\u0432",y:"\u044b \xff \xfd",z:"\u0437 \u017e",ae:"\xe6",oe:"\u0153",ts:"\u0446",ch:"\u0447",ij:"\u0133",sh:"\u0448",ss:"\xdf",ya:"\u044f"};for(var q in p){var r=p[q].split(" ");for(var s=0;s<r.length;s++)o[r[s]]=q}function t(B){return B?B.replace(l," "):""}function u(B){B=B.toLowerCase();var C="",D="";for(var E=B.length;E--;){D=B.charAt(E);C=(o[D]||D)+C}return C.replace(i," ")}function v(B){var C=arguments.length<=1||arguments[1]===undefined?j:arguments[1],D=[],E=C.exec(B);while(E){E=E[0];D.push(E);E=C.exec(B)}return D}function w(t){__p&&__p();var B=arguments.length<=1||arguments[1]===undefined?j:arguments[1],C={};return function x(D,E){__p&&__p();if(!Object.prototype.hasOwnProperty.call(C,D)){var F=u(D),G=t(F);C[D]={value:D,flatValue:F,tokens:v(G,B),isPrefixQuery:!!G&&G[G.length-1]!=" "}}if(E&&C[D].sortedTokens===undefined){C[D].sortedTokens=C[D].tokens.slice();C[D].sortedTokens.sort(function(H,I){return I.length-H.length})}return C[D]}}var x=w(t),y=w(function(B){return B},k);function z(B,C,D){var E=B=="query"||B=="query_punc",F=B=="query_punc"?y:x,G=F(C,B=="prefix"),H=B=="prefix"?h(G.sortedTokens):G.tokens,I=F(D).tokens,J={},K=G.isPrefixQuery&&E?H.length-1:null,L=function L(M,N){for(var O=0;O<I.length;++O){var P=I[O];if(!J[O]&&(P==M||(E&&N===K||B=="prefix")&&P.indexOf(M)===0))return J[O]=true}return false};return Boolean(H.length&&H.every(L))}var A={flatten:u,parse:x,parseIncludingPunctuations:y,getPunctuation:n,makeParse:w,isExactMatch:z.bind(null,"exact"),isQueryMatch:z.bind(null,"query"),isQueryMatchIncludingPunctuations:z.bind(null,"query_punc"),isPrefixMatch:z.bind(null,"prefix"),tokenize:v};f.exports=A}),null);