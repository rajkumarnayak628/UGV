if (self.CavalryLogger) { CavalryLogger.start_js(["wMrbi"]); }

__d("URLMatcherConfig",[],(function a(b,c,d,e,f,g){f.exports={tlds:"(?:\\.(com|\ud55c\uad6d|\uc0bc\uc131|\ub2f7\ucef4|\ub2f7\ub137|\u9999\u6e2f|\u9999\u683c\u91cc\u62c9|\u9910\u5385|\u98df\u54c1|\u98de\u5229\u6d66|\u96fb\u8a0a\u76c8\u79d1|\u96c6\u56e2|\u901a\u8ca9|\u8d2d\u7269|\u8c37\u6b4c|\u8bfa\u57fa\u4e9a|\u8054\u901a|\u7f51\u7edc|\u7f51\u7ad9|\u7f51\u5e97|\u7f51\u5740|\u7ec4\u7ec7\u673a\u6784|\u79fb\u52a8|\u73e0\u5b9d|\u70b9\u770b|\u6fb3\u9580|\u6e38\u620f|\u6de1\u9a6c\u9521|\u673a\u6784|\u66f8\u7c4d|\u65f6\u5c1a|\u65b0\u95fb|\u65b0\u52a0\u5761|\u653f\u5e9c|\u653f\u52a1|\u624b\u8868|\u624b\u673a|\u6211\u7231\u4f60|\u6148\u5584|\u5fae\u535a|\u5e7f\u4e1c|\u5de5\u884c|\u5bb6\u96fb|\u5a31\u4e50|\u5929\u4e3b\u6559|\u5927\u62ff|\u5927\u4f17\u6c7d\u8f66|\u5728\u7ebf|\u5609\u91cc\u5927\u9152\u5e97|\u5609\u91cc|\u5546\u6807|\u5546\u5e97|\u5546\u57ce|\u53f0\u7063|\u53f0\u6e7e|\u516c\u76ca|\u516c\u53f8|\u516b\u5366|\u5065\u5eb7|\u4fe1\u606f|\u4f5b\u5c71|\u4f01\u4e1a|\u4e2d\u6587\u7f51|\u4e2d\u570b|\u4e2d\u56fd|\u4e2d\u4fe1|\u4e16\u754c|\u30dd\u30a4\u30f3\u30c8|\u30d5\u30a1\u30c3\u30b7\u30e7\u30f3|\u30bb\u30fc\u30eb|\u30b9\u30c8\u30a2|\u30b3\u30e0|\u30b0\u30fc\u30b0\u30eb|\u30af\u30e9\u30a6\u30c9|\u307f\u3093\u306a|\u10d2\u10d4|\u0e44\u0e17\u0e22|\u0e04\u0e2d\u0e21|\u0dbd\u0d82\u0d9a\u0dcf|\u0d2d\u0d3e\u0d30\u0d24\u0d02|\u0cad\u0cbe\u0cb0\u0ca4|\u0c2d\u0c3e\u0c30\u0c24\u0c4d|\u0b9a\u0bbf\u0b99\u0bcd\u0b95\u0baa\u0bcd\u0baa\u0bc2\u0bb0\u0bcd|\u0b87\u0bb2\u0b99\u0bcd\u0b95\u0bc8|\u0b87\u0ba8\u0bcd\u0ba4\u0bbf\u0baf\u0bbe|\u0b2d\u0b3e\u0b30\u0b24|\u0aad\u0abe\u0ab0\u0aa4|\u0a2d\u0a3e\u0a30\u0a24|\u09ad\u09be\u09f0\u09a4|\u09ad\u09be\u09b0\u09a4|\u09ac\u09be\u0982\u09b2\u09be|\u0938\u0902\u0917\u0920\u0928|\u092d\u093e\u0930\u094b\u0924|\u092d\u093e\u0930\u0924\u092e\u094d|\u092d\u093e\u0930\u0924|\u0928\u0947\u091f|\u0915\u0949\u092e|\u0680\u0627\u0631\u062a|\u067e\u0627\u06a9\u0633\u062a\u0627\u0646|\u0647\u0645\u0631\u0627\u0647|\u0645\u0648\u0642\u0639|\u0645\u0648\u0628\u0627\u064a\u0644\u064a|\u0645\u0644\u064a\u0633\u064a\u0627|\u0645\u0635\u0631|\u0643\u0648\u0645|\u0643\u0627\u062b\u0648\u0644\u064a\u0643|\u0642\u0637\u0631|\u0641\u0644\u0633\u0637\u064a\u0646|\u0639\u0645\u0627\u0646|\u0639\u0631\u0628|\u0639\u0631\u0627\u0642|\u0634\u0628\u0643\u0629|\u0633\u0648\u0631\u064a\u0629|\u0633\u0648\u062f\u0627\u0646|\u062a\u0648\u0646\u0633|\u0628\u06be\u0627\u0631\u062a|\u0628\u064a\u062a\u0643|\u0628\u0627\u0632\u0627\u0631|\u0628\u0627\u0631\u062a|\u0627\u06cc\u0631\u0627\u0646|\u0627\u0645\u0627\u0631\u0627\u062a|\u0627\u0644\u0645\u063a\u0631\u0628|\u0627\u0644\u0639\u0644\u064a\u0627\u0646|\u0627\u0644\u0633\u0639\u0648\u062f\u064a\u0629|\u0627\u0644\u062c\u0632\u0627\u0626\u0631|\u0627\u0644\u0627\u0631\u062f\u0646|\u0627\u0631\u0627\u0645\u0643\u0648|\u0627\u062a\u0635\u0627\u0644\u0627\u062a|\u0627\u0628\u0648\u0638\u0628\u064a|\u05e7\u05d5\u05dd|\u0570\u0561\u0575|\u049b\u0430\u0437|\u0443\u043a\u0440|\u0441\u0440\u0431|\u0441\u0430\u0439\u0442|\u0440\u0444|\u0440\u0443\u0441|\u043e\u0440\u0433|\u043e\u043d\u043b\u0430\u0439\u043d|\u043c\u043e\u0441\u043a\u0432\u0430|\u043c\u043e\u043d|\u043c\u043a\u0434|\u043a\u043e\u043c|\u043a\u0430\u0442\u043e\u043b\u0438\u043a|\u0435\u044e|\u0434\u0435\u0442\u0438|\u0431\u0435\u043b|\u0431\u0433|\u03b5\u03bb|zw|zuerich|zone|zm|zippo|zip|zero|zara|zappos|za|yun|yt|youtube|you|yokohama|yoga|yodobashi|ye|yandex|yamaxun|yahoo|yachts|xyz|xxx|xperia|xn--zfr164b|xn--ygbi2ammx|xn--yfro4i67o|xn--y9a3aq|xn--xkc2dl3a5ee0h|xn--xkc2al3hye2a|xn--xhq521b|xn--wgbl6a|xn--wgbh1c|xn--w4rs40l|xn--w4r85el8fhu5dnra|xn--vuq861b|xn--vhquv|xn--vermgensberatung-pwb|xn--vermgensberater-ctb|xn--unup4y|xn--tiq49xqyj|xn--tckwe|xn--t60b56a|xn--ses554g|xn--s9brj9c|xn--rvc1e0am3e|xn--rovu88b|xn--rhqv96g|xn--qxam|xn--qcka1pmc|xn--q9jyb4c|xn--pssy2u|xn--pgbs0dh|xn--pbt977c|xn--p1ai|xn--p1acf|xn--ogbpf8fl|xn--o3cw4h|xn--nyqy26a|xn--nqv7fs00ema|xn--nqv7f|xn--node|xn--ngbrx|xn--ngbe9e0a|xn--ngbc5azd|xn--mxtq1m|xn--mk1bu44c|xn--mix891f|xn--mgbx4cd0ab|xn--mgbtx2b|xn--mgbt3dhd|xn--mgbpl2fh|xn--mgbi4ecexp|xn--mgbgu82a|xn--mgberp4a5d4ar|xn--mgbca7dzdo|xn--mgbc0a9azcg|xn--mgbbh1a71e|xn--mgbbh1a|xn--mgbb9fbpob|xn--mgbayh7gpa|xn--mgbai9azgqp6j|xn--mgbab2bd|xn--mgbaam7a8h|xn--mgbaakc7dvf|xn--mgba7c0bbn0a|xn--mgba3a4f16a|xn--mgba3a3ejt|xn--mgb9awbf|xn--lgbbat1ad8j|xn--l1acc|xn--kput3i|xn--kpu716f|xn--kpry57d|xn--kprw13d|xn--kcrx77d1x4a|xn--jvr189m|xn--jlq61u9w7b|xn--j6w193g|xn--j1amh|xn--j1aef|xn--io0a7i|xn--imr513n|xn--i1b6b1a6a2e|xn--hxt814e|xn--h2brj9c8c|xn--h2brj9c|xn--h2breg3eve|xn--gk3at1e|xn--gecrj9c|xn--gckr3f0f|xn--g2xx48c|xn--fzys8d69uvgm|xn--fzc2c9e2c|xn--fpcrj9c3d|xn--flw351e|xn--fjq720a|xn--fiqz9s|xn--fiqs8s|xn--fiq64b|xn--fiq228c5hs|xn--fhbei|xn--fct429k|xn--estv75g|xn--efvy88h|xn--eckvdtc9d|xn--e1a4c|xn--d1alf|xn--d1acj3b|xn--czru2d|xn--czrs0t|xn--czr694b|xn--clchc0ea0b2g2a9gcd|xn--cg4bki|xn--cck2b3b|xn--c2br7g|xn--c1avg|xn--bck1b9a5dre4c|xn--b4w605ferd|xn--9krt00a|xn--9et52u|xn--9dbq2a|xn--90ais|xn--90ae|xn--90a3ac|xn--8y0a063a|xn--80aswg|xn--80asehdb|xn--80aqecdr1a|xn--80ao21a|xn--80adxhks|xn--6qq986b3xl|xn--6frz82g|xn--5tzm5g|xn--5su34j936bgsg|xn--55qx5d|xn--55qw42g|xn--54b7fta0cc|xn--4gbrim|xn--45q11c|xn--45brj9c|xn--45br5cyl|xn--42c2d9a|xn--3pxu8k|xn--3oq18vl8pn36a|xn--3hcrj9c|xn--3e0b707e|xn--3ds443g|xn--3bst00m|xn--30rr7y|xn--2scrj9c|xn--1qqw23a|xn--1ck2e1b|xn--11b4c3d|xin|xihuan|xfinity|xerox|xbox|wtf|wtc|ws|wow|world|works|work|woodside|wolterskluwer|wme|winners|wine|windows|win|williamhill|wiki|wien|whoswho|wf|weir|weibo|wedding|wed|website|weber|webcam|weatherchannel|weather|watches|watch|warman|wanggou|wang|walter|walmart|wales|vuelos|vu|voyage|voto|voting|vote|volvo|volkswagen|vodka|vn|vlaanderen|vivo|viva|vistaprint|vista|vision|visa|virgin|vip|vin|villas|viking|vig|video|viajes|vi|vg|vet|versicherung|verm\xf6gensberatung|verm\xf6gensberater|verisign|ventures|vegas|ve|vc|vanguard|vana|vacations|va|uz|uy|us|ups|uol|uno|university|unicom|uk|ug|uconnect|ubs|ubank|ua|tz|tw|tvs|tv|tushu|tunes|tui|tube|tt|trv|trust|travelersinsurance|travelers|travelchannel|travel|training|trading|trade|tr|toys|toyota|town|tours|total|toshiba|toray|top|tools|tokyo|today|to|tn|tmall|tm|tl|tkmaxx|tk|tjx|tjmaxx|tj|tirol|tires|tips|tiffany|tienda|tickets|tiaa|theatre|theater|thd|th|tg|tf|teva|tennis|temasek|telefonica|telecity|tel|technology|tech|team|tdk|td|tci|tc|taxi|tax|tattoo|tatar|tatamotors|target|taobao|talk|taipei|tab|sz|systems|symantec|sydney|sy|sx|swiss|swiftcover|swatch|sv|suzuki|surgery|surf|support|supply|supplies|sucks|su|style|study|studio|stream|store|storage|stockholm|stcgroup|stc|statoil|statefarm|statebank|starhub|star|staples|stada|st|srt|srl|sr|spreadbetting|spot|sport|spiegel|space|soy|sony|song|solutions|solar|sohu|software|softbank|social|soccer|so|sncf|sn|smile|smart|sm|sling|sl|skype|sky|skin|ski|sk|sj|site|singles|sina|silk|si|shriram|showtime|show|shouji|shopping|shop|shoes|shiksha|shia|shell|shaw|sharp|shangrila|sh|sg|sfr|sexy|sex|sew|seven|ses|services|sener|select|seek|security|secure|seat|search|se|sd|scot|scor|scjohnson|science|schwarz|schule|school|scholarships|schmidt|schaeffler|scb|sca|sc|sbs|sbi|sb|saxo|save|sas|sarl|sapo|sap|sanofi|sandvikcoromant|sandvik|samsung|samsclub|salon|sale|sakura|safety|safe|saarland|sa|ryukyu|rwe|rw|run|ruhr|rugby|ru|rsvp|rs|room|rogers|rodeo|rocks|rocher|ro|rmit|rip|rio|ril|rightathome|ricoh|richardli|rich|rexroth|reviews|review|restaurant|rest|republican|report|repair|rentals|rent|ren|reliance|reit|reisen|reise|rehab|redumbrella|redstone|red|recipes|realty|realtor|realestate|read|re|raid|radio|racing|qvc|quest|quebec|qpon|qa|py|pwc|pw|pub|pt|ps|prudential|pru|protection|property|properties|promo|progressive|prof|productions|prod|pro|prime|press|praxi|pramerica|pr|post|porn|politie|poker|pohl|pnc|pn|pm|plus|plumbing|playstation|play|place|pl|pk|pizza|pioneer|pink|ping|pin|pid|pictures|pictet|pics|piaget|physio|photos|photography|photo|phone|philips|phd|pharmacy|ph|pg|pfizer|pf|pet|pe|pccw|pay|passagens|party|parts|partners|pars|paris|panerai|panasonic|page|pa|ovh|ott|otsuka|osaka|origins|organic|org|orange|oracle|open|ooo|onyourside|online|onl|onion|ong|one|omega|om|ollo|oldnavy|olayangroup|olayan|okinawa|office|off|observer|obi|nz|nyc|nu|ntt|nrw|nra|nr|np|nowtv|nowruz|now|norton|northwesternmutual|nokia|no|nl|nissay|nissan|ninja|nikon|nike|nico|ni|nhk|ngo|ng|nfl|nf|nexus|nextdirect|next|news|newholland|new|neustar|network|netflix|netbank|net|nec|ne|nc|nba|navy|natura|nationwide|name|nagoya|nadex|nab|na|mz|my|mx|mw|mv|mutual|museum|mu|mtr|mtn|mt|msd|ms|mr|mq|mp|movistar|movie|mov|motorcycles|moto|moscow|mortgage|mormon|mopar|monster|money|monash|mom|moi|moe|moda|mobily|mobile|mobi|mo|mn|mma|mm|mls|mlb|ml|mk|mitsubishi|mit|mint|mini|mil|microsoft|miami|mh|mg|metlife|merckmsd|meo|menu|men|memorial|meme|melbourne|meet|media|med|me|md|mckinsey|mc|mba|mattel|maserati|marshalls|marriott|markets|marketing|market|map|mango|management|man|makeup|maison|maif|madrid|macys|ma|ly|lv|luxury|luxe|lupin|lundbeck|lu|ltda|ltd|lt|ls|lr|lplfinancial|lpl|love|lotto|lotte|london|lol|loft|locus|locker|loans|loan|lk|lixil|living|live|lipsy|link|linde|lincoln|limo|limited|lilly|like|lighting|lifestyle|lifeinsurance|life|lidl|liaison|li|lgbt|lexus|lego|legal|lefrak|leclerc|lease|lds|lc|lb|lawyer|law|latrobe|latino|lat|lasalle|lanxess|landrover|land|lancome|lancia|lancaster|lamer|lamborghini|ladbrokes|lacaixa|la|kz|kyoto|ky|kw|kuokgroup|kred|krd|kr|kpn|kpmg|kp|kosher|komatsu|koeln|kn|km|kiwi|kitchen|kindle|kinder|kim|kia|ki|kh|kg|kfh|kerryproperties|kerrylogistics|kerryhotels|ke|kddi|kaufen|juniper|juegos|jprs|jpmorgan|jp|joy|jot|joburg|jobs|jo|jnj|jmp|jm|jll|jlc|jio|jewelry|jetzt|jeep|je|jcp|jcb|java|jaguar|iwc|iveco|itv|itau|it|istanbul|ist|ismaili|iselect|is|irish|ir|iq|ipiranga|io|investments|intuit|international|intel|int|insure|insurance|institute|ink|ing|info|infiniti|industries|in|immobilien|immo|imdb|imamat|im|il|ikano|ifm|ieee|ie|id|icu|ice|icbc|ibm|hyundai|hyatt|hughes|hu|ht|hsbc|hr|how|house|hotmail|hotels|hoteles|hot|hosting|host|hospital|horse|honeywell|honda|homesense|homes|homegoods|homedepot|holiday|holdings|hockey|hn|hm|hkt|hk|hiv|hitachi|hisamitsu|hiphop|hgtv|hermes|here|helsinki|help|healthcare|health|hdfcbank|hdfc|hbo|haus|hangout|hamburg|hair|gy|gw|guru|guitars|guide|guge|gucci|guardian|gu|gt|gs|group|grocery|gripe|green|gratis|graphics|grainger|gr|gq|gp|gov|got|gop|google|goog|goodyear|goodhands|goo|golf|goldpoint|gold|godaddy|gn|gmx|gmo|gmbh|gmail|gm|globo|global|gle|glass|glade|gl|giving|gives|gifts|gift|gi|gh|ggee|gg|gf|george|genting|gent|gea|ge|gdn|gd|gbiz|gb|garden|gap|games|game|gallup|gallo|gallery|gal|ga|fyi|futbol|furniture|fund|fun|fujixerox|fujitsu|ftr|frontier|frontdoor|frogans|frl|fresenius|free|fr|fox|foundation|forum|forsale|forex|ford|football|foodnetwork|food|foo|fo|fm|fly|flowers|florist|flir|flights|flickr|fk|fj|fitness|fit|fishing|fish|firmdale|firestone|fire|financial|finance|final|film|fido|fidelity|fiat|fi|ferrero|ferrari|feedback|fedex|fast|fashion|farmers|farm|fans|fan|family|faith|fairwinds|fail|fage|extraspace|express|exposed|expert|exchange|everbank|events|eus|eurovision|eu|etisalat|et|esurance|estate|esq|es|erni|ericsson|er|equipment|epson|epost|enterprises|engineering|engineer|energy|emerck|email|eg|ee|education|edu|edeka|eco|ec|eat|earth|dz|dvr|dvag|durban|dupont|duns|dunlop|duck|dubai|dtv|drive|download|dot|domains|doha|dog|dodge|doctor|docs|do|dnp|dm|dk|dj|diy|dish|discover|discount|directory|direct|digital|diet|diamonds|dhl|dev|design|desi|dentist|dental|democrat|delta|deloitte|dell|delivery|degree|deals|dealer|deal|de|dds|dclk|day|datsun|dating|date|data|dance|dad|dabur|cz|cyou|cymru|cy|cx|cw|cv|cuisinella|cu|csc|cruises|cruise|crs|crown|cricket|creditunion|creditcard|credit|cr|courses|coupons|coupon|country|corsica|coop|cool|cookingchannel|cooking|contractors|contact|consulting|construction|condos|comsec|computer|compare|company|community|commbank|comcast|com|cologne|college|coffee|codes|coach|co|cn|cm|clubmed|club|cloud|clothing|clinique|clinic|click|cleaning|claims|cl|ck|cityeats|city|citic|citi|citadel|cisco|circle|cipriani|ci|church|chrysler|chrome|christmas|chintai|cheap|chat|chase|channel|chanel|ch|cg|cfd|cfa|cf|cern|ceo|center|ceb|cd|cc|cbs|cbre|cbn|cba|catholic|catering|cat|casino|cash|caseih|case|casa|cartier|cars|careers|career|care|cards|caravan|car|capitalone|capital|capetown|canon|cancerresearch|camp|camera|cam|calvinklein|call|cal|cafe|cab|ca|bzh|bz|by|bw|bv|buzz|buy|business|builders|build|bugatti|budapest|bt|bs|brussels|brother|broker|broadway|bridgestone|bradesco|br|box|boutique|bot|boston|bostik|bosch|boots|booking|book|boo|bond|bom|bofa|boehringer|boats|bo|bnpparibas|bnl|bn|bmw|bms|bm|blue|bloomberg|blog|blockbuster|blanco|blackfriday|black|bj|biz|bio|bingo|bing|bike|bid|bible|bi|bharti|bh|bg|bf|bet|bestbuy|best|berlin|bentley|beer|beauty|beats|be|bd|bcn|bcg|bbva|bbt|bbc|bb|bayern|bauhaus|basketball|baseball|bargains|barefoot|barclays|barclaycard|barcelona|bar|bank|band|bananarepublic|banamex|baidu|baby|ba|azure|az|axa|ax|aws|aw|avianca|autos|auto|author|auspost|audio|audible|audi|auction|au|attorney|athleta|at|associates|asia|asda|as|arte|art|arpa|army|archi|aramco|arab|ar|aquarelle|aq|apple|app|apartments|aol|ao|anz|anquan|android|analytics|amsterdam|amica|amfam|amex|americanfamily|americanexpress|am|alstom|alsace|ally|allstate|allfinanz|alipay|alibaba|alfaromeo|al|akdn|airtel|airforce|airbus|aigo|aig|ai|agency|agakhan|ag|africa|afl|afamilycompany|af|aetna|aero|aeg|ae|adult|ads|adac|ad|actor|active|aco|accountants|accountant|accenture|academy|ac|abudhabi|abogado|able|abc|abbvie|abbott|abb|abarth|aarp|aaa))"}}),null);
__d("MCommentStatusLogger",["BanzaiLogger","ex","uuid"],(function a(b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();var k=Object.freeze({INIT:"init",SUBMIT:"submit",RESPOND:"respond",RENDER:"render"});function l(q,r,s){this.prevEventType=q||null;this.perfLoggable=!!r;this.isEndStep=!!s}var m={};m[k.INIT]=new l();m[k.SUBMIT]=new l(k.INIT,true);m[k.RESPOND]=new l(k.SUBMIT,true);m[k.RENDER]=new l(k.RESPOND,true,true);function n(q){this.$InteractionLog1=q;this.$InteractionLog2={};this.$InteractionLog3=0;this.$InteractionLog4=0;this.$InteractionLog5=null}n.prototype.$InteractionLog6=function(q){return q in this.$InteractionLog2};n.prototype.logEvent=function(q,r){__p&&__p();if(this.$InteractionLog6(q)||!(q in m))return false;var s=m[q],t=s.prevEventType;if(t&&!this.$InteractionLog6(t))return false;this.$InteractionLog3=r&&Object.prototype.hasOwnProperty.call(r,"text")?r.text:this.$InteractionLog3;this.$InteractionLog4=r&&Object.prototype.hasOwnProperty.call(r,"photo")?r.photo:this.$InteractionLog4;this.$InteractionLog5=(r&&Object.prototype.hasOwnProperty.call(r,"stickerID")?r.stickerID:this.$InteractionLog5)||null;var u=Date.now(),v=Math.round(u/1e3);this.$InteractionLog2[q]=u;var w={event:q,text_length:this.$InteractionLog3,num_photos:this.$InteractionLog4,sticker_id:this.$InteractionLog5,interaction_key:this.$InteractionLog1,client_time:v};if(t&&s.perfLoggable){var x=this.$InteractionLog7(t,q);w=babelHelpers["extends"]({duration:x},w)}h.create({retry:true}).log("MCommentWriteWaterfallLoggerConfig",w);return true};n.prototype.$InteractionLog7=function(q,r){var s=this.$InteractionLog2;if(!this.$InteractionLog6(q)||!this.$InteractionLog6(r))return null;var t=s[q],u=s[r];if(t>u)return null;return u-t};var o={},p={newInteractionKey:function q(){return j()},_logCommentStatus:function q(r,s,t){__p&&__p();if(!(s in m))return;var u=o[r];if(s===k.INIT)if(u)return;else{u=new n(r);o[r]=u}if(!u)return;var v=u.logEvent(s,t);if(v&&m[s].isEndStep)this.clear(r)},logInitText:function q(r){this._logCommentStatus(r,k.INIT,{text:1})},logInitPhoto:function q(r){this._logCommentStatus(r,k.INIT,{photo:1})},logSubmit:function q(r,s){this._logCommentStatus(r,k.SUBMIT,{text:s.text,photo:s.photo,stickerID:null})},logReceiveResponse:function q(r,s){this._logCommentStatus(r,k.RESPOND,{text:s.text,photo:s.photo,stickerID:s.stickerID})},logRender:function q(r){this._logCommentStatus(r,k.RENDER)},logInitAndSubmitSticker:function q(r,s){this._logCommentStatus(r,k.INIT,{text:0,photo:0,stickerID:s});this._logCommentStatus(r,k.SUBMIT,{text:0,photo:0,stickerID:s})},clear:function q(r){if(r in o)delete o[r]}};f.exports=p}),null);
__d("MLoadingIndicator.react",["IndicatorType","MJSAnimator","MJSEnvironment","React","ReactDOM","cx"],(function a(b,c,d,e,f,g,h,i,j,k,l,m){__p&&__p();var n,o,p=k.PropTypes,q=j.IS_APPLE_WEBKIT_IOS,r=j.IS_ANDROID&&j.OS_VERSION<4;n=babelHelpers.inherits(s,k.Component);o=n&&n.prototype;function s(){var t,u;"use strict";for(var v=arguments.length,w=Array(v),x=0;x<v;x++)w[x]=arguments[x];return u=(t=o.constructor).call.apply(t,[this].concat(w)),this.getClassName=function(){return(this.props.className||"")+" "+((!r?"_55on":"")+" _2so"+(this.props.background==="dark"?" _2st":"")+(this.props.background==="light"?" _2ss":"")+(this.props.size==="large"?" _2sq":"")+(this.props.size==="small"?" _2sp":"")+(!r&&!q?" _50cg":"")+(q?" _50ch":"")+(r?" _2su":""))}.bind(this),this.renderGradientIfNeeded=function(){if(r||!q)return null;return k.createElement("div",{className:"_2sr _55on"})},u}s.prototype.componentDidMount=function(){"use strict";if(r){this.$MLoadingIndicator1=new i(l.findDOMNode(this.refs.spinner),h.ANDROID_NONROTATING,false);this.$MLoadingIndicator1.start()}};s.prototype.componentWillUnmount=function(){"use strict";if(this.$MLoadingIndicator1){this.$MLoadingIndicator1.cleanup();this.$MLoadingIndicator1=null}};s.prototype.render=function(){"use strict";return k.createElement("div",{ref:"spinner",className:this.getClassName()},this.renderGradientIfNeeded())};s.propTypes={background:p.oneOf(["light","dark"]),size:p.oneOf(["small","large"])};s.defaultProps={background:"light",size:"large"};f.exports=s}),null);
__d("MProgressBar.react",["MAnimator","React","joinClasses","cx"],(function a(b,c,d,e,f,g,h,i,j,k){__p&&__p();var l=i.PropTypes,m=i.createClass({displayName:"MProgressBar",propTypes:{initialValue:l.number.isRequired,min:l.number,max:l.number},getDefaultProps:function n(){return{min:0,max:100}},getInitialState:function n(){return{value:this.props.initialValue}},componentWillUnmount:function n(){this._animator&&this._animator.dispose()},_calculatePercentage:function n(o){var p=this.props,q=Math.min(Math.max((o-p.min)/(p.max-p.min)*100,0),100);return q},_getFillArea:function n(){var o=this._calculatePercentage(this.state.value),p=Math.round(o),q="fill"+(p===0?" empty":"")+(p===100?" full":"");return i.createElement("div",{className:q,style:{width:o+"%"}})},animate:function n(o,p){var q=this._calculatePercentage(this.state.value),r=this._calculatePercentage(o);this._animator&&this._animator.dispose();this._animator=h.play(q,r,p,this.setValue)},setValue:function n(o){if(this.isMounted())this.setState({value:o})},render:function n(){return i.createElement("div",{className:j(this.props.className,"_lbu")},this._getFillArea())}});f.exports=m}),null);
__d("MXUILayout.react",["MXUIDiv.react","React","cx","joinClasses"],(function a(b,c,d,e,f,g,h,i,j,k){__p&&__p();var l,m;function n(p){return(p==="start"?"_52wc":"")+(p==="end"?" _52wd":"")+(p==="center"?" _52we":"")+(p==="stretch"?" _52wf":"")}l=babelHelpers.inherits(o,i.Component);m=l&&l.prototype;function o(){var p,q;"use strict";for(var r=arguments.length,s=Array(r),t=0;t<r;t++)s[t]=arguments[t];return q=(p=m.constructor).call.apply(p,[this].concat(s)),this.state={align:this.props.align},q}o.prototype.hasAlignSelfChildren=function(){"use strict";var p=i.Children.toArray(this.props.children);for(var q=0;q<p.length;q++){var r=p[q];if(Object.prototype.hasOwnProperty.call(r.props,"alignself"))return true}return false};o.prototype.render=function(){"use strict";__p&&__p();var p=this.props,q=p.align,r=p.className,s=p.children,t=babelHelpers.objectWithoutProperties(p,["align","className","children"]),u="_4g33",v=void 0;if(this.hasAlignSelfChildren())v=i.Children.toArray(s).map(function(w){if(Object.prototype.hasOwnProperty.call(w.props,"alignself"))return w;return i.cloneElement(w,{alignself:this.state.align})}.bind(this));else{v=s;u=k(n(q),u)}return i.createElement(h,babelHelpers["extends"]({},t,{className:k(r,u)}),v)};o.defaultProps={align:"stretch"};f.exports=o}),null);
__d("MXUILayoutColumn.react",["MXUIDiv.react","React","MJSEnvironment","joinClasses","cx"],(function a(b,c,d,e,f,g,h,i,j,k,l){__p&&__p();var m,n;function o(q){return(q==="start"?"_52wc":"")+(q==="end"?" _52wd":"")+(q==="center"?" _52we":"")+(q==="stretch"?" _52wf":"")}m=babelHelpers.inherits(p,i.Component);n=m&&m.prototype;p.prototype.render=function(){"use strict";var q=this.props,r=q.className,s=q.alignself,t=q.children,u=babelHelpers.objectWithoutProperties(q,["className","alignself","children"]);if(Object.prototype.hasOwnProperty.call(this.props,"alignself")){r=k(r,"_5i2i",o(s));if(j.IS_FIREFOX)return i.createElement(h,babelHelpers["extends"]({},u,{className:r}),i.createElement(h,{className:"_5xu4"},t))}return i.createElement(h,babelHelpers["extends"]({},u,{className:r}),t)};function p(){"use strict";m.apply(this,arguments)}f.exports=p}),null);
__d("MXUILayoutFillColumn.react",["MXUILayoutColumn.react","React","cx","joinClasses"],(function a(b,c,d,e,f,g,h,i,j,k){__p&&__p();var l,m;l=babelHelpers.inherits(n,i.Component);m=l&&l.prototype;n.prototype.render=function(){"use strict";var o="_4g34";return i.createElement(h,babelHelpers["extends"]({},this.props,{className:k(this.props.className,o)}),this.props.children)};function n(){"use strict";l.apply(this,arguments)}f.exports=n}),null);
__d("Grid.react",["React","cx","joinClasses"],(function a(b,c,d,e,f,g,h,i,j){__p&&__p();var k,l,m,n,o=h.PropTypes;k=babelHelpers.inherits(p,h.Component);l=k&&k.prototype;p.prototype.render=function(){"use strict";__p&&__p();var r=this.props,s=r.alignh,t=r.alignv,u=r.children,v=r.cols,w=r.fixed,x=r.spacing,y=h.Children.count(u),z=[],A=[],B=0;h.Children.forEach(u,function(C,D){__p&&__p();if(C===null||C===undefined)return;var E=C.type===q;B+=E?Math.max(C.props.colSpan||0,1):1;var F=B===v?"_51mw":"";if(!E)C=h.createElement(q,{alignh:s,alignv:t,className:j(x,F),key:C.key||D},C);else C=h.cloneElement(C,{key:C.key||D,alignh:C.props.alignh||s,alignv:C.props.alignv||t,className:j(C.props.className,x,F)});A.push(C);if(B%v===0||D+1===y){if(w&&B<v){for(var G=B;G<v;G++)A.push(h.createElement(q,{key:D+G}));B=v}z.push(h.createElement("tr",{className:"_51mx",key:D},A));A=[];B=0}});return h.createElement("table",babelHelpers["extends"]({},this.props,{className:j(this.props.className,"uiGrid _51mz"+(w?" _5f0n":"")),cellSpacing:"0",cellPadding:"0"}),h.createElement("tbody",null,z))};function p(){"use strict";k.apply(this,arguments)}p.propTypes={cols:o.number.isRequired,fixed:o.bool,alignv:o.oneOf(["top","middle","bottom"]),alignh:o.oneOf(["left","center","right"]),spacing:o.string};m=babelHelpers.inherits(q,h.Component);n=m&&m.prototype;q.prototype.render=function(){"use strict";var r=this.props,s=r.alignh,t=r.alignv,u=r.className,v=babelHelpers.objectWithoutProperties(r,["alignh","alignv","className"]),w=j(u,"_51m-"+(t==="top"?" vTop":"")+(t==="middle"?" vMid":"")+(t==="bottom"?" vBot":"")+(s==="left"?" hLeft":"")+(s==="center"?" hCent":"")+(s==="right"?" hRght":""));return h.createElement("td",babelHelpers["extends"]({},v,{className:w}))};function q(){"use strict";m.apply(this,arguments)}q.propTypes={alignv:o.oneOf(["top","middle","bottom"]),alignh:o.oneOf(["left","center","right"]),className:o.string};p.GridItem=q;f.exports=p}),null);
__d("MStickersWebDriverIDs",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({STICKER_BUTTON:"MStickersWebDriverIDsStickerButton",STICKER_SELECTOR_CONTENT:"MStickersWebDriverIDsStickerSelectorContent",STICKER_NONSEARCH_PACK_BUTTON:"MStickersWebDriverIDsStickerNonsearchPackButton",STICKER_PACK_ITEM:"MStickersWebDriverIDsStickerPackItem"})}),null);
__d("StickerInterfaces",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({MESSAGES:"messages",NEO:"neo",COMMENTS:"comments",STICKERED:"stickered",COMPOSER:"composer",POSTS:"posts",FRAMES:"frames",SMS:"sms",MONTAGE:"montage"})}),null);
__d("XStickerPackImagesController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/stickers/{pack_id}/images/",{pack_id:{type:"Int",required:true},sticker_size:{type:"Int",defaultValue:50}})}),null);
__d("XStickerQueryImagesController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/stickers/query/images/",{query:{type:"String",required:true},sticker_interface:{type:"String"}})}),null);
__d("MStickerPack.react",["Grid.react","MRequest","MStickersInitialData","MStickersWebDriverIDs","MURI","React","Image.react","ReactComponentWithPureRenderMixin","ShimButton.react","StickerInterfaces","XStickerPackImagesController","XStickerQueryImagesController","cx","ix","fbt","debounceCore"],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){"use strict";__p&&__p();var x=h.GridItem,y=j.MRU_STICKER_PACK,z=14,A={},B=m.createClass({displayName:"MStickerPack",mixins:[o],getInitialState:function C(){return{input:"",loading:false,searching:false,stickers:[]}},getDefaultProps:function C(){return{isComments:false}},componentWillMount:function C(){this._debouncedGetStickersForQuery=w(this.getStickersForQuery,500);this.getStickers(this.props.pack.id)},componentWillReceiveProps:function C(D){this.getStickers(D.pack.id)},componentWillUnmount:function C(){this._debouncedGetStickersForQuery.reset()},updateRecentlyUsed:function C(D){__p&&__p();var E=A[y]||[];for(var F=0;F<E.length;++F)if(E[F].id===D.id){E.splice(F,1);break}E.unshift(D);if(!A[y]){A[y]=E;j.packs.unshift(j.mru)}},getStickers:function C(D){__p&&__p();if(!D||D==j.SEARCH_PACK)return;if(D in A){this.setState({input:"",loading:false,stickers:A[D],searching:false});return}var E=r.getURIBuilder().setInt("pack_id",D).getURI(),F=new i(new l(E));F.listen("done",function(G){A[D]=G.payload;this.isMounted()&&this.setState({input:"",loading:false,stickers:G.payload,searching:false})}.bind(this));this.setState({loading:true});F.send()},getStickersForQuery:function C(D,E){__p&&__p();if(D.length===0){this.setState({loading:false,searching:false});return}if(D!=this.state.input&&!E)return;var F=s.getURIBuilder().setString("query",D).setString("sticker_interface",this.props.isComments?q.COMMENTS:q.MESSAGES).getURI(),G=new i(new l(F));G.listen("done",function(H){var I=H.payload||[];if(this.isMounted()&&D==this.state.input)this.setState({loading:false,stickers:I,searching:true})}.bind(this));this.setState({loading:true});G.send()},selectSticker:function C(D){this.updateRecentlyUsed(D);this.props.onSelect&&this.props.onSelect(D.id)},renderSticker:function C(D,E){__p&&__p();var F=null;if(this.props.isComments&&!D.isCommentsCapable){if(this.props.pack.id==j.MRU_STICKER_PACK)return}else if(!this.props.isComments&&!D.isMessengerCapable){if(this.props.pack.id==j.MRU_STICKER_PACK)return}else F=this.selectSticker.bind(this,D);var G=null;if(this.props.isFlyout)G="composer-submit";return m.createElement("a",{className:"_5asg","data-testid":k.STICKER_PACK_ITEM,"data-sigil":G,href:"#",key:"sticker-"+E,onClick:F,role:"button"},m.createElement(n,{src:D.uri,alt:v._("{pack name} {sticker name} sticker",[v.param("pack name",D.packName),v.param("sticker name",D.accessibilityLabel)])}))},_getRenderedFakeStickers:function C(){return Array.from(new Array(z),function(D,E){return m.createElement("div",{key:"fake-"+E,className:"_u2_"})})},_getRenderedStickerGridItems:function C(){return this.state.stickers.map(this.renderSticker).concat(this._getRenderedFakeStickers())},render:function C(){if(this.props.pack.id==j.SEARCH_PACK)return m.createElement("div",{className:"_5ash"},m.createElement("div",{className:"_5ef_"},this._renderSearch(),this._renderTags(),this._renderStickerSearchResults()),this._renderLoading());if(this.state.loading)return m.createElement("div",{className:"_5ash"},this._renderLoading());return m.createElement("div",{className:"_5ash"+(this.props.isComments&&!this.props.pack.isCommentsCapable?" _5jkg":""),onScroll:this.props.onScroll},m.createElement("div",{className:"_5ef_",onScroll:this._onScroll},this._getRenderedStickerGridItems()),this.renderMask())},_renderLoading:function C(){if(!this.state.loading)return null;return m.createElement("span",{className:"_5asi"},v._("Loading..."))},_renderStickerSearchResults:function C(){if(!this.state.searching||this.state.loading)return null;if(this.state.stickers.length===0)return m.createElement("div",{className:"_4op9"},m.createElement(n,{src:u("87146")}),m.createElement("p",null,v._("No Stickers to Show")));return m.createElement("div",{className:"_5ash"+(this.props.isComments&&!this.props.pack.isCommentsCapable?" _5jkg":""),onScroll:this.props.onScroll},m.createElement("div",{className:"_5ef_"},this._getRenderedStickerGridItems()),this.renderMask())},renderMask:function C(){if(!(this.props.isComments&&!this.props.pack.isCommentsCapable))return null;return m.createElement("div",{className:"_5jkh"},m.createElement("div",{className:"_5jki"},v._("This pack is only available in messages")))},_renderSearch:function C(){return m.createElement("div",{className:"_2j-l"},m.createElement("span",{className:"_2j-m"}),this._renderCloseButton(),m.createElement("div",{className:"_4opa"},m.createElement("input",{className:"_2j-n",onChange:this._inputChanged,onFocus:this.props.onInputFocus,onBlur:this.props.onInputBlur,ref:"stickerQuery",value:this.state.input,placeholder:v._("Search stickers"),type:"text"})))},_renderCloseButton:function C(){if(this.state.input.length>0)return m.createElement(p,{className:"_4opb",inline:true,onClick:this._clearInput})},_renderTags:function C(){if(this.state.searching||this.state.loading)return null;var D=j.tags.filter(function(E){return E.sourceURI!==null}).sort(function(E,F){return E.order-F.order}).map(function(E,F){return m.createElement(x,{className:"_2j-o",key:F},m.createElement("div",{className:"_2j-p"},m.createElement(p,{className:"_2j-q",onClick:this._selectTag.bind(this,E),style:{background:"#"+E.color_code}},m.createElement(n,{src:E.sourceURI}),m.createElement("span",null,E.name))))}.bind(this));return m.createElement(h,{className:"_2j-r",cols:2,fixed:true,ref:"grid"},D)},_inputChanged:function C(event){this.setState({input:event.target.value});this._debouncedGetStickersForQuery(event.target.value,false)},_clearInput:function C(){this.setState({input:"",loading:false,searching:false})},_selectTag:function C(D){this.setState({input:D.name});this.getStickersForQuery(D.name,true)}});f.exports=B}),null);
__d("MStickerPackButton.react",["Image.react","MStickersInitialData","MStickersWebDriverIDs","React","ShimButton.react","cx"],(function a(b,c,d,e,f,g,h,i,j,k,l,m){__p&&__p();var n,o;n=babelHelpers.inherits(p,k.PureComponent);o=n&&n.prototype;function p(){var q,r;"use strict";for(var s=arguments.length,t=Array(s),u=0;u<s;u++)t[u]=arguments[u];return r=(q=o.constructor).call.apply(q,[this].concat(t)),this.onClick=function(){this.props.onclick&&this.props.onclick(this.props.pack)}.bind(this),r}p.prototype.render=function(){"use strict";var q="_5arz _5cni"+(this.props.selected?" _5ar-":"")+(this.props.disabled?" _4f39":""),r=this.props.pack,s;if(r.id==i.MRU_STICKER_PACK)s=k.createElement("span",{className:"_3rsg"});else if(r.id==i.SEARCH_PACK)s=k.createElement("span",{className:"_cmr"});else s=k.createElement(h,{src:r.icon,alt:r.name});var t=r.id==i.SEARCH_PACK?null:j.STICKER_NONSEARCH_PACK_BUTTON;return k.createElement(l,{className:q,"data-testid":t,form:"link",onClick:this.onClick,rel:"ignore"},k.createElement("div",{className:"_3pcz"},s))};f.exports=p}),null);
__d("XStickerStorePermalinkController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/stickers/",{tab:{type:"String"},redirect_uri:{type:"String"},is_comments:{type:"Bool",defaultValue:false}})}),null);
__d("MStickerSelector.react",["BanzaiLogger","DOM","MPageController","MParent","MStickerPack.react","MStickerPackButton.react","MStickersInitialData","MStickersWebDriverIDs","MViewport","React","ReactDOM","Stratcom","SubscriptionsHandler","UserAgent","XStickerStorePermalinkController","getActiveElement","cx","fbt"],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y){__p&&__p();var z,A,B=q.PropTypes,C="feed-ufi-comments",D="scroll-area",E=48,F=5*E;z=babelHelpers.inherits(G,q.Component);A=z&&z.prototype;function G(I){"use strict";__p&&__p();A.constructor.call(this,I);H.call(this);var J=null;if(n.packs&&n.packs.length)for(var K=0;K<n.packs.length;K++)if(!I.isComments&&n.packs[K].isMessengerCapable||I.isComments&&n.packs[K].isCommentsCapable){J=n.packs[K];break}this.state={selectedPack:J,prevDisabled:true,nextDisabled:false,scrollLeft:0}}G.prototype.render=function(){"use strict";__p&&__p();if(!this.props.isOpen)return null;var I=n.packs.length===0?q.createElement("div",{className:"_5ar_"},y._("No stickers available")):q.createElement(l,{pack:this.state.selectedPack,onSelect:this.props.callback,onScroll:this.onPackScroll,onInputFocus:this.onInputFocus,onInputBlur:this.onInputBlur,isComments:this.props.isComments,isFlyout:this.props.isFlyout}),J=n.packs,K=[];for(var L=0;L<J.length;L++)if(J[L])if(this.props.isComments&&J[L].isCommentsCapable)K.push(J[L]);else if(J[L].isMessengerCapable)K.push(J[L]);J=K;J=J.map(this.renderPack,this);var M=v.getURIBuilder().setString("redirect_uri",j.getRenderedPath()).setBool("is_comments",this.props.isComments).getURI(),N=null;if(this.props.showStore)N=q.createElement("a",{className:"_5cni _5b3_",href:M.toString()},q.createElement("span",{className:"_5b40"}),this.renderIndicator());var O=u.isPlatform("Android <2.4");return q.createElement("div",{className:this.props.className,"data-testid":o.STICKER_SELECTOR_CONTENT,ref:"root"},q.createElement("div",{className:"_5as0"+(O?" _2-n8":""),ref:"selector"},q.createElement("div",{className:"_5as1",onScroll:this.state.inputFocused?this.$MStickerSelector4:null},I),q.createElement("div",{className:"_5as2",ref:"selectorRow",style:{marginLeft:-this.state.scrollLeft}},q.createElement("div",{className:"_5as5"},J)),this.$MStickerSelector5(),this.$MStickerSelector6(),N))};G.prototype.componentDidMount=function(){"use strict";if(this.props.isOpen){this.$MStickerSelector8();this.$MStickerSelector7()}};G.prototype.componentWillUnmount=function(){"use strict";this.$MStickerSelector9()};G.prototype.componentDidUpdate=function(I,J){"use strict";__p&&__p();if(this.props.isOpen){if(!I.isOpen)this.$MStickerSelector8();if(this.state.selectedPack!=J.selectedPack||this.props.isOpen!=I.isOpen){var K=r.findDOMNode(this.refs.selector);if(k.bySigil(K,C))s.invoke("MStickerSelector:show-sticker-selector",null,{selectorNode:K});else p.scrollToNodeIfNecessary(r.findDOMNode(this.refs.selector))}if(this.props.isOpen!=I.isOpen){this.$MStickerSelector7();h.log("MTouchStickersLoggerConfig",{event:"open_tray"})}}else if(I.isOpen)this.$MStickerSelector9()};G.propTypes={callback:B.func.isRequired,isComments:B.bool.isRequired,isOpen:B.bool,onClose:B.func,showStore:B.bool.isRequired,isFlyout:B.bool};G.defaultProps={isComments:true,showStore:true};var H=function H(){__p&&__p();this.$MStickerSelector1=null;this.onPackSelect=function(I){h.log("MTouchStickersLoggerConfig",{event:"select_pack",packid:I.id});this.setState({selectedPack:I})}.bind(this);this.onPackScroll=function(){if(this.state.selectedPack&&this.state.selectedPack.id!=this.$MStickerSelector2){this.$MStickerSelector2=this.state.selectedPack.id;h.log("MTouchStickersLoggerConfig",{event:"scroll_pack",packid:this.state.selectedPack.id})}}.bind(this);this.onInputFocus=function(){this.setState({inputFocused:true})}.bind(this);this.onInputBlur=function(){this.setState({inputFocused:false})}.bind(this);this.scrollPrev=function(){if(!this.state.prevDisabled){var I=Math.max(this.state.scrollLeft-F,0);this.setState({scrollLeft:I,prevDisabled:I===0,nextDisabled:false})}}.bind(this);this.scrollNext=function(){if(!this.state.nextDisabled){var I=r.findDOMNode(this.refs.selectorRow),J=I.scrollWidth-I.parentNode.clientWidth,K=Math.min(this.state.scrollLeft+F,J);this.setState({scrollLeft:K,prevDisabled:false,nextDisabled:this.$MStickerSelector3(K)})}}.bind(this);this.$MStickerSelector3=function(I){var J=r.findDOMNode(this.refs.selectorRow),K=J.scrollWidth-J.parentNode.clientWidth;return I>=K}.bind(this);this.renderPack=function(I,J){return q.createElement(m,{disabled:this.props.isComments&&!I.isCommentsCapable||!this.props.isComments&&!I.isMessengerCapable,key:"pack-"+J,onclick:this.onPackSelect,pack:I,selected:I.id==this.state.selectedPack.id})}.bind(this);this.renderIndicator=function(){if(!n.storeIndicator)return null;return q.createElement("div",{className:"_5e-s"})};this.$MStickerSelector5=function(){return q.createElement("a",{"aria-label":y._("Previous Sticker Packs"),className:"_5cni _5abu",disabled:this.state.prevDisabled,href:"#",onClick:this.scrollPrev,ref:"prevButton",rel:"ignore",role:"button"},q.createElement("span",{className:"_5abw"}))}.bind(this);this.$MStickerSelector6=function(){return q.createElement("a",{"aria-label":y._("Next Sticker Packs"),className:"_5cni _5abx",disabled:this.state.nextDisabled,href:"#",onClick:this.scrollNext,ref:"nextButton",rel:"ignore",role:"button"},q.createElement("span",{className:"_5aby"}))}.bind(this);this.$MStickerSelector7=function(){this.setState({nextDisabled:this.$MStickerSelector3(this.state.scrollLeft)})}.bind(this);this.$MStickerSelector4=function(event){w().blur()};this.$MStickerSelector8=function(){__p&&__p();if(this.$MStickerSelector1)return;var I=r.findDOMNode(this.refs.root);if(!I)return;if(k.bySigil(I,D)){var J=new t();J.addSubscriptions(i.listen(I,"touchmove",null,function(event){event.stop()}),s.listen("m:page:unload",null,function(){this.$MStickerSelector9()}.bind(this)));if(k.bySigil(I,C))J.addSubscriptions(s.listen("m:feed-ufi-flyout:reset",null,function(){this.$MStickerSelector9()}.bind(this)));this.$MStickerSelector1=J}}.bind(this);this.$MStickerSelector9=function(){this.$MStickerSelector1&&this.$MStickerSelector1.release();this.$MStickerSelector1=null}.bind(this)};f.exports=G}),null);
__d("asset",[],(function a(b,c,d,e,f,g){function h(i){throw new Error("asset("+JSON.stringify(i)+"): Unexpected asset reference.")}f.exports=h}),null);
__d("MStickerSelectorButton.react",["Image.react","React","asset","cx","fbt","ix","fbglyph"],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n){__p&&__p();var o,p,q=i.PropTypes;o=babelHelpers.inherits(r,i.Component);p=o&&o.prototype;function r(){var s,t;"use strict";for(var u=arguments.length,v=Array(u),w=0;w<u;w++)v[w]=arguments[w];return t=(s=p.constructor).call.apply(s,[this].concat(v)),this.state={isSelected:this.props.isSelected},this.onClick=function(event){this.setState({isSelected:!this.state.isSelected});this.props.onClick&&this.props.onClick(event)}.bind(this),t}r.prototype.componentWillUpdate=function(s,t){"use strict";if(s!==this.props)this.setState({isSelected:s.isSelected});if(this.props.onToggle&&t!==this.state)this.props.onToggle(t.isSelected)};r.prototype.render=function(){"use strict";var s;if(!this.state.isSelected)s=m("90727");else s=m("90728");return i.createElement("button",{"aria-label":l._("Add sticker"),type:"button",className:"_5ecn _1n29 _2fv6","data-sigil":"touchable",onClick:this.onClick},i.createElement(h,{src:s,className:"_2fv7"}),i.createElement(h,{src:this.state.isSelected?m("432358"):m("432368"),className:"_2fv8"}))};r.propTypes={onToggle:q.func,isSelected:q.bool};r.defaultProps={isSelected:false};f.exports=r}),null);
__d("MStickerMount",["BanzaiLogger","ClientIDs","DOM","MAjaxify","MCommentStatusLogger","MRequest","MStickerSelector.react","MStickerSelectorButton.react","ReactComponentRenderer","Run","Stratcom","SubscriptionsHandler","$"],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){"use strict";__p&&__p();var u="m-textarea-input",v=function v(z,A,B,C){__p&&__p();var D=new m(z.action);D.setMethod("POST");D.addData({client_id:i.getNewClientID(),sticker_id:A});var E=j.convertFormToDictionary(z);if(E.privacy_value)D.addData({privacy_value:E.privacy_value});if(B){var F=l.newInteractionKey();l.logInitAndSubmitSticker(F,A);D.addData({logging_interaction_key:F});x(F)}k.ajaxify(null,z,D,"async_composer");r.invoke("m:ufi:sticker-comment",null,{textInput:C})},w=function w(z,A,B,C,D,E){__p&&__p();var F=arguments.length<=6||arguments[6]===undefined?false:arguments[6],G=void 0,H=new p(n,A);H.setProps({callback:C,isComments:D,onClose:function J(){H&&H.setProps({isOpen:false});G&&G.setProps({isSelected:false})},showStore:E,isFlyout:F});G=new p(o,z);G.setProps({onToggle:function J(K){H.setProps({isOpen:K})}});var I=new s();I.addSubscriptions(j.listen(B,"focus",null,function(){G.setProps({isSelected:false})}),r.listen("m:ufi:sticker-comment",null,function(){G.setProps({isSelected:false})}));q.onLeave(function(){I.release();G.unmount();H.unmount()})};function x(z){__p&&__p();var A=new s();A.addSubscriptions(r.listen("m:ufi:live-comments:render",null,function(event){var B=event.getData()||{},C=B.logKeys;C&&C.forEach(function(D){if(D===z){l.logRender(z);A.release()}})}),r.listen("m:ufi:iui:comment-added",null,function(event){var B=event.getData().loggingInteractionKey;if(B===z){l.logRender(z);A.release()}}),r.listen("m:page:unload",null,function(){A.release()}));return A}var y={initMessages:function z(A,B,C,D){var E=t(C),F=function F(G){var H=E.form,I=j.convertFormToDictionary(H);I.sticker_id=G;D.sendRequest(H.action,I)};w(A,B,E,F,false,true)},initCommentsFlyout:function z(A,B,C,D){__p&&__p();var E=arguments.length<=4||arguments[4]===undefined?false:arguments[4],F=null;if(D)if(r.hasSigil(D,u))F=D;else F=j.scry(D,"*",u)[0];if(!F)F=t(C);var G=F.form;B.onclick=function(){v(G,A,E,F);h.log("NullStateCommentsLoggerConfig",{event:"sticker_selection",sticker_id:A.toString()})}},initComments:function z(A,B,C,D){__p&&__p();var E=arguments.length<=4||arguments[4]===undefined?false:arguments[4],F=arguments.length<=5||arguments[5]===undefined?false:arguments[5],G=null;if(D)if(r.hasSigil(D,u))G=D;else G=j.scry(D,"*",u)[0];if(!G)G=t(C);var H=G.form,I=function I(J){v(H,J,E,G)};w(A,B,G,I,true,true,F)},initNewMessage:function z(A,B,C,D){var E=function E(F){D.sendSticker(F)};w(A,B,C,E,false,false)}};f.exports=y}),null);
__d("MMultiPhotoUploaderAttachment.react",["MMultiPhotoUploaderAttachmentState","MLoadingIndicator.react","MProgressBar.react","React","Image.react","ShimButton.react","cx","fbt","joinClasses"],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){__p&&__p();var q,r,s=2,t=.7,u=500,v=1e4,w=250;q=babelHelpers.inherits(x,k.Component);r=q&&q.prototype;function x(){__p&&__p();var y,z;"use strict";for(var A=arguments.length,B=Array(A),C=0;C<A;C++)B[C]=arguments[C];return z=(y=r.constructor).call.apply(y,[this].concat(B)),this.$Attachment1=false,this.$Attachment2=0,this.state={previewLoaded:false},this.getLoadingIndicator=function(){if(this.props.loaded>0)if(!this.state.previewLoaded)return this.getProgressBar();else return this.getSpinner();else return this.getSpinner()}.bind(this),this.getProgressBar=function(){if(this.props.state!==h.SENDING&&this.props.state!==h.UPLOADED)return null;if(this.state.previewLoaded)return null;return k.createElement("div",{className:"_r6h"},k.createElement(j,{initialValue:0,ref:"progressBar"}))}.bind(this),this.getSpinner=function(){if(this.props.state!==h.SENDING&&!this.props.isPollingTagSuggestions)return null;return k.createElement("div",{className:this.props.isPollingTagSuggestions?"_2d1s":""},k.createElement(i,{className:"_5r-2"}))}.bind(this),this.getPreview=function(D,E){if(this.props.state!==h.UPLOADED)return null;if(!this.state.previewLoaded)return null;return k.createElement(l,{className:"_5r-3",src:this.props.imageURI,width:D,height:E})}.bind(this),this.getError=function(){if(this.props.state!==h.ERROR)return null;return k.createElement("div",{className:"_5r-4"})}.bind(this),this.getAbortButton=function(){var D=this.props.shouldShowWhiteDesign?"_3lx9":"_5r-6",E=this.props.shouldShowWhiteDesign?"_3lxa":"_5r-5";return k.createElement(m,{"aria-label":o._("Remove Photo"),className:E,"data-sigil":"touchable",onClick:this.props.onRemoveClick},k.createElement("div",{className:D}))}.bind(this),this.getTagCountIndicator=function(){if(this.props.state!==h.UPLOADED)return null;if(!this.state.previewLoaded)return null;var D=this.props.tagCount;if(!D)return null;var E="_5pt"+(D===1?" _5pu":"")+(D===2?" _5pv":"")+(D>2?" _5pw":"");return k.createElement("div",{className:E})}.bind(this),this.getPhotoBorder=function(){var D=null;if(this.props.shouldShowWhiteDesign)D=k.createElement("div",{className:"_23rn"});return D}.bind(this),z}x.prototype.componentDidMount=function(){"use strict";this.$Attachment1=true;if(this.props.state===h.UPLOADED&&!this.state.previewLoaded)this.loadPreview()};x.prototype.componentDidUpdate=function(y,z){"use strict";__p&&__p();if(this.refs.progressBar)if(this.props.state===h.SENDING&&this.props.loaded&&this.props.totalSize)if(this.props.loaded===this.props.totalSize)this.refs.progressBar.animate(100,v);else{var A=100*t*this.props.loaded/this.props.totalSize;this.refs.progressBar.animate(A,u)}if(y.state!==h.UPLOADED&&this.props.state===h.UPLOADED)this.loadPreview();if(!z.previewLoaded&&this.state.previewLoaded&&this.props.onPreviewLoaded)this.props.onPreviewLoaded()};x.prototype.componentWillUnmount=function(){"use strict";this.$Attachment1=false};x.prototype.loadPreview=function(){"use strict";__p&&__p();var y=++this.$Attachment2;if(this.refs.progressBar)this.refs.progressBar.animate(100,v);var z=new Image();z.onload=function(){__p&&__p();if(!this.$Attachment1||y!==this.$Attachment2)return;if(this.refs.progressBar){this.refs.progressBar.animate(100,w);setTimeout(function(){if(!this.$Attachment1||y!==this.$Attachment2)return;this.setState({previewLoaded:true})}.bind(this),w)}else this.setState({previewLoaded:true})}.bind(this);z.src=this.props.imageURI;if(z.complete||z.width+z.height>0){z.onload=null;this.setState({previewLoaded:true})}};x.prototype.getSphericalPhotoIcon=function(){"use strict";if(!this.props.isSpherical)return null;return k.createElement("div",{className:"_42p8"+(!this.state.previewLoaded||this.props.state!==h.UPLOADED?" _42p9":"")})};x.prototype.render=function(){"use strict";__p&&__p();var y;if(this.props.shouldShowWhiteDesign)y="_s50";else if(this.props.shouldShowLargeThumbnails)y="_3vnj";else y="_51s2";var z=this.props.previewSize-s,A=z;if(this.props.state===h.UPLOADED&&this.state.previewLoaded&&this.props.shouldShowLargeThumbnails)A=Math.floor(this.props.thumbnail_width*z/this.props.thumbnail_height);var B={width:A};return k.createElement("div",{className:p(this.props.className,y),style:B},k.createElement("div",{onClick:this.props.onThumbnailClicked,"data-sigil":"touchable",role:"presentation"},this.getLoadingIndicator(),this.getPreview(A,z),this.getError(),this.getTagCountIndicator(),this.getPhotoBorder(),this.getSphericalPhotoIcon()),this.getAbortButton())};f.exports=x}),null);
__d("MMultiPhotoUploaderHiddenInputs.react",["React"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k=h.PropTypes;i=babelHelpers.inherits(l,h.Component);j=i&&i.prototype;l.prototype.render=function(){"use strict";var m=null;if(this.props.waterfallSource)m=h.createElement("input",{name:"waterfall_source",type:"hidden",value:this.props.waterfallSource});return h.createElement("div",null,m,this.props.fbids.map(function(n){return h.createElement("input",{key:n,type:"hidden",name:"photo_ids["+n+"]",value:n})}))};function l(){"use strict";i.apply(this,arguments)}l.propTypes={fbids:k.array.isRequired,waterfallSource:k.string};f.exports=l}),null);
__d("MMultiPhotoUploaderPlusAttachment.react",["MXUILayout.react","MXUILayoutFillColumn.react","React","ShimButton.react","cx","fbt"],(function a(b,c,d,e,f,g,h,i,j,k,l,m){__p&&__p();var n,o;n=babelHelpers.inherits(p,j.Component);o=n&&n.prototype;function p(){__p&&__p();var q,r;"use strict";for(var s=arguments.length,t=Array(s),u=0;u<s;u++)t[u]=arguments[u];return r=(q=o.constructor).call.apply(q,[this].concat(t)),this.getAttachmentChildContainer=function(){if(!this.props.shouldShowWhiteDesign)return null;var v=this.props.shouldShowAddPhotoLabel?j.createElement("div",{className:"_vbw"},m._("photo")):null;return j.createElement(h,null,j.createElement(i,{alignself:"center",className:"_2-24"},j.createElement("div",{className:"_vbx"},j.createElement("div",{className:"_vby"}),v)))}.bind(this),this.getAttachmentClass=function(){var v,w=this.props.largeThumbnails;if(this.props.shouldShowWhiteDesign)v="_vbz";else v=(w?"_3vnj":"")+(!w?" _51s2":"")+(w?" _14y0":"")+(!w?" _5e0r":"");return v}.bind(this),r}p.prototype.render=function(){"use strict";var q=this.getAttachmentClass(),r=this.getAttachmentChildContainer();return j.createElement(k,{"aria-label":m._("Add Photo"),className:q,"data-sigil":"touchable",onClick:this.props.onClick},r)};f.exports=p}),null);
__d("MPhotoUploadDisable",["DOM","Stratcom","fbt"],(function a(b,c,d,e,f,g,h,i,j){var k={IOS_8_PHOTO_UPLOAD_DISABLE_MESSAGE:j._("Sorry, photo uploading isn't available for Safari in iOS 8.0 and 8.0.1. Apple has fixed this in the latest version of iOS. Please upgrade to iOS 8.0.2 and try again."),alertIOS8FileUploadDisabled:function l(event){alert(this.IOS_8_PHOTO_UPLOAD_DISABLE_MESSAGE);event.kill()},disableIOS8FileUpload:function l(m){this._listeners=[h.listen(m,"click",null,this.alertIOS8FileUploadDisabled.bind(this)),i.listen("m:page:unload",null,this._cleanup.bind(this))]},_cleanup:function l(){this._listeners.forEach(function(m){m.remove()})}};f.exports=k}),null);
__d("MPhotoUploadFileInput",["DOM","MTouchClick","Stratcom"],(function a(b,c,d,e,f,g,h,i,j){__p&&__p();function k(l){"use strict";this.$MPhotoUploadFileInput1=l}k.prototype.setChangeHandler=function(l){"use strict";this.$MPhotoUploadFileInput2&&this.$MPhotoUploadFileInput2.remove();this.$MPhotoUploadFileInput3=l;if(this.$MPhotoUploadFileInput3!=null)this.$MPhotoUploadFileInput2=h.listen(this.$MPhotoUploadFileInput1,"change",null,this.$MPhotoUploadFileInput3)};k.prototype.setClickHandler=function(l){"use strict";this.$MPhotoUploadFileInput4&&this.$MPhotoUploadFileInput4.remove();this.$MPhotoUploadFileInput5=l;if(this.$MPhotoUploadFileInput5!=null)this.$MPhotoUploadFileInput4=h.listen(this.$MPhotoUploadFileInput1,"click",null,this.$MPhotoUploadFileInput5)};k.prototype.destroy=function(){"use strict";this.setChangeHandler(null);this.setClickHandler(null)};k.prototype.getDOMElement=function(){"use strict";return this.$MPhotoUploadFileInput1};k.prototype.cloneDOMNode=function(){"use strict";__p&&__p();var l=this.$MPhotoUploadFileInput1;this.$MPhotoUploadFileInput1=l.cloneNode(true);this.$MPhotoUploadFileInput1.value="";h.replace(l,this.$MPhotoUploadFileInput1);if(this.$MPhotoUploadFileInput3)this.setChangeHandler(this.$MPhotoUploadFileInput3);if(this.$MPhotoUploadFileInput5)this.setClickHandler(this.$MPhotoUploadFileInput5);return l};k.prototype.click=function(l){"use strict";var event=l.nativeEvent,m=event.changedTouches;i.click(this.$MPhotoUploadFileInput1,{getRawEvent:function n(){return event},getTouch:function n(){return m&&m[0]||{}}})};f.exports=k}),null);
/**
 * License: https://www.facebook.com/legal/license/H9BaGD_QUja/
 */
__d("MegaPixImage",[],(function a(b,c,d,e,f,g){__p&&__p();function h(o){var p=o.naturalWidth,q=o.naturalHeight;if(p*q>1024*1024){var r=document.createElement("canvas");r.width=r.height=1;var s=r.getContext("2d");s.drawImage(o,-p+1,0);return s.getImageData(0,0,1,1).data[3]===0}else return false}function i(o,p,q){__p&&__p();var r=document.createElement("canvas");r.width=1;r.height=q;var s=r.getContext("2d");s.drawImage(o,0,0);var t=s.getImageData(0,0,1,q).data,u=0,v=q,w=q;while(w>u){var x=t[(w-1)*4+3];if(x===0)v=w;else u=w;w=v+u>>1}var y=w/q;return y===0?1:y}function j(o,p,q){var r=document.createElement("canvas");k(o,r,p,q);return r.toDataURL("image/jpeg",p.quality||.8)}function k(o,p,q,r){__p&&__p();var s=o.naturalWidth,t=o.naturalHeight,u=q.width,v=q.height,w=p.getContext("2d");w.save();l(p,u,v,q.orientation);var x=h(o);if(x){s/=2;t/=2}var y=1024,z=document.createElement("canvas");z.width=z.height=y;var A=z.getContext("2d"),B=r?i(o,s,t):1,C=Math.ceil(y*u/s),D=Math.ceil(y*v/t/B),E=0,F=0;while(E<t){var G=0,H=0;while(G<s){A.clearRect(0,0,y,y);A.drawImage(o,-G,-E);w.drawImage(z,0,0,y,y,H,F,C,D);G+=y;H+=C}E+=y;F+=D}w.restore();z=A=null}function l(o,p,q,r){__p&&__p();switch(r){case 5:case 6:case 7:case 8:o.width=q;o.height=p;break;default:o.width=p;o.height=q}var s=o.getContext("2d");switch(r){case 2:s.translate(p,0);s.scale(-1,1);break;case 3:s.translate(p,q);s.rotate(Math.PI);break;case 4:s.translate(0,q);s.scale(1,-1);break;case 5:s.rotate(.5*Math.PI);s.scale(1,-1);break;case 6:s.rotate(.5*Math.PI);s.translate(0,-q);break;case 7:s.rotate(.5*Math.PI);s.translate(p,-q);s.scale(-1,1);break;case 8:s.rotate(-.5*Math.PI);s.translate(-p,0);break;default:break}}var m=window.URL&&window.URL.createObjectURL?window.URL:window.webkitURL&&window.webkitURL.createObjectURL?window.webkitURL:null;function n(o){__p&&__p();if(o instanceof Blob){var p=new Image();if(!m)throw Error("No createObjectURL function found to create blob url");p.src=m.createObjectURL(o);this.blob=o;o=p}if(!o.naturalWidth&&!o.naturalHeight){var q=this;o.onload=function(){var r=q.imageLoadListeners;if(r){q.imageLoadListeners=null;for(var s=0,t=r.length;s<t;s++)r[s]()}};this.imageLoadListeners=[]}this.srcImage=o}n.isSupported=!!m;n.prototype.render=function(o,p){__p&&__p();if(this.imageLoadListeners){var q=this;this.imageLoadListeners.push(function(){q.render(o,p)});return}p=p||{};var r=this.srcImage.naturalWidth,s=this.srcImage.naturalHeight,t=p.width,u=p.height,v=p.maxWidth,w=p.maxHeight,x=!this.blob||this.blob.type==="image/jpeg";if(t&&!u)u=s*t/r<<0;else if(u&&!t)t=r*u/s<<0;else{t=r;u=s}if(v&&t>v){t=v;u=s*t/r<<0}if(w&&u>w){u=w;t=r*u/s<<0}var y={width:t,height:u};for(var z in p)y[z]=p[z];var A=o.tagName.toLowerCase();if(A==="img")o.src=j(this.srcImage,y,x);else if(A==="canvas")k(this.srcImage,o,y,x);if(typeof this.onrender==="function")this.onrender(o)};f.exports=n}),null);
__d("PUWSteps",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({CLIENT_FLOW_BEGIN:"client_flow_begin",CLIENT_SELECT_BEGIN:"client_select_begin",CLIENT_SELECT_SUCCESS:"client_select_success",CLIENT_SELECT_CANCEL:"client_select_cancel",CLIENT_SELECT_FAIL:"client_select_fail",CLIENT_FLOW_POST:"client_flow_post",CLIENT_TRANSFER_BATCH_BEGIN:"client_transfer_batch_begin",CLIENT_UPLOAD_BEGIN:"client_upload_begin",CLIENT_ATTACH_PHOTO:"client_attach_photo",CLIENT_PROCESS_BEGIN:"client_process_begin",CLIENT_PROCESS_SUCCESS:"client_process_success",CLIENT_PROCESS_CANCEL:"client_process_cancel",CLIENT_PROCESS_SKIP:"client_process_skip",CLIENT_PROCESS_FAIL:"client_process_fail",CLIENT_PROCESS_UNAVAILABLE:"client_process_unavailable",CLIENT_SPHERICAL_CHECK_SUCCESS:"client_spherical_check_success",CLIENT_SPHERICAL_CHECK_FAIL:"client_spherical_check_fail",CLIENT_TRANSFER_ENQUEUE:"client_transfer_enqueue",CLIENT_TRANSFER_BEGIN:"client_transfer_begin",CLIENT_TRANSFER_SUCCESS:"client_transfer_success",CLIENT_TRANSFER_CANCEL:"client_transfer_cancel",CLIENT_TRANSFER_FAIL:"client_transfer_fail",CLIENT_TRANSFER_MANUAL_RETRY:"client_transfer_manual_retry",CLIENT_UPLOAD_SUCCESS:"client_upload_success",CLIENT_UPLOAD_FAIL:"client_upload_fail",CLIENT_UPLOAD_CANCEL:"client_upload_cancel",CLIENT_UPLOAD_REMOVE:"client_upload_remove",CLIENT_FACEREC_BEGIN:"client_facerec_begin",CLIENT_FACEREC_SUCCESS:"client_facerec_success",CLIENT_FACEREC_FAIL:"client_facerec_fail",CLIENT_PHOTO_PREVIEW_OPEN:"client_photo_preview_open",CLIENT_PHOTO_PREVIEW_CLOSE:"client_photo_preview_close",CLIENT_TRANSFER_BATCH_SUCCESS:"client_transfer_batch_success",CLIENT_TRANSFER_BATCH_CANCEL:"client_transfer_batch_cancel",CLIENT_TRANSFER_BATCH_FAIL:"client_transfer_batch_fail",CLIENT_PUBLISH_ENQUEUE:"client_publish_enqueue",CLIENT_PUBLISH_BEGIN:"client_publish_begin",CLIENT_PUBLISH_SUCCESS:"client_publish_success",CLIENT_PUBLISH_FAIL:"client_publish_fail",CLIENT_ATTEMPT_FAIL:"client_attempt_fail",CLIENT_FLOW_SUCCESS:"client_flow_success",CLIENT_FLOW_FATAL:"client_flow_fatal",CLIENT_FLOW_GIVEUP:"client_flow_giveup",CLIENT_FLOW_CANCEL:"client_flow_cancel",CLIENT_FLOW_FAIL:"client_flow_fail",CLIENT_FLOW_INCOMPLETE:"client_flow_incomplete",CLIENT_ATTEMPT_INCOMPLETE:"client_attempt_incomplete",CLIENT_FLOW_RETRY:"client_flow_retry",CLIENT_ATTEMPT_RETRY:"client_attempt_retry",CLIENT_DIAGNOSTIC:"client_diagnostic",CLIENT_QUALITY_SWITCH:"client_quality_switch",CLIENT_CANCEL_SURVEY:"client_cancel_survey",CLIENT_PHOTO_EDIT_BEGIN:"client_photo_edit_begin",CLIENT_PHOTO_EDIT_SUCCESS:"client_photo_edit_success",SERVER_UPLOAD_BEGIN:"server_upload_begin",SERVER_UPLOAD_SUCCESS:"server_upload_success",SERVER_UPLOAD_FAIL:"server_upload_fail",SERVER_PUBLISH_BEGIN:"server_publish_begin",SERVER_PUBLISH_SUCCESS:"server_publish_success",SERVER_PUBLISH_FAIL:"server_publish_fail",SERVER_RECEIVER_BEGIN:"server_receiver_begin",SERVER_RECEIVER_PUBLISH_BEGIN:"server_receiver_publish_begin",SERVER_SENTRY_RESTRICTION:"server_sentry_restriction"})}),null);
__d("PhotosUploadWaterfallXMixin",["AsyncSignal","Banzai","Map","PhotosUploadWaterfallXConfig","Set","invariant","randomInt"],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n){__p&&__p();var o=new j();function p(r,s){var t={};r.client_time=Math.round(Date.now()/1e3);if(k.retryBanzai){t.retry=true;r.nonce=n(4294967296)}i.post(k.banzaiRoute,r,t);if(s)setTimeout(s,0)}function q(r,s){if(k.useBanzai)p(r,s);else{var t=new h(k.loggingEndpoint,{data:JSON.stringify(r)}).setHandler(s);if(k.timeout)t.setTimeout(10*1e3);t.send()}}f.exports={logStep:function r(s,t,u){var v=this.getWaterfallID&&this.getWaterfallID(),w=this.getWaterfallAppName&&this.getWaterfallAppName();if(!v||!w)return;q(babelHelpers["extends"]({step:s,qn:v,uploader:w,ref:this.getWaterfallSource&&this.getWaterfallSource()},t),u)},logPUWStep:function r(s,t,u,v,w,x,y){if(x&&x.logOncePerSession){if(!o.has(t))o.set(t,new l());if(o.get(t).has(s))return;o.get(t).add(s)}q(Object.assign({step:s,qn:t,uploader:u,ref:v},w),y)}}}),null);
__d("base64toUint8Array",[],(function a(b,c,d,e,f,g){function h(i){var j=atob(i),k=j.length,l=new Uint8Array(k);for(var m=0;m<k;m++)l[m]=j.charCodeAt(m);return l}f.exports=h}),null);
__d("DataViewPolyfill",[],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(i,j,k){if(j===undefined)this.$DataViewPolyfill1=new Uint8Array(i);else if(k===undefined)this.$DataViewPolyfill1=new Uint8Array(i,j);else this.$DataViewPolyfill1=new Uint8Array(i,j,k);this.byteLength=this.$DataViewPolyfill1.byteLength}h.prototype.getUint8=function(i){if(i>=this.$DataViewPolyfill1.length)throw new Error("Trying to read beyond bounds of DataViewPolyfill");return this.$DataViewPolyfill1[i]};h.prototype.getUint16=function(i,j){var k=this.getUint8(i),l=this.getUint8(i+1);return j?l*256+k:k*256+l};h.prototype.getUint32=function(i,j){var k=this.getUint8(i),l=this.getUint8(i+1),m=this.getUint8(i+2),n=this.getUint8(i+3);return j?((n*256+m)*256+l)*256+k:((k*256+l)*256+m)*256+n};h.isSupported=function(){return!!b.Uint8Array};f.exports=h}),null);
__d("getExifOrientation",["DataViewPolyfill"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=b.DataView||h;function j(k,l){__p&&__p();var m=new FileReader();m.onload=function(n){__p&&__p();var o="Exif\0\0",p=0,q,r=new i(n.target.result);for(var s=0;s<250;s++)if(r.getUint8(s)===o.charCodeAt(p)){p+=1;q=s+1;if(p===o.length)break}else p=0;if(!p){l(null);return}var t;if(r.getUint8(q)==77&&r.getUint8(q+1)==77)t=false;else if(r.getUint8(q)==73&&r.getUint8(q+1)==73)t=true;else{l(null);return}q+=2;q+=2;var u,v,w,x;u=r.getUint32(q,t);q+=u-8+4;v=r.getUint16(q,t);q+=2;for(var y=0;y<Math.min(25,v);y++){w=r.getUint16(q,t);q+=8;if(w==274){x=r.getUint16(q,t);l(x);return}q+=4}l(null)};m.readAsArrayBuffer(k)}f.exports=j}),null);
__d("MPhotoResizer",["base64toUint8Array","getExifOrientation","invariant","mixin","performanceNow","requestAnimationFrame","PhotosUploadWaterfallXMixin","PUWSteps","MegaPixImage","Vector"],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){__p&&__p();var r,s,t="data:image/jpeg;base64,";r=babelHelpers.inherits(u,k(n));s=r&&r.prototype;function u(){"use strict";s.constructor.call(this);this.$MPhotoResizer1=new q(960,960);this.$MPhotoResizer2=.85}u.prototype.setFile=function(v){"use strict";this.$MPhotoResizer3=v;return this};u.prototype.setDimensions=function(v){"use strict";this.$MPhotoResizer1=v;return this};u.prototype.setQuality=function(v){"use strict";this.$MPhotoResizer2=v;return this};u.prototype.setHandler=function(v){"use strict";this.$MPhotoResizer4=v;return this};u.prototype.setWaterfall=function(v,w,x){"use strict";this.$MPhotoResizer5=v;this.$MPhotoResizer6=w;this.$MPhotoResizer7=x;return this};u.prototype.resize=function(){"use strict";__p&&__p();this.$MPhotoResizer3||j(0);this.$MPhotoResizer1||j(0);this.$MPhotoResizer2||j(0);this.$MPhotoResizer4||j(0);this.$MPhotoResizer5||j(0);this.$MPhotoResizer6||j(0);if(!p.isSupported){this.logStep(o.CLIENT_PROCESS_UNAVAILABLE,{error:"canvas_not_supported"});this.$MPhotoResizer4(this.$MPhotoResizer3);return}if(!this.$MPhotoResizer8()){this.logStep(o.CLIENT_PROCESS_UNAVAILABLE,{error:"no_jpeg_output"});this.$MPhotoResizer4(this.$MPhotoResizer3);return}this.logStep(o.CLIENT_PROCESS_BEGIN);var v=l();i(this.$MPhotoResizer3,function(w){__p&&__p();m(function(){__p&&__p();var x=document.createElement("canvas"),y=new p(this.$MPhotoResizer3);y.onrender=function(){__p&&__p();m(function(){var z=x.toDataURL("image/jpeg",this.$MPhotoResizer2);x=null;z=z.substr(t.length);m(function(){var A=h(z);z=null;var B=new Blob([A.buffer],{type:"image/jpeg"});this.logStep(o.CLIENT_PROCESS_SUCCESS,{timeResizing:l()-v,originalSize:this.$MPhotoResizer3&&this.$MPhotoResizer3.size,resizedSize:B&&B.size});this.$MPhotoResizer4(B)}.bind(this))}.bind(this))}.bind(this);y.render(x,{maxWidth:this.$MPhotoResizer1.x,maxHeight:this.$MPhotoResizer1.y,orientation:w})}.bind(this))}.bind(this))};u.prototype.$MPhotoResizer8=function(){"use strict";var v=document.createElement("canvas");v.width=1;v.height=1;var w=v.toDataURL("image/jpeg");return w.substr(0,t.length)===t};u.prototype.getWaterfallID=function(){"use strict";return this.$MPhotoResizer5};u.prototype.getWaterfallAppName=function(){"use strict";return this.$MPhotoResizer6};u.prototype.getWaterfallSource=function(){"use strict";return this.$MPhotoResizer7};f.exports=u}),null);
__d("XMobilePhotosSaveUnpublishedController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/_mupload_/photo/x/saveunpublished/",{allow_spherical_photo:{type:"Bool",defaultValue:false},thumbnail_width:{type:"Int"},thumbnail_height:{type:"Int"},waterfall_app_name:{type:"String"},waterfall_id:{type:"String"},waterfall_source:{type:"String"},filter_type:{type:"Int"},use_autoenhance:{type:"Exists",defaultValue:false},upload_id:{type:"String"},target_id:{type:"Int"},csid:{type:"String"},js_request_module_name:{type:"String"}})}),null);
__d("supportsXHR2",["memoize"],(function a(b,c,d,e,f,g,h){function i(){if(!window.FormData||!window.XMLHttpRequest)return false;var j=new XMLHttpRequest();return"upload"in j&&"withCredentials"in j}f.exports=h(i)}),null);
__d("MPhotoUploadRequest",["ActorURI","CurrentUser","DOM","MRequest","PhotosUploadWaterfallXMixin","PUWSteps","XMobilePhotosSaveUnpublishedController","invariant","mixin","performanceNow","supportsXHR2","MPhotoResizer"],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){__p&&__p();var t,u;t=babelHelpers.inherits(v,p(l));u=t&&t.prototype;function v(){"use strict";u.constructor.call(this);this.$MPhotoUploadRequest1=0}v.prototype.setClonedFileInput=function(y){"use strict";this.$MPhotoUploadRequest2=y;return this};v.prototype.setAttachedFile=function(y){"use strict";this.$MPhotoUploadRequest3=y;return this};v.prototype.setDTSG=function(y){"use strict";this.$MPhotoUploadRequest4=y;return this};v.prototype.setUploadDomain=function(y){"use strict";this.$MPhotoUploadRequest5=y;return this};v.prototype.setWaterfall=function(y,z,A){"use strict";this.$MPhotoUploadRequest6=y;this.$MPhotoUploadRequest7=z;this.$MPhotoUploadRequest8=A;return this};v.prototype.setHandler=function(y){"use strict";this.$MPhotoUploadRequest9=y;return this};v.prototype.setProgressHandler=function(y){"use strict";this.$MPhotoUploadRequest10=y;return this};v.prototype.setErrorHandler=function(y){"use strict";this.$MPhotoUploadRequest11=y;return this};v.prototype.setThumbnailDimensions=function(y){"use strict";this.$MPhotoUploadRequest12=y;return this};v.prototype.setShouldResize=function(y){"use strict";this.$MPhotoUploadRequest13=y;return this};v.prototype.setTargetID=function(y){"use strict";this.$MPhotoUploadRequest14=y;return this};v.prototype.setActorID=function(y){"use strict";this.$MPhotoUploadRequest15=y;return this};v.prototype.setAllowSphericalPhoto=function(y){"use strict";this.$MPhotoUploadRequest16=y;return this};v.prototype.setJpegResizer=function(y){"use strict";return this};v.prototype.send=function(){"use strict";__p&&__p();this.$MPhotoUploadRequest2||o(0);this.$MPhotoUploadRequest5||o(0);this.$MPhotoUploadRequest4||o(0);this.$MPhotoUploadRequest6||o(0);this.$MPhotoUploadRequest7||o(0);this.$MPhotoUploadRequest8||o(0);this.$MPhotoUploadRequest9||o(0);this.$MPhotoUploadRequest12||o(0);!this.$MPhotoUploadRequest17&&!this.$MPhotoUploadRequest18||o(0);if(!r())this.$MPhotoUploadRequest19();else this.$MPhotoUploadRequest20();return this};v.prototype.$MPhotoUploadRequest21=function(y,z){"use strict";this.logStep(y,babelHelpers["extends"]({retriesNeeded:this.$MPhotoUploadRequest1},z||{}))};v.prototype.abort=function(y){"use strict";if(!this.$MPhotoUploadRequest2)return;this.$MPhotoUploadRequest21(m.CLIENT_TRANSFER_CANCEL,{elapsed_time:q()-this.transferStartTime,bytes:this.fileSize,progress:y});if(r())this.$MPhotoUploadRequest22();else this.$MPhotoUploadRequest23()};v.prototype.retry=function(){"use strict";this.$MPhotoUploadRequest1++;this.abort();this.send()};v.prototype.$MPhotoUploadRequest24=function(){"use strict";var y=this.$MPhotoUploadRequest2.files;return y&&y.item&&y.item(0)&&y.item(0).size};v.prototype.$MPhotoUploadRequest25=function(){"use strict";var y=n.getURIBuilder().setBool("allow_spherical_photo",this.$MPhotoUploadRequest16).setInt("thumbnail_width",this.$MPhotoUploadRequest12.x).setInt("thumbnail_height",this.$MPhotoUploadRequest12.y).setString("waterfall_id",this.$MPhotoUploadRequest6).setString("waterfall_app_name",this.$MPhotoUploadRequest7).setString("waterfall_source",this.$MPhotoUploadRequest8).setInt("target_id",this.$MPhotoUploadRequest14).getURI().setProtocol(this.$MPhotoUploadRequest5.getProtocol()).setDomain(this.$MPhotoUploadRequest5.getDomain());return h.create(y,this.$MPhotoUploadRequest15)};v.prototype.$MPhotoUploadRequest20=function(){"use strict";var y=this.$MPhotoUploadRequest3,z=this.$MPhotoUploadRequest13||"no_resize";if(y&&z=="canvas_resize")new s().setFile(y).setWaterfall(this.$MPhotoUploadRequest6,this.$MPhotoUploadRequest7,this.$MPhotoUploadRequest8).setHandler(function(A){this.$MPhotoUploadRequest26(A)}.bind(this)).resize();else this.$MPhotoUploadRequest26(y)};v.prototype.$MPhotoUploadRequest26=function(y){"use strict";__p&&__p();var z=new FormData();z.append(this.$MPhotoUploadRequest2.name,y);this.fileSize=y.size;this.transferStartTime=q();this.$MPhotoUploadRequest21(m.CLIENT_TRANSFER_BEGIN,{bytes:this.fileSize});var A=this.$MPhotoUploadRequest17=new k(this.$MPhotoUploadRequest25()).setCORS(true).setData({fb_dtsg:this.$MPhotoUploadRequest4}).setRawData(z);A.listen("open",function(B){var C=B.getTransport();C.withCredentials=true});A.listen("done",function(B){this.$MPhotoUploadRequest21(m.CLIENT_TRANSFER_SUCCESS,{elapsed_time:q()-this.transferStartTime,bytes:this.fileSize,fbid:B.fbid});this.$MPhotoUploadRequest9(B)}.bind(this));A.listen("error",function(B){this.$MPhotoUploadRequest21(m.CLIENT_TRANSFER_FAIL,{error_type:"mrequest_fail",elapsed_time:q()-this.transferStartTime,bytes:this.fileSize});this.$MPhotoUploadRequest11&&this.$MPhotoUploadRequest11(B)}.bind(this));A.listen("uploadprogress",function(B){this.$MPhotoUploadRequest10&&this.$MPhotoUploadRequest10(B)}.bind(this));A.send()};v.prototype.$MPhotoUploadRequest22=function(){"use strict";this.$MPhotoUploadRequest17&&this.$MPhotoUploadRequest17.abort();this.$MPhotoUploadRequest17=null};v.prototype.$MPhotoUploadRequest27=function(y,z){"use strict";return j.create("input",{type:"hidden",name:y,value:z})};v.prototype.$MPhotoUploadRequest19=function(){"use strict";__p&&__p();var y="MPhotoUpload"+w++,z=this.$MPhotoUploadRequest18=j.create("iframe",{name:y,id:y});z.style.display="none";var A=this.$MPhotoUploadRequest28=j.create("form",{target:y,action:this.$MPhotoUploadRequest25().toString(),method:"POST",enctype:"multipart/form-data"});A.style.display="none";var B={fb_dtsg:this.$MPhotoUploadRequest4,__a:1,__user:i.getID(),upload_id:y};for(var C in B)j.appendContent(A,this.$MPhotoUploadRequest27(C,B[C]));j.appendContent(document.body,z);j.appendContent(document.body,A);j.appendContent(A,this.$MPhotoUploadRequest2);this.fileSize=this.$MPhotoUploadRequest24();x[y]=function(E){if(!E){this.$MPhotoUploadRequest29("no_payload");return}delete x[y];this.$MPhotoUploadRequest23();this.$MPhotoUploadRequest21(m.CLIENT_TRANSFER_SUCCESS,{elapsed_time:q()-this.transferStartTime,bytes:this.fileSize,fbid:E.fbid});this.$MPhotoUploadRequest9(E)}.bind(this);z.onerror=this.$MPhotoUploadRequest29.bind("iframe_onerror");this.transferStartTime=q();this.$MPhotoUploadRequest21(m.CLIENT_TRANSFER_BEGIN,{bytes:this.fileSize});var D=window.location.hostname.match(/\.(facebook\.sg|facebookcorewwwi\.onion)$/);document.domain=D?D[1]:"facebook.com";A.submit()};v.prototype.$MPhotoUploadRequest29=function(y){"use strict";this.$MPhotoUploadRequest21(m.CLIENT_TRANSFER_FAIL,{error_type:y,elapsed_time:q()-this.transferStartTime,bytes:this.fileSize});this.$MPhotoUploadRequest11&&this.$MPhotoUploadRequest11();this.$MPhotoUploadRequest23()};v.prototype.$MPhotoUploadRequest23=function(){"use strict";this.$MPhotoUploadRequest18&&j.remove(this.$MPhotoUploadRequest18);this.$MPhotoUploadRequest18=null;this.$MPhotoUploadRequest28&&j.remove(this.$MPhotoUploadRequest28);this.$MPhotoUploadRequest28=null};v.prototype.getWaterfallID=function(){"use strict";return this.$MPhotoUploadRequest6};v.prototype.getWaterfallAppName=function(){"use strict";return this.$MPhotoUploadRequest7};v.prototype.getWaterfallSource=function(){"use strict";return this.$MPhotoUploadRequest8};v.handleResponse=function(y,z){"use strict";x[y](z)};var w=0,x={};f.exports=v}),null);
__d("MMultiPhotoUploader.react",["cx","fbt","forEachObject","intlNumUtils","Bootloader","MSphericalPhotoConfig","MPhotoUploadRequest","PhotosUploadWaterfallXMixin","PUWSteps","React","ReactDOM","Stratcom","Vector","MMultiPhotoUploaderAttachment.react","MMultiPhotoUploaderAttachmentState","MPhotoUploadDisable","MPhotoUploadFileInput","MMultiPhotoUploaderPlusAttachment.react","MMultiPhotoUploaderHiddenInputs.react","URI"],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A){__p&&__p();var B=q.PropTypes,C=0,D=80,E=56,F,G=q.createClass({displayName:"MMultiPhotoUploader",_pendingUploadRequests:{},propTypes:{dtsg:B.string.isRequired,fileInput:B.instanceOf(x).isRequired,formHiddenInputs:B.instanceOf(HTMLElement).isRequired,uploadDomain:B.instanceOf(A).isRequired,waterfallID:B.string.isRequired,waterfallAppName:B.string.isRequired,waterfallSource:B.string.isRequired,actorID:B.string,targetID:B.string,maxPhotosAllowed:B.number,initCollapsed:B.bool,logFlowBeginOnClick:B.bool,shouldScroll:B.bool,shouldShowLargeThumbnails:B.bool,shouldShowWhiteDesign:B.bool,shouldShowAddPhotoLabel:B.bool,showDropShadow:B.bool,disableIOS8SafariAlert:B.bool,onUploadSuccess:B.func,onRemove:B.func,onThumbnailClicked:B.func,onUploadStarted:B.func,initialPhotos:B.array},mixins:[o],setCollapsed:function H(I){this.setState({collapsed:I})},isCollapsed:function H(){return this.state.collapsed},isSinglePhoto:function H(){return+this.props.maxPhotosAllowed===1},getAttachmentCount:function H(){return this.attachments.length},hasAttachments:function H(){return this.attachments.length>0},clearAttachments:function H(){this.setAttachments(this.attachments.filter(function(I){if(I.state===v.SENDING)I.request.abort();return false}))},getInitialState:function H(){__p&&__p();var I=this.props.initialPhotos;if(I!==null){for(var J=0;J<I.length;J++){I[J].id=C++;I[J].state=v.UPLOADED}var K={};K[v.UPLOADED]=I.length;s.invoke("MMultiPhotoUploader:attachments:change",null,K)}this.attachments=I?I:[];return{attachments:this.attachments,collapsed:this.props.initCollapsed}},numAttachmentsWithState:function H(I){return this.attachments.filter(function(J){return J.state===I}).length},_numPollingAttachments:function H(){return this.attachments.filter(function(I){return I.isPollingTagSuggestions}).length},isMaxAttachmentReached:function H(){return this.attachments.length>=this.props.maxPhotosAllowed},setAttachments:function H(I){s.invoke("multi-photos-attachment-change",null,{attachments:I,multiPhotoUploader:this});this.setAttachmentsSilent(I)},setAttachmentsSilent:function H(I){__p&&__p();this.attachments=I;this.setState({attachments:I});var J=this.props.fileInput.getDOMElement();J.disabled=this.isMaxAttachmentReached();s.invoke("multi-photos-change",null,{input_id:J.id});var K={input_id:J.id};for(var L in v){if(!Object.prototype.hasOwnProperty.call(v,L)||typeof v[L]!=="string")continue;var M=v[L];K[M]=this.numAttachmentsWithState(M)}K.polling=this._numPollingAttachments();s.invoke("MMultiPhotoUploader:attachments:change",null,K)},addAttachment:function H(I){s.invoke("MMultiPhotoUploader:attachments:add",null,{photo_count:I.length||1});this.setAttachments(this.attachments.concat([I]))},removeAttachment:function H(I){__p&&__p();s.invoke("MMultiPhotoUploader:attachments:remove",null,{photo_count:1});this.setAttachments(this.attachments.filter(function(J){__p&&__p();if(J.id===I){if(J.state===v.SENDING){var K=0;if(J.totalSize)K=Math.floor(100*(J.loaded/J.totalSize));J.request.abort(K)}else this.logStep(p.CLIENT_UPLOAD_REMOVE,{fbid:J.fbid});if(J.fbid)this.props.onRemove&&this.props.onRemove(J.fbid);return false}return true}.bind(this)))},updateAttachment:function H(I){this.setAttachments(this.attachments.map(function(J){if(J.id===I.id)return I;return J}))},getAttachment:function H(I){return this.attachments.filter(function(J){return J.id===I})[0]},setAttachmentProps:function H(I,J){var K=this.getAttachment(I),L={};for(var M in K)L[M]=K[M];for(M in J)L[M]=J[M];this.updateAttachment(L)},retryAttachment:function H(I){var J=this.getAttachment(I);this.logStep(p.CLIENT_ATTEMPT_RETRY,{fbid:J.fbid});J.request.retry();this.updateAttachment({id:I,state:"sending",request:J.request})},setAttachmentTagCounts:function H(I){this.setAttachmentsSilent(this.attachments.map(function(J){J.tagCount=I[J.id];return J}))},componentDidMount:function H(){this.props.fileInput.setChangeHandler(this.onFileInputChange);this.props.fileInput.setClickHandler(this.onFileInputClick);if(!this.hasAttachments()&&!this.props.logFlowBeginOnClick)this.logStep(p.CLIENT_FLOW_BEGIN);this.renderHiddenInputs();this.resizeAndScroll()},componentWillUnmount:function H(){r.unmountComponentAtNode(this.props.formHiddenInputs);this.props.fileInput.setChangeHandler(null);this.props.fileInput.setClickHandler(null);j(this._pendingUploadRequests,function(I){return I.abort()});delete this._pendingUploadRequests},onFileInputChange:function H(){var I=this.props.fileInput.getDOMElement();s.invoke("MMultiPhotoUploader:input:change",null,{input:I});this.uploadPhotos(I.files)},onFileInputClick:function H(event){if(this.props.disableIOS8SafariAlert===true)w.alertIOS8FileUploadDisabled(event);if(!this.hasAttachments()&&this.props.logFlowBeginOnClick)this.logStep(p.CLIENT_FLOW_BEGIN);this.logStep(p.CLIENT_SELECT_BEGIN);s.invoke("MMultiPhotoUploader:input:click",null,{input:this.props.fileInput.getDOMElement()})},uploadPhotos:function H(I){__p&&__p();var J,K=this;if(I.length===0){this.logStep(p.CLIENT_SELECT_FAIL);return}var L=this.props.fileInput.cloneDOMNode(),M=function M(N){__p&&__p();var O=I[N];if(O.name===""&&O.fileName===""&&O.size===0&&O.fileSize===0){K.logStep(p.CLIENT_SELECT_FAIL);return"continue"}K.logStep(p.CLIENT_SELECT_SUCCESS);var P=C++,Q=K.props.shouldShowLargeThumbnails?D:E,R=K.props,S=R.targetID,T=R.actorID,U=new n().setClonedFileInput(L).setAttachedFile(O).setUploadDomain(K.props.uploadDomain).setThumbnailDimensions(new t(Q,Q)).setDTSG(K.props.dtsg).setWaterfall(K.props.waterfallID,K.props.waterfallAppName,K.props.waterfallSource).setHandler(K.handleUploadSuccess.bind(K,P)).setErrorHandler(K.handleUploadError.bind(K,P)).setProgressHandler(K.handleUploadProgress.bind(K,P)).setTargetID(S&&k.parseNumber(S)).setActorID(T&&k.parseNumber(T)).setAllowSphericalPhoto(true).send();K._pendingUploadRequests[P]=U;K.props.onUploadStarted&&K.props.onUploadStarted();if(K.isSinglePhoto())K.clearAttachments();K.addAttachment({id:P,state:"sending",request:U});K.setCollapsed(false);if(m.is_mtouch_basic_uploader_on)l.loadModules(["SphericalImage"],function(V){V.createFromBlob(O).then(function(W){return this.handleSphericalPhotoCheck(P,W)}.bind(this))["catch"](function(W){}).done()}.bind(K),"MMultiPhotoUploader.react")};for(var N=0;N<I.length;N++){var J=M(N);if(J==="continue")continue}},handleSphericalPhotoCheck:function H(I,J){var K=this.getAttachment(I);this.updateAttachment(babelHelpers["extends"]({},K,{isSpherical:J&&J.isSpherical()}))},handleUploadError:function H(I){delete this._pendingUploadRequests[I];var J=this.getAttachment(I);this.updateAttachment({id:I,state:"error",request:J.request,isSpherical:J.isSpherical})},handleUploadProgress:function H(I,J){var K=this.getAttachment(I);this.updateAttachment({id:I,state:K.state,request:K.request,loaded:J.loaded,totalSize:J.totalSize,isSpherical:K.isSpherical})},handleUploadSuccess:function H(I,J){delete this._pendingUploadRequests[I];if(!J.fbid){this.handleUploadError(I);return}var K=this.getAttachment(I);this.updateAttachment({id:I,state:"uploaded",fbid:J.fbid,imageURI:J.thumbnail_uri,thumbnail_width:J.thumbnail_width,thumbnail_height:J.thumbnail_height,loaded:K.loaded,totalSize:K.totalSize,previewURI:J.preview_uri,isSpherical:K.isSpherical});this.props.onUploadSuccess&&this.props.onUploadSuccess(J.fbid,I)},onPlusClick:function H(event){this.props.fileInput.click(event)},onRemoveClick:function H(I){var J=this.getAttachment(I),K=false;if(J.state===v.SENDING||J.state===v.ERROR)K=confirm(i._("This photo didn't upload. Do you want to try again?"));if(K)this.retryAttachment(I);else this.removeAttachment(I)},componentWillUpdate:function H(){if(this.props.shouldScroll&&this.refs&&this.refs.scroller)this.refs.scroller.checkShouldScrollToEnd()},componentDidUpdate:function H(){this.renderHiddenInputs();this.resizeAndScroll()},renderHiddenInputs:function H(){var I=this.state.attachments.filter(function(J){return J.state===v.UPLOADED}).map(function(J){return J.fbid});r.render(q.createElement(z,babelHelpers["extends"]({},this.props,{fbids:I})),this.props.formHiddenInputs)},resizeAndScroll:function H(){if(this.props.shouldScroll&&this.refs&&this.refs.scroller){this.refs.scroller.resizeScroller();this.refs.scroller.scrollHorizontallyToEnd()}},getPlusAttachment:function H(){if(this.isSinglePhoto()&&this.state.collapsed)return null;if(this.isMaxAttachmentReached())return null;return q.createElement(y,{onClick:this.onPlusClick,largeThumbnails:this.props.shouldShowLargeThumbnails,shouldShowWhiteDesign:this.props.shouldShowWhiteDesign,shouldShowAddPhotoLabel:this.props.shouldShowAddPhotoLabel})},adjustScroller:function H(){if(this.props.shouldScroll&&this.refs&&this.refs.scroller){this.refs.scroller.checkShouldScrollToEnd();this.refs.scroller.resizeScroller();this.refs.scroller.scrollHorizontallyToEnd()}},render:function H(){__p&&__p();if(this.state.collapsed)return q.createElement("div",null);var I=this.state.attachments.map(function(K){var L=this.props.shouldShowLargeThumbnails?D:E;return q.createElement(u,babelHelpers["extends"]({},K,{key:K.id,shouldShowLargeThumbnails:this.props.shouldShowLargeThumbnails,previewSize:L,shouldShowWhiteDesign:this.props.shouldShowWhiteDesign,onRemoveClick:function(){this.onRemoveClick(K.id)}.bind(this),onPreviewLoaded:function(){this.adjustScroller()}.bind(this),loaded:K.loaded,totalSize:K.totalSize,onThumbnailClicked:function(){this.props.onThumbnailClicked&&this.props.onThumbnailClicked(K)}.bind(this)}))}.bind(this)),J=this.props.shouldScroll&&this.state.attachments.length>1;if(J)if(!F)l.loadModules(["MMultiPhotoUploaderSimpleScroller"],function(f){F=f;this.forceUpdate()}.bind(this),"MMultiPhotoUploader.react");else return q.createElement(F,{options:{scrollingY:false},className:(!this.props.shouldShowLargeThumbnails?"_1upb":"")+" _xy"+(this.props.showDropShadow?" _bgx":""),thumbnailSize:D,ref:"scroller"},I,this.getPlusAttachment());return q.createElement("div",{className:"_5cqb"+(J?" _2nym":"")},I,this.getPlusAttachment())},getWaterfallID:function H(){return this.props.waterfallID},getWaterfallAppName:function H(){return this.props.waterfallAppName},getWaterfallSource:function H(){return this.props.waterfallSource}});f.exports=G}),null);
__d("MMultiPhotoUploaderInitReact",["$","MMultiPhotoUploaderAttachmentState","DOM","ReactComponentRenderer","Run","Stratcom","StratcomManager","SubscriptionsHandler","MMultiPhotoUploader.react","MPhotoUploadFileInput","URI","PUWSteps"],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){__p&&__p();var t="m-raw-file-input";function u(v,w){"use strict";__p&&__p();var x=v.previewGridElem||h(v.previewGridId),y=v.targetFormElem||h(v.targetFormId),z=v.inputId,A=v.inputContainerElem,B=null;if(A){var C=j.scry(A,"input",t)[0];if(C&&C.id===z)B=C}B=B||h(z);var D=document.createElement("div");j.insertBefore(x,D);var E=document.createElement("div");j.appendContent(y,E);var F=new q(B);this.$MMultiPhotoUploaderInitReact1=new k(p,D);this.$MMultiPhotoUploaderInitReact1.setProps({fileInput:F,formHiddenInputs:E,uploadDomain:new r(v.uploadDomain),dtsg:v.dtsg,shouldResize:v.shouldResize,maxPhotosAllowed:v.maxPhotosAllowed,waterfallID:v.waterfallID,waterfallAppName:v.waterfallAppName,waterfallSource:v.waterfallSource,initCollapsed:v.initCollapsed,logFlowBeginOnClick:v.logFlowBeginOnClick,targetID:v.targetID,actorID:v.actorID,shouldScroll:v.horizontalScrolling,shouldShowLargeThumbnails:v.largeThumbnails,shouldShowWhiteDesign:v.useWhiteDesign,shouldShowAddPhotoLabel:v.showPhotoLabel,showDropShadow:v.composerDropShadow,disableIOS8SafariAlert:v.disableIOS8SafariAlert,initialPhotos:w});n.enableDispatch(window,"reset");var G=new o();G.addSubscriptions(m.listen("reset",["id:"+v.targetFormId],function(){this.resetState()}.bind(this)),m.listen("MActorSelector-actorChange",null,function(event){if(event.getData().targetID===v.targetID){this.resetState();this.$MMultiPhotoUploaderInitReact1.setProps({actorID:event.getData().actorID,maxPhotosAllowed:event.getData().maxPhotosAllowed})}}.bind(this)),m.listen("MStructuredComposer-canceled",null,function(){if(!this.$MMultiPhotoUploaderInitReact1.component.isCollapsed())this.$MMultiPhotoUploaderInitReact1.component.logStep(s.CLIENT_FLOW_CANCEL,{volume:this.$MMultiPhotoUploaderInitReact1.component.getAttachmentCount()})}.bind(this)));l.onLeave(function(){this.$MMultiPhotoUploaderInitReact1.unmount();F.destroy();G.release()}.bind(this))}u.prototype.logClientPost=function(v){"use strict";this.$MMultiPhotoUploaderInitReact1.component.logStep(s.CLIENT_FLOW_POST,{volume:this.$MMultiPhotoUploaderInitReact1.component.getAttachmentCount()},v)};u.prototype.alterPreviewGrid=function(v){"use strict";return this.$MMultiPhotoUploaderInitReact1.component.setCollapsed(!v)};u.prototype.getUploader=function(){"use strict";return this.$MMultiPhotoUploaderInitReact1};u.prototype.resetState=function(){"use strict";this.$MMultiPhotoUploaderInitReact1.component.clearAttachments();return this.alterPreviewGrid(false)};u.prototype.hasPhotos=function(){"use strict";return this.$MMultiPhotoUploaderInitReact1.component.numAttachmentsWithState(i.UPLOADED)>0};u.prototype.getPhotosCount=function(){"use strict";return this.$MMultiPhotoUploaderInitReact1.component.numAttachmentsWithState(i.UPLOADED)};u.prototype.uploadPhotos=function(v){"use strict";this.$MMultiPhotoUploaderInitReact1.component.uploadPhotos(v)};f.exports=u}),null);
__d("AbstractCommentLiveTypingController",["destroyOnUnload","ex"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j={START:"start",STOP:"stop"},k=10*1e3;function l(m,n,o){this.$AbstractCommentLiveTypingController5=m;this.$AbstractCommentLiveTypingController6=n;this.$AbstractCommentLiveTypingController7=o;this.$AbstractCommentLiveTypingController1=null;this.$AbstractCommentLiveTypingController2=false;this.$AbstractCommentLiveTypingController3=0;this.$AbstractCommentLiveTypingController4=null;h(this.destroy.bind(this))}l.prototype.destroy=function(){this.$AbstractCommentLiveTypingController1&&this.$AbstractCommentLiveTypingController1.destroy();this.$AbstractCommentLiveTypingController1=null;this.$AbstractCommentLiveTypingController2=false;this.$AbstractCommentLiveTypingController3=0;this.$AbstractCommentLiveTypingController4=null};l.prototype.bootloadPublisherModule=function(m){throw new Error(i("bootloadPublisherModule not implemented, should be overridden by subclass"))};l.prototype.$AbstractCommentLiveTypingController8=function(m){var n=new m(this.$AbstractCommentLiveTypingController5,this.$AbstractCommentLiveTypingController6,this.$AbstractCommentLiveTypingController7),o=Date.now(),p=this.$AbstractCommentLiveTypingController3;if(p&&p+k>=o){var q=this.$AbstractCommentLiveTypingController4;if(q===j.START)n.handleStartEvent();else if(q===j.STOP)n.handleStopEvent()}this.$AbstractCommentLiveTypingController1=n};l.prototype.$AbstractCommentLiveTypingController9=function(){if(this.$AbstractCommentLiveTypingController2||!this.$AbstractCommentLiveTypingController5)return;this.$AbstractCommentLiveTypingController2=true;this.bootloadPublisherModule(this.$AbstractCommentLiveTypingController8.bind(this))};l.prototype.attemptPublishStartEvent=function(){this.$AbstractCommentLiveTypingController4=j.START;this.$AbstractCommentLiveTypingController3=Date.now();if(this.$AbstractCommentLiveTypingController1)this.$AbstractCommentLiveTypingController1.handleStartEvent();else if(!this.$AbstractCommentLiveTypingController2)this.$AbstractCommentLiveTypingController9()};l.prototype.attemptPublishStopEvent=function(){this.$AbstractCommentLiveTypingController4=j.STOP;this.$AbstractCommentLiveTypingController3=Date.now();if(this.$AbstractCommentLiveTypingController1)this.$AbstractCommentLiveTypingController1.handleStopEvent();else if(!this.$AbstractCommentLiveTypingController2)this.$AbstractCommentLiveTypingController9()};f.exports=l}),null);
__d("MComposerLiveTypingController",["AbstractCommentLiveTypingController","Bootloader"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k;j=babelHelpers.inherits(l,h);k=j&&j.prototype;function l(m,n,o){k.constructor.call(this,m,n,o)}l.prototype.bootloadPublisherModule=function(m){i.loadModules(["MComposerLiveTypingPublisher"],m,"MComposerLiveTypingController")};l.prototype.attemptPublishStartEvent=function(){k.attemptPublishStartEvent.call(this)};l.prototype.attemptPublishStopEvent=function(){k.attemptPublishStopEvent.call(this)};f.exports=l}),null);
__d("MCommentComposer",["MMultiPhotoUploaderAttachmentState","ChannelClientID","ClientIDs","CSS","DOM","MLegacyDataStore","MComposerConfig","MComposerLiveTypingController","MParent","MUFIInlineRepliesFunnelLogConfig","MViewport","Stratcom","StratcomManager","SubscriptionsHandler","TouchEventType","cancelAnimationFrame","cx","debounceCore","ge","getActiveElement","requestAnimationFrame","setTimeoutAcrossTransitions"],(function a(b,c,d,aa,e,ba,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,ca,v,w,x,y,z){__p&&__p();var A=o.MUFIInlineReplyComposerFunnelLogger,B="m-ufi",C="feed-ufi",D="scroll-area",E="m-composer",F="m-photo-composer",G="m-inline-reply-composer",H="m-noninline-composer",I="textarea",J="privacy-selector",K="composer-submit",L="inline-reply",M="comment",N=100,O=l.MComposerLoggingController,P=false;function Q(){return!!l.PUBLISH_LIVE}function R(T){if(T.tagName==="FORM")return T;else return j.find(T,"form")}function S(T,U){"use strict";__p&&__p();this.$MCommentComposer1=T;this.$MCommentComposer2=U||{};this.$MCommentComposer3=null;this.$MCommentComposer4=null;this.$MCommentComposer5=!!this.$MCommentComposer2.toggle_submit;this.$MCommentComposer10=this.$MCommentComposer16();this.$MCommentComposer12=f.getDefaultState();this.$MCommentComposer13=!!n.bySigil(T,C);this.$MCommentComposer14=!!(this.$MCommentComposer2.is_inline_reply&&n.bySigil(this.$MCommentComposer1,G));this.$MCommentComposer15=null;if(this.$MCommentComposer2.log_comment&&O)this.$MCommentComposer15=new O();this.$MCommentComposer8=null;this.$MCommentComposer9=false;this.$MCommentComposer7=new s();this.$MCommentComposer17();if(this.$MCommentComposer2.should_focus&&this.$MCommentComposer2.composer_id)z(function(){w(this.$MCommentComposer2.composer_id).focus()}.bind(this),0);q.invoke("marauder-fb-composer-init",null,{parent_fbid:"target_id"in this.$MCommentComposer2?this.$MCommentComposer2.target_id:-1})}S.prototype.$MCommentComposer18=function(){"use strict";this.$MCommentComposer8&&this.$MCommentComposer8.release();this.$MCommentComposer8=null};S.prototype.destroy=function(){"use strict";this.$MCommentComposer7.release();this.$MCommentComposer18();this.$MCommentComposer15&&this.$MCommentComposer15.destroy();this.$MCommentComposer15=null;this.$MCommentComposer3&&this.$MCommentComposer3.destroy();this.$MCommentComposer3=null};S.prototype.$MCommentComposer19=function(T){"use strict";__p&&__p();if(!this.$MCommentComposer5||!T)return;if(this.$MCommentComposer6)u(this.$MCommentComposer6);this.$MCommentComposer6=y(function(){this.$MCommentComposer6=null;var U=j.find(T,"*",K),V=this.$MCommentComposer12[f.SENDING]===0&&(!/^\s*$/.test(j.find(T,"*",I).value)||this.$MCommentComposer12[f.UPLOADED]>0);if(!V)U.setAttribute("disabled",true);else U.removeAttribute("disabled");i.conditionClass(U,"_56bt",!V);i.conditionClass(U,"_56bv",V);i.conditionClass(U,"_653w",V)}.bind(this))};S.prototype.$MCommentComposer20=function(T){"use strict";if(T===this.$MCommentComposer2.composer_id){this.$MCommentComposer11=true;setTimeout(function(){this.$MCommentComposer11=false}.bind(this),N)}};S.prototype.$MCommentComposer21=function(T){"use strict";if(!T||!k.get(T).auto_collapse||!k.get(R(T)).expand_composer)return;var U=j.find(T,"*",I),V=x()===U||!/^\s*$/.test(U.value)||this.$MCommentComposer12[f.UPLOADED]>0;if(!V&&this.$MCommentComposer11)return;i.conditionClass(T,"composerClosed",!V)};S.prototype.$MCommentComposer17=function(){"use strict";__p&&__p();var T=Q()?this.$MCommentComposer22.bind(this):this.$MCommentComposer10.bind(this);this.$MCommentComposer7.addSubscriptions(q.listen("MCommentComposer:replyButtonClick",null,function(U){return this.$MCommentComposer20(U.getData().composerID)}.bind(this)),q.listen("focus",[E,I],this.$MCommentComposer23.bind(this)),q.listen("focus",[E,J],this.$MCommentComposer24.bind(this)),q.listen("keyup",[E,I],T),q.listen("input",[E,I],T),q.listen("paste",[E,I],T),q.listen("MMultiPhotoUploader:attachments:change",null,this.$MCommentComposer25.bind(this)),q.listen("blur",[E,I],this.$MCommentComposer26.bind(this)),q.listen("reset",[E],this.$MCommentComposer27.bind(this)),q.listen("touchend",[E,K],this.$MCommentComposer28.bind(this)),q.listen("click",K,this.$MCommentComposer29.bind(this)),q.listen("m:page:unload",null,this.destroy.bind(this)),q.listen("m:feed-ufi-flyout:reset",null,this.$MCommentComposer30.bind(this)),this.$MCommentComposer10);if(l.CAN_TOUCH_PHOTO_INPUT_WHILE_EXPANDED)this.$MCommentComposer7.addSubscriptions(q.listen("MMultiPhotoUploader:input:click",null,this.$MCommentComposer31.bind(this)));if(!this.$MCommentComposer14)this.$MCommentComposer7.addSubscriptions(q.listen("click","m-add-comment",this.$MCommentComposer32.bind(this)));if(this.$MCommentComposer13&&n.bySigil(this.$MCommentComposer1,D))this.$MCommentComposer7.addSubscriptions(q.listen("MScrollArea:scrollstart",null,this.$MCommentComposer33.bind(this)));if(!P){P=true;r.enableDispatch(window,"reset")}this.$MCommentComposer7.addSubscriptions(q.listen("submit",E,this.$MCommentComposer34.bind(this)));if(Q())this.$MCommentComposer7.addSubscriptions(q.listen("m:feed-ufi:hide",null,this.$MCommentComposer35.bind(this)));if(this.$MCommentComposer15){this.$MCommentComposer7.addSubscriptions(q.listen("MMultiPhotoUploader:input:change",null,this.$MCommentComposer36.bind(this)),q.listen("m:ufi:iui:comment-added",null,this.$MCommentComposer37.bind(this)));if(!this.$MCommentComposer14)this.$MCommentComposer7.addSubscriptions(q.listen("m:ufi:live-comments:render",null,this.$MCommentComposer38.bind(this)))}if(this.$MCommentComposer2.is_inline_reply&&A)this.$MCommentComposer7.addSubscriptions(q.listen("m:ufi:sticker-comment",null,this.$MCommentComposer39.bind(this)))};S.prototype.$MCommentComposer40=function(T){"use strict";return!!T&&j.contains(this.$MCommentComposer1,T)};S.prototype.$MCommentComposer23=function(event){"use strict";var T=event.getNode(E);if(!this.$MCommentComposer40(T))return;var U=j.find(T,"*",I);this.$MCommentComposer21(T);if(!k.get(T).disable_auto_scroll)p.scrollToNode(U)};S.prototype.$MCommentComposer24=function(event){"use strict";var T=event.getNode(E);if(!this.$MCommentComposer40(T))return;i.removeClass(T,"composerClosed")};S.prototype.$MCommentComposer16=function(){"use strict";return v(function(event){var T=event.getNode(I);if(!this.$MCommentComposer40(T))return;q.invoke("marauder-feedback-input",null,{draft:T.value});this.$MCommentComposer15&&this.$MCommentComposer15.logInitText();this.$MCommentComposer19(event.getNode(E))}.bind(this),250)};S.prototype.$MCommentComposer22=function(event){"use strict";__p&&__p();var T=event.getNode(I);if(!this.$MCommentComposer40(T))return;var U=T.value,V=this.$MCommentComposer4;if(U!==V)if(U&&U.trim().length)this.$MCommentComposer41();else this.$MCommentComposer35();this.$MCommentComposer10(event);this.$MCommentComposer4=U};S.prototype.$MCommentComposer25=function(event){"use strict";__p&&__p();var T=event.getData(),U=w(T.input_id);if(!U)return;var V=n.bySigil(U,F);if(!V)return;var W=j.find(V,"*",E);if(!this.$MCommentComposer40(W))return;this.$MCommentComposer12=T;this.$MCommentComposer19(W);this.$MCommentComposer21(W)};S.prototype.$MCommentComposer26=function(event){"use strict";var T=event.getNode(E);if(!this.$MCommentComposer40(T))return;if(!this.$MCommentComposer9)this.$MCommentComposer21(T);this.$MCommentComposer9=false};S.prototype.$MCommentComposer27=function(event){"use strict";var T=event.getNode(E);if(!this.$MCommentComposer40(T))return;this.$MCommentComposer19(T);this.$MCommentComposer21(T);this.$MCommentComposer35()};S.prototype.$MCommentComposer42=function(){"use strict";if(this.$MCommentComposer2.is_inline_reply&&A)A.logReplySubmitted(this.$MCommentComposer2.target_id)};S.prototype.$MCommentComposer34=function(event){"use strict";__p&&__p();var T=event.getTarget();if(!this.$MCommentComposer40(T))return;var U=j.scry(T,"input","mcomposer-client-id");if(U.length)U[0].setAttribute("value",h.getNewClientID());else{U=j.create("input",{name:"client_id",sigil:"mcomposer-client-id",type:"hidden",value:h.getNewClientID()});T.appendChild(U)}var V=j.scry(T,"input","mcomposer-session-id");if(!V.length){V=j.create("input",{name:"session_id",sigil:"mcomposer-session-id",type:"hidden",value:g.getID()});T.appendChild(V)}if(Q())this.$MCommentComposer35();this.$MCommentComposer42()};S.prototype.$MCommentComposer39=function(event){"use strict";var T=event.getData().textInput;if(!this.$MCommentComposer40(T))return;this.$MCommentComposer42()};S.prototype.$MCommentComposer28=function(event){"use strict";__p&&__p();var T=event.getNode(K),U=k.get(T);if(!U.onclickIsSet){var V=event.getNode(E);if(!this.$MCommentComposer40(V))return;var W=j.find(V,"*",I);T.onclick=function(){W.blur()};U.onclickIsSet=true}};S.prototype.$MCommentComposer33=function(event){"use strict";var T=event.getData().element;if(!T||!j.contains(T,this.$MCommentComposer1))return;var U=j.find(this.$MCommentComposer1,"*",E),V=j.find(U,"*",I),W=j.scry(U,"*","m-mentions-root")[0],X=W&&k.get(W),Y=X||{},Z=Y.mentionsInstance,$=Z&&Z.getIgnoreFocusChange();Z&&Z.setIgnoreFocusChange(true);V.blur();Z&&Z.setIgnoreFocusChange($)};S.prototype.$MCommentComposer29=function(event){"use strict";var T=event.getNode(E);if(!this.$MCommentComposer40(T))return;var U=j.find(T,"*",I);this.$MCommentComposer15&&this.$MCommentComposer15.logSubmit(U.value.length,this.$MCommentComposer12[f.UPLOADED],U.form);q.invoke("marauder-feedback-posted",null,{});this.$MCommentComposer35()};S.prototype.$MCommentComposer32=function(event){"use strict";var T=event.getNode(B);if(!T||!j.contains(T,this.$MCommentComposer1))return;var U=j.find(this.$MCommentComposer1,"*",E),V=j.find(U,"*",I);V.focus()};S.prototype.$MCommentComposer30=function(event){"use strict";var T=event.getData(),U=T.target_id;if(this.$MCommentComposer13&&U!==this.$MCommentComposer2.target_id)this.destroy()};S.prototype.$MCommentComposer43=function(T){"use strict";if(!T)return null;var U=n.bySigil(T,F),V=U&&j.scry(U,"*",E)[0];return V&&this.$MCommentComposer40(V)?V:null};S.prototype.$MCommentComposer31=function(event){"use strict";__p&&__p();var T=x();if(q.hasSigil(T,"textarea")&&this.$MCommentComposer40(T)&&n.bySigil(T,F)){this.$MCommentComposer9=true;T.blur();this.$MCommentComposer9=false;this.$MCommentComposer18();var U=function(){this.$MCommentComposer18();T.blur();var W=j.scry(this.$MCommentComposer1,"*",E)[0];W&&this.$MCommentComposer21(W)}.bind(this),V=new s();V.addSubscriptions(q.listen("focus",null,U.bind(this)),q.listen(t.START,null,U.bind(this)));this.$MCommentComposer8=V}};S.prototype.$MCommentComposer36=function(event){"use strict";var T=event.getData(),U=T.input,V=this.$MCommentComposer43(U);if(!V)return;this.$MCommentComposer15&&this.$MCommentComposer15.logInitPhoto()};S.prototype.$MCommentComposer38=function(event){"use strict";var T=event.getData(),U=T.ufi,V=T.logKeys;if(!U||!V||!j.contains(U,this.$MCommentComposer1))return;V.forEach(function(W){return this.$MCommentComposer15&&this.$MCommentComposer15.logRender(W)}.bind(this))};S.prototype.$MCommentComposer37=function(event){"use strict";__p&&__p();var T=event.getData(),U=T.commentNode,V=T.loggingInteractionKey;if(!U||!V)return;var W=q.hasSigil(U,L),X=null;if(this.$MCommentComposer14&&W){var Y=n.bySigil(U.parentNode,M);X=Y&&j.scry(Y,"*",G)[0]}else if(!W&&!this.$MCommentComposer14){X=n.bySigil(U,F);if(!X&&this.$MCommentComposer13){var Z=n.bySigil(U,C);X=j.scry(Z,"*",H)[0]}}else return;var $=X&&j.scry(X,"*",E)[0];if(!this.$MCommentComposer40($))return;this.$MCommentComposer15&&this.$MCommentComposer15.logRender(V)};S.prototype.$MCommentComposer44=function(){"use strict";if(this.$MCommentComposer2&&this.$MCommentComposer2.target_id&&!this.$MCommentComposer3&&Q())this.$MCommentComposer3=new m(this.$MCommentComposer2.target_id,this.$MCommentComposer2.parent_comment_id,this.$MCommentComposer2.actor_id)};S.prototype.$MCommentComposer41=function(){"use strict";if(!Q())return;this.$MCommentComposer44();this.$MCommentComposer3&&this.$MCommentComposer3.attemptPublishStartEvent()};S.prototype.$MCommentComposer35=function(){"use strict";if(!Q())return;this.$MCommentComposer44();this.$MCommentComposer3&&this.$MCommentComposer3.attemptPublishStopEvent()};e.exports=S}),null);
__d("MJSPlaceholder",["DOM","Stratcom","StratcomManager","Parent"],(function a(b,c,d,e,f,g,h,i,j,k){__p&&__p();var l={init:function m(n,o){__p&&__p();var p=n.getElementsByTagName("textarea")[0];function q(event){if(!p.value)h.show(o);else h.hide(o)}var r=i.listen("MJSPlaceholder",null,q),s="oninput"in p,t=h.listen(p,s?"input":"change",null,q),u=k.byTag(p,"form");if(u){j.enableDispatch(u,"reset");var v=h.listen(u,"reset",null,q)}var w=s?null:h.listen(p,"keyup",null,q);i.listen("m:page:unload",null,function(){i.removeCurrentListener();t.remove();v&&v.remove();w&&w.remove();r.remove()})}};f.exports=l}),null);
__d("URLMatcher",["URLMatcherConfig"],(function a(b,c,d,e,f,aa,g){__p&&__p();var h="!\"#%&'()*,-./:;<>?@[\\]^_`{|}",i="\u2000-\u206f\xab\xbb\uff08\uff09",j="(?:25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])",k="(?:(?:ht|f)tps?)://",l="(?:(?:"+j+"[.]){3}"+j+")",m="\\[(?:(?:[A-Fa-f0-9]{1,4}::?){1,7}[A-Fa-f0-9]{1,4})\\]",n="(?:\\b)www\\d{0,3}[.]",o="[^\\s"+h+i+"]",p="(?:(?:(?:[.:\\-_%@]|"+o+")*"+o+")|"+m+")",q="(?::\\d+){0,1}",r="(?=[/?#])",s=g.tlds,t="(?:(?:"+k+p+q+")|(?:"+l+q+")|(?:"+m+q+")|(?:"+n+p+s+q+")|(?:"+p+s+q+r+"))",u="[/#?]",v="\\([^\\s()<>]+\\)",w="[^\\s()<>?#]+",x=new RegExp(t,"im"),y="^\\[[0-9]{1,4}:[0-9]{1,4}:[A-Fa-f0-9]{1,4}\\]",z=new RegExp(y,"im"),A="(?:(?:"+u+")(?:(?:"+v+"|"+w+")*)*)*",B=new RegExp("((?:"+t+")(?:"+A+"))","im"),C=new RegExp("((?:"+k+p+q+")|(?:"+n+p+s+q+"))"),D=/[\s\'\";]/,E=new RegExp(u,"im"),F=new RegExp("[\\s!\"#%&'()*,./:;<>?@[\\]^`{|}\xab\xbb\u2000-\u206f\uff08\uff09]","im"),G=new RegExp("[\\s()<>?#]","im"),H=new RegExp("\\s()<>"),I=function I(P){if(P&&P.indexOf("@")!=-1)return C.exec(P)?P:null;else return P},J=function J(P){return K(P,B)},K=function K(P,Q){var R=(Q.exec(P)||[])[1]||null;return I(R)},L=function L(P){return x.exec(P)},M=function M(P){return!D.test(P.charAt(P.length-1))},N=function N(P){__p&&__p();do{var Q=x.exec(P);if(!Q)return null;var R=false;if(Q[0][0]==="["&&Q.index>0&&P[Q.index-1]==="@"){var S=z.exec(Q[0]);if(S){R=true;P=P.substr(Q.index+S[0].length)}}}while(R);var T=P.substr(Q.index+Q[0].length);if(T.length===0||!E.test(T[0]))return I(Q[0]);var U=0,V=0,W=1,X=0,Y=V;for(var Z=1;Z<T.length;Z++){var $=T[Z];if(Y===V){if($==="("){X=X+1;Y=W}else if(E.test($)||!F.test($))U=Z;else if(G.test($))break}else if($==="(")X=X+1;else if($===")"){X=X-1;if(X===0){Y=V;U=Z}}else if(H.test($))break}return I(Q[0]+T.substring(0,U+1))},O={};O.permissiveMatch=J;O.matchToPattern=K;O.matchHost=L;O.trigger=M;O.match=N;f.exports=O}),null);
__d("getHashtagRegexString",[],(function a(b,c,d,e,f,g){function h(){var i="\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u024f\u0253-\u0254\u0256-\u0257\u0259\u025b\u0263\u0268\u026f\u0272\u0289\u028b\u02bb\u0300-\u036f\u1e00-\u1eff",j="\u0400-\u04ff\u0500-\u0527\u2de0-\u2dff\ua640-\ua69f\u0591-\u05bf\u05c1-\u05c2\u05c4-\u05c5\u05c7\u05d0-\u05ea\u05f0-\u05f4\ufb12-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4f\u0610-\u061a\u0620-\u065f\u066e-\u06d3\u06d5-\u06dc\u06de-\u06e8\u06ea-\u06ef\u06fa-\u06fc\u06ff\u0750-\u077f\u08a0\u08a2-\u08ac\u08e4-\u08fe\ufb50-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\u200c-\u200c\u0e01-\u0e3a\u0e40-\u0e4e\u1100-\u11ff\u3130-\u3185\ua960-\ua97f\uac00-\ud7af\ud7b0-\ud7ff\uffa1-\uffdc",k=String.fromCharCode,l="\u30a1-\u30fa\u30fc-\u30fe\uff66-\uff9f\uff10-\uff19\uff21-\uff3a\uff41-\uff5a\u3041-\u3096\u3099-\u309e\u3400-\u4dbf\u4e00-\u9fff"+k(173824)+"-"+k(177983)+k(177984)+"-"+k(178207)+k(194560)+"-"+k(195103)+"\u3003\u3005\u303b",m=i+j+l,n="A-Za-z\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u0241\u0250-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ee\u037a\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03ce\u03d0-\u03f5\u03f7-\u0481\u048a-\u04ce\u04d0-\u04f9\u0500-\u050f\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0621-\u063a\u0640-\u064a\u066e-\u066f\u0671-\u06d3\u06d5\u06e5-\u06e6\u06ee-\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u076d\u0780-\u07a5\u07b1\u0904-\u0939\u093d\u0950\u0958-\u0961\u097d\u0985-\u098c\u098f-\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc-\u09dd\u09df-\u09e1\u09f0-\u09f1\u0a05-\u0a0a\u0a0f-\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32-\u0a33\u0a35-\u0a36\u0a38-\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2-\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0-\u0ae1\u0b05-\u0b0c\u0b0f-\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32-\u0b33\u0b35-\u0b39\u0b3d\u0b5c-\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99-\u0b9a\u0b9c\u0b9e-\u0b9f\u0ba3-\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c60-\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0-\u0ce1\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d60-\u0d61\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32-\u0e33\u0e40-\u0e46\u0e81-\u0e82\u0e84\u0e87-\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa-\u0eab\u0ead-\u0eb0\u0eb2-\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6a\u0f88-\u0f8b\u1000-\u1021\u1023-\u1027\u1029-\u102a\u1050-\u1055\u10a0-\u10c5\u10d0-\u10fa\u10fc\u1100-\u1159\u115f-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1681-\u169a\u16a0-\u16ea\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u1900-\u191c\u1950-\u196d\u1970-\u1974\u1980-\u19a9\u19c1-\u19c7\u1a00-\u1a16\u1d00-\u1dbf\u1e00-\u1e9b\u1ea0-\u1ef9\u1f00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u2094\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2131\u2133-\u2139\u213c-\u213f\u2145-\u2149\u2c00-\u2c2e\u2c30-\u2c5e\u2c80-\u2ce4\u2d00-\u2d25\u2d30-\u2d65\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u3005-\u3006\u3031-\u3035\u303b-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312c\u3131-\u318e\u31a0-\u31b7\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fbb\ua000-\ua48c\ua800-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\uac00-\ud7a3\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc",o="\u0300-\u036f\u0483-\u0486\u0591-\u05b9\u05bb-\u05bd\u05bf\u05c1-\u05c2\u05c4-\u05c5\u05c7\u0610-\u0615\u064b-\u065e\u0670\u06d6-\u06dc\u06df-\u06e4\u06e7-\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u0901-\u0903\u093c\u093e-\u094d\u0951-\u0954\u0962-\u0963\u0981-\u0983\u09bc\u09be-\u09c4\u09c7-\u09c8\u09cb-\u09cd\u09d7\u09e2-\u09e3\u0a01-\u0a03\u0a3c\u0a3e-\u0a42\u0a47-\u0a48\u0a4b-\u0a4d\u0a70-\u0a71\u0a81-\u0a83\u0abc\u0abe-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ae2-\u0ae3\u0b01-\u0b03\u0b3c\u0b3e-\u0b43\u0b47-\u0b48\u0b4b-\u0b4d\u0b56-\u0b57\u0b82\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd7\u0c01-\u0c03\u0c3e-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55-\u0c56\u0c82-\u0c83\u0cbc\u0cbe-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5-\u0cd6\u0d02-\u0d03\u0d3e-\u0d43\u0d46-\u0d48\u0d4a-\u0d4d\u0d57\u0d82-\u0d83\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0df2-\u0df3\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb-\u0ebc\u0ec8-\u0ecd\u0f18-\u0f19\u0f35\u0f37\u0f39\u0f3e-\u0f3f\u0f71-\u0f84\u0f86-\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102c-\u1032\u1036-\u1039\u1056-\u1059\u135f\u1712-\u1714\u1732-\u1734\u1752-\u1753\u1772-\u1773\u17b6-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u192b\u1930-\u193b\u19b0-\u19c0\u19c8-\u19c9\u1a17-\u1a1b\u1dc0-\u1dc3\u20d0-\u20dc\u20e1\u20e5-\u20eb\u302a-\u302f\u3099-\u309a\ua802\ua806\ua80b\ua823-\ua827\ufb1e\ufe00-\ufe0f\ufe20-\ufe23",p="0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u17e0-\u17e9\u1810-\u1819\u1946-\u194f\u19d0-\u19d9\uff10-\uff19",q=n+o+m,r=p+"_",s=q+r,t="["+q+"]",u="["+s+"]",v="^|$|[^&/"+s+"]",w="[#\\uFF03]",x="("+v+")("+w+")("+u+"*"+t+u+"*)";return x}f.exports=h}),null);
__d("getHashtagRegex",["getHashtagRegexString"],(function a(b,c,d,e,f,g,h){function i(){return new RegExp(h(),"ig")}f.exports=i}),null);
__d("HashtagParser",["URLMatcher","getHashtagRegex"],(function a(b,c,d,e,f,g,h,i){__p&&__p();var j=100,k=30,l=/@\[([0-9]+):([0-9]+):((?:[^\\\]]*(?:\\.)*)*)\]/g;function m(E){__p&&__p();var F=z(E),G=0,H=0;return o(E).map(function(I){while(G<F.length){var J=F[G],K=J.offset-H;if(K<I.offset){H+=J.token.length-J.name.length;G++}else break}return{marker:I.marker,tag:I.hashtag,rawOffset:I.offset+H,offset:I.offset}})}function n(E){return p(E,u(E))}function o(E){var F=B(E);return p(F,q(E,F))}function p(E,F){return s(E).slice(0,k).filter(function(G){var H=w(G.offset,G.hashtag.length,F);return!H&&G.hashtag.length<=j})}function q(E,F){return v(t(E),u(F))}var r=i();function s(E){var F=[];E.replace(r,function(G,H,I,J,K){F.push({marker:I,hashtag:J,offset:K+H.length})});return F}function t(E){return C(E).map(function(F){return[F.offset,F.name.length]})}function u(E){var F=[],G,H=0;while(G=h.permissiveMatch(E)){var I=E.indexOf(G);F.push([H+I,G.length]);E=E.substring(I+G.length);H+=I+G.length}return F}function v(E,F){var G=[],H=0,I=0,J=0;while(H<E.length&&I<F.length)if(E[H][0]>F[I][0])G[J++]=F[I++];else G[J++]=E[H++];return G.concat(E.slice(H),F.slice(I))}function w(E,F,G){if(!G)return false;var H=y(G,E);return x(E,F,G,H)||x(E,F,G,H+1)}function x(E,F,G,H){if(!G[H])return false;var I=G[H][0],J=G[H][1];return!(E+F-1<I||E>I+J-1)}function y(E,F){__p&&__p();var G=0,H=E.length-1;while(G<=H){var I=Math.floor((G+H)/2),J=E[I][0];if(J==F)return I;else if(J<F)G=I+1;else H=I-1}return H}function z(E){var F=[];E.replace(l,function(G,H,I,J,K){F.push({token:G,id:H,type:I,name:J,offset:K})});return F}function A(E){return E?E.replace(/\\([^\\])/g,"$1").replace(/\\\\/g,"\\"):null}function B(E){return E.replace(l,function(F,G,H,I,J){return A(I)})}function C(E){var F=0,G=0;return z(E).map(function(H){var I=E.indexOf(H.token,G);G=I+1;I-=F;var J=A(H.name);F+=H.token.length-J.length;if(I>=0)return{id:H.id,name:J,type:H.type,offset:I}})}var D={};D.parse=m;D.parseWithoutMentions=n;f.exports=D}),null);
__d("MMentions",["CancelableEventListener","MLegacyDataStore","DOM","HashtagParser","HTML","MJSEnvironment","MParent","MViewport","Scroll","Stratcom","StratcomManager","Style","TouchEventType","Vector","debounceCore","eventsMixinDeprecated","getActiveElement","fbt","setIntervalAcrossTransitions","setTimeoutAcrossTransitions"],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A){__p&&__p();var B={};function C(G){var H=B[G];if(!H){H="<br>\n".repeat(G.length);B[G]=H}return H}function D(G,H){var I=Math.sqrt(Math.pow(G.x-H.x,2)+Math.pow(G.y-H.y,2));return I<=5}function E(G,H,I){"use strict";__p&&__p();F.call(this);this._mentionId=G.id;this._bottomMargin=null;var J=G.getElementsByTagName("textarea")[0];this.minDistance=E._MIN_DISTANCE;this._listeners=[];this._editListeners=[];this._query=null;this._queryResult=null;this._focused=false;this._disabled=false;this._hasHashtags=false;this._ignoreFocusChange=false;this._ignoreFocusChangeTimeout=null;this.shouldShowHashtags=false;this._enforceStringMatch=true;this._typeObjects=null;this._typeObjectsOrder=null;this._uids={};this._weakReferences={};this._source=H;this._element=G;this._input=J;this._queryStringMatcher=/[^\s]+$/;this._bodyTouchStartLocation=null;this._suggestionTouchStartData=null;this._suggestionTouchendSelectFallbackTimer=null;var K=i.get(this._input);this._initialWeakReferences=K.initial_weak_references?K.initial_weak_references:{};this._eventData={input:this._input,hasTags:false};this._shadow=j.create("div",{className:"mentions-shadow","aria-hidden":true},"");this._measurer=j.create("div",{className:"mentions-measurer","aria-hidden":true});E._suggestion=E._suggestion||j.create("div",{className:"mentions-suggest"});E._prevInsertParent=E._prevInsertParent||null;this._hiddenInput=j.create("input",{type:"hidden",name:J.name,sigil:"mentionsHiddenInput"});J.removeAttribute("name");j.uniqID(J);this._syncStyles(this._shadow);this._syncStyles(this._measurer);r.enableDispatch(J,"cut");r.enableDispatch(J,"paste");r.enableDispatch(J,"scroll");this._listeners.push(j.listen(J,"blur",null,this._onFocusChange),j.listen(J,"focus",null,this._onFocusChange),j.listen(this._input,"scroll",null,this._syncShadow));this._listeners.push(q.listen("MMentions:update",null,this._sync),q.listen("MMentions:reset",null,this._syncAndParse),q.listen("MMentions:removeHiddenInput",null,this._removeHiddenInput.bind(this)),q.listen("MMentions:disable",null,this._disable.bind(this)),q.listen("MMentions:enable",null,this._enable.bind(this)));if(this._input.form){r.enableDispatch(this._input.form,"reset");this._listeners.push(j.listen(this._input.form,"submit",null,this._onSubmit),j.listen(this._input.form,"reset",null,this._onEdit))}this._listeners.push(q.listen("MMentions:decorations:hide",null,function(event){j.hide(this._shadow);j.hide(this._measurer)}.bind(this)));this._listeners.push(q.listen("MMentions:decorations:show",null,function(event){j.show(this._shadow);j.show(this._measurer)}.bind(this)));var L=document.createDocumentFragment();L.appendChild(this._hiddenInput);L.appendChild(this._shadow);L.appendChild(this._measurer);G.appendChild(L);this._insertParent=I||n.bySigil(G,"m-mentions-insert-parent")||s.getScrollParent(G);if(this._input.value)this._parse(this._input.value)}E.prototype._mountIntoInsertParent=function(){"use strict";var G=this._insertParent;if(G!==E._prevInsertParent)j.remove(E._suggestion);if(G===window)o.appendNode(E._suggestion);else j.appendContent(G,E._suggestion);E._prevInsertParent=G};E.prototype.dispose=function(){"use strict";__p&&__p();if(!this._disposed){while(this._listeners.length)this._listeners.pop().remove();while(this._editListeners.length)this._editListeners.pop().remove();clearTimeout(this._inputTimer);clearTimeout(this._hideSuggestionTimer);clearTimeout(this._forceInputPositionTimer);this._clearSuggestionTouchendSelectFallbackTimer();this._releaseSuggestion();j.remove(this._hiddenInput);j.remove(this._shadow);j.remove(this._measurer);j.remove(E._suggestion);E._prevInsertParent=null;for(var G in this)delete this[G];this._disposed=true}};E.prototype.setTypeObjects=function(G){"use strict";this._typeObjects=G};E.prototype.setTypeObjectsOrder=function(G){"use strict";this._typeObjectsOrder=G};E.prototype.disableStringMatch=function(){"use strict";this._enforceStringMatch=false};E.prototype.insertMention=function(G){"use strict";__p&&__p();var H=G.name+this._NAME_SUFFIX,I=this._uids[H],J=this._input,K=J.value;if(!I)I=this._uids[H]=[];if(I.indexOf(G.uid)===-1)I.push(G.uid);else{J.focus();return}var L=J.selectionStart,M=J.selectionEnd,N=K.substring(0,L),O=K.substr(M+1);J.value=N+H+" "+O;var P=J.value.length-O.length;if(m.IS_APPLE_WEBKIT_IOS){this.setIgnoreFocusChange(true);J.blur();J.focus();this.setIgnoreFocusChange(false)}J.setSelectionRange(P,P);q.invoke("MJSPlaceholder");J.focus();this._tagsUpdated();this._sync()};E.prototype._getExpandElement=function(){"use strict";return n.bySigil(this._element,"m-mentions-expand")||this._element};E.prototype._focus=function(){"use strict";__p&&__p();if(this._focused)return;this._focused=true;if(!this._editListeners.length){var G=E._suggestion,H=this._SUGGESTION_SIGIL,I=this._updatePosition.bind(this);this._editListeners.push(q.listen("scroll",null,function(event){var J=event.getTarget();I(event);this.setIgnoreFocusChange(false)}.bind(this)),this._source.listen("waiting",this._hideSuggestion),this._source.listen("resultsready",this._onQueryResult),j.listen(this._input,"touchmove",null,this._syncShadow),j.listen(this._input,"keydown",null,this._onBeforeEdit),j.listen(this._input,"keyup",null,this._onEdit),j.listen(this._input,"input",null,this._onEdit),j.listen(this._input,"cut",null,this._onEdit),j.listen(this._input,"paste",null,this._onEdit),j.listen(document.body,t.START,null,this._onBodyTouchStart),j.listen(document.body,t.END,null,this._onBodyTouchEndOrClick),j.listen(document.body,"click",null,this._onBodyTouchEndOrClick),j.listen(this._input,t.START,null,this._hideSuggestion),h.listen(G,t.END,H,this._onSuggestionTouch),j.listen(G,t.START,H,this._onSuggestionTouch),j.listen(G,"click",H,this._onSuggestionClick))}if(!this._source._startedByMentions){this._source._startedByMentions=true;this._source.didChange("");this._source.didStart()}this._hideSuggestion();clearTimeout(this._forceInputPositionTimer);this._forceInputPositionTimer=A(this._forceInputPosition,100);this._sync()};E.prototype._blur=function(){"use strict";__p&&__p();if(!this._focused||x()===this._input)return;delete this._focused;while(this._editListeners.length)this._editListeners.pop().remove();this._suggestionTouchStartData=null;this._bodyTouchStartLocation=null;clearTimeout(this._forceInputPositionTimer);clearTimeout(this._inputTimer);delete this._forceInputPositionTimer;this._clearBottomMargin();this._hideSuggestion(true);this._sync()};E.prototype.getIgnoreFocusChange=function(){"use strict";return this._ignoreFocusChange};E.prototype.setIgnoreFocusChange=function(G){"use strict";this._ignoreFocusChange=G};E.prototype._clearSuggestionTouchendSelectFallbackTimer=function(){"use strict";if(this._suggestionTouchendSelectFallbackTimer){clearTimeout(this._suggestionTouchendSelectFallbackTimer);this._suggestionTouchendSelectFallbackTimer=null}};E.prototype._onSuggestionItemClickedOrTapped=function(G){"use strict";this._clearSuggestionTouchendSelectFallbackTimer();this.setIgnoreFocusChange(false);this._onSuggestionSelect(this._queryResult[G.queryIndex]);this._hideSuggestion(true);this._input.focus()};E.prototype._onSuggestionSelect=function(G){"use strict";__p&&__p();var H=this._input,I=H.selectionStart;if(I!==H.selectionEnd)return;var J=H.value,K=this._query,L=G.getAttribute("display"),M=this._createRegex(L,"i"),N=this._createRegex(K,"i"),O=L+this._NAME_SUFFIX,P,Q,R=J.substring(I-K.length,I);if(!N.test(R))return;if(M.test(J.substring(I-L.length,I)))P=J.substring(0,I-L.length);else if(N.test(J)){var S=R.substr(-K.length);if(S===K){P=J.substring(0,I-K.length);var T="";for(var U=0,V=O.length;U<V;U++){T+=O.charAt(U);if(P.endsWith(T))break}if(P.endsWith(" "+T)||P===T)P=P.substr(0,P.lastIndexOf(T))}else return}else return;if(P&&P.charAt(P.length-1)==="@")P=P.slice(0,-1);Q=P+O+J.substring(I);H.value=Q;I+=Q.length-J.length;if(m.IS_APPLE_WEBKIT_IOS){this.setIgnoreFocusChange(true);H.blur();H.focus();this.setIgnoreFocusChange(false)}H.setSelectionRange(I,I);var W=this._uids[O];if(!W)W=this._uids[O]=[];if(W.indexOf(G.getAttribute("uid"))===-1){W.push(G.getAttribute("uid"));this._tagsUpdated()}if(G.getAttribute("weak_reference"))this._weakReferences[G.getAttribute("uid")]=true;this._sync()};E.prototype._clearBottomMargin=function(){"use strict";var G=this._getExpandElement();G.style.marginBottom=this._bottomMargin||""};E.prototype._assignSuggestion=function(){"use strict";i.get(E._suggestion).mentionId=this._mentionId};E.prototype._releaseSuggestion=function(){"use strict";i.get(E._suggestion).mentionId=null};E.prototype._isInstanceSuggestion=function(){"use strict";return i.get(E._suggestion).mentionId===this._mentionId};E.prototype._showSuggestion=function(){"use strict";__p&&__p();this._assignSuggestion();if(this._suggestionShown)return;this._suggestionShown=true;this._mountIntoInsertParent();var G=this._input,H=E._suggestion;s.apply(H,{display:"block",width:G.offsetWidth+"px"});G.setAttribute("spellcheck","false");G.setAttribute("autocapitalize","off");G.setAttribute("autocorrect","off");if(this._bottomMargin===undefined)this._bottomMargin=this._getExpandElement().style.marginBottom;var I=this.minDistance,J=G.getBoundingClientRect(),K=document.elementFromPoint(1,J.bottom+I);if(!K){var L=this._getExpandElement();L.style.marginBottom=I+"px";if(!n.bySigil(L,"scroll-area")){var M=o.getScroll();o.scrollTo(M.x,Math.max(M.y,M.y+J.top-30))}}if(this._hideSuggestionTimer){clearTimeout(this._hideSuggestionTimer);delete this._hideSuggestionTimer}};E.prototype._onBackSpaceKey=function(event){"use strict";__p&&__p();var G=this._input,H=G.selectionStart;if(H!==G.selectionEnd)return;var I=G.value,J=this._getTokenByCursorPosition(H-1);if(J){var K=I.substring(0,H),L=J.name;if(K.indexOf(L)===K.length-L.length){var M;if(E._CJK_ALTER_NAME.test(L))M=this._trim(L.replace(E._CJK_ALTER_NAME,""));else if(E._LATIN_ALTER_NAME.test(L))M=this._trim(L.replace(E._LATIN_ALTER_NAME,""));else{var N=L.split(/\s+/g);if(N.length>1){N.pop();M=N.join(" ")}}if(M){M+=this._NAME_SUFFIX;this._uids[L].splice(this._uids[L].indexOf(J.uid),1);this._uids[M]=this._uids[M]||[];this._uids[M].push(J.uid);I=I.substr(0,H-L.length)+M+I.substr(H);H-=L.length-M.length;G.value=I;G.setSelectionRange(H,H);event.prevent();this._sync();return}}}var O;while(true){var P=I.charAt(H-1);if(P==="\u200b"){I=I.substring(0,H-2)+I.substr(H);H-=1;O=true}else break}if(O){event.prevent();I=I.substring(0,H-2)+I.substr(H);G.value=I}};E.prototype._buildSectionHeader=function(G){"use strict";if(G==null)return null;return new l(G.xhp).getFragment().firstChild};E.prototype._buildNoResultEntry=function(){"use strict";var G=j.create("i",{className:"mentions-suggest-item-img noResultsIcon"}),H=j.create("span",{className:"no-results"},y._("No Results")),I=j.create("label",{className:"mentions-suggest-item"},G,H);I.appendChild(G);I.appendChild(H);return I};E.prototype._disable=function(G){"use strict";this._disabled=true};E.prototype._enable=function(){"use strict";this._disabled=false};E.prototype._syncMentionedUIDs=function(){"use strict";__p&&__p();var G=this._input.value;if(!G){this._uids={};return}var H=false;for(var I in this._uids){var J=this._createRegex(I,"g"),K=G.match(J);if(!K||!K.length){delete this._uids[I];H=true;continue}var L=this._uids[I];if(!L.length)delete this._uids[I];else if(L.length>K.length)L.length=K.length}if(H)this._tagsUpdated()};E.prototype._syncHashtags=function(){"use strict";var G=this._input.value;if(this.shouldShowHashtags)this._hasHashtags=E._HASHTAG_TRIGGER.test(G)};E.prototype._syncMeasurer=function(){"use strict";__p&&__p();var G=this._input,H=G.value;if(!H){j.setContent(this._measurer,"");return}var I=G.selectionStart,J=G.selectionEnd;if(I!==J)return;var K=j.create("div",{},G.value.substr(0,I));this._measurer.innerHTML=K.innerHTML+"<br><div></div>"};E.prototype._syncValue=function(){"use strict";__p&&__p();var G=this._input.value;for(var H in this._uids){var I=this._createRegex(H,"g"),J=this._uids[H],K=0;G=G.replace(I,function(L){var M=parseInt(J[K++],10);if(M)return"@["+M+":"+L+"]";else return L})}G=G.replace(/\u200B/g,"");if(this._hiddenInput.value!==G)this.invoke("change",G);this._hiddenInput.value=G};E.prototype._syncStyles=function(G){"use strict";var H=getComputedStyle(this._input,null),I=G.style,J=["fontSize","fontFamily","letterSpacing","lineHeight","paddingTop","paddingLeft","paddingRight","paddingBottom","textIndent","wordSpacing"];while(J.length){var K=J.pop();I[K]=H[K]}};E.prototype._getTokenByCursorPosition=function(G){"use strict";__p&&__p();var H=this._input.value,I=null,J=this._uids;for(var K in J){if(I)break;var L=H.indexOf(K);if(L<0)continue;var M=this._createRegex(K,"g"),N=0;H.replace(M,function(O,P){if(!I&&G>P&&G<P+O.length)I={name:K,uid:J[K][N]};N++})}return I};E.prototype._trim=function(G){"use strict";return G.trim?G.trim():G.replace(/(^\s*)|(\s*$)/g,"")};E.prototype._createRegex=function(G,H){"use strict";G=G.replace(E._REGEX_SPECIAL_CHARS,"\\$&");return new RegExp(G,H)};E.prototype._tagsUpdated=function(){"use strict";this._eventData.hasTags=Object.keys(this._uids).length>0;this._eventData.numTags=Object.keys(this._uids).length;q.invoke("MMentions:change",null,this._eventData)};E.prototype._removeHiddenInput=function(){"use strict";j.remove(this._hiddenInput)};var F=function F(){__p&&__p();this._onSubmit=function(){var G=this._input.value,H=z(function(){if(this._disposed)clearInterval(H);else if(this._input.value!==G){this._sync();clearInterval(H)}}.bind(this),100);A(function(){clearInterval(H)},1e4)}.bind(this);this._onFocusChange=function(G){if(this._suggestionShown&&this._ignoreFocusChange)return;switch(G.getType()){case"focus":if(G.getTarget()===this._input)this._focus();else this._blur();break;default:this._blur();break}}.bind(this);this._forceInputPosition=function(){var G=this._input.getBoundingClientRect(),H=o.getHeight();if(G.top<0||G.top>H){this._forceInputPositionTimer=A(this._forceInputPosition,16);return}if(x()!==this._input){this._blur();return}}.bind(this);this._onSuggestionTouch=function(event){__p&&__p();if(!this._suggestionShown){event.prevent();this._suggestionTouchStartData=null;return}var G=event.getType();if(G==="touchstart"){this._clearSuggestionTouchendSelectFallbackTimer();var H=event.getTouch(),I=H.clientX,J=H.clientY;this._suggestionTouchStartData={startItem:event.getNode(this._SUGGESTION_SIGIL),startLoc:{x:I,y:J}}}else if(G==="touchend"&&this._suggestionTouchStartData){var K=this._suggestionTouchStartData,L=K.startItem,M=K.startLoc,N=event.getNode(this._SUGGESTION_SIGIL),O=event.getTouch(),P=O.clientX,Q=O.clientY,R={x:P,y:Q};this._suggestionTouchStartData=null;if(L===N&&D(M,R)){this._clearSuggestionTouchendSelectFallbackTimer();this._suggestionTouchendSelectFallbackTimer=setTimeout(function(){this._onSuggestionItemClickedOrTapped(N)}.bind(this),350);return}}this.setIgnoreFocusChange(true)}.bind(this);this._onSuggestionClick=function(event){if(!this._suggestionShown){event.prevent();return}this._onSuggestionItemClickedOrTapped(event.getNode(this._SUGGESTION_SIGIL));this._suggestionTouchStartData=null}.bind(this);this._onBodyTouchStart=function(event){var G=event.getTouch(),H=G.clientX,I=G.clientY;this._bodyTouchStartLocation={x:H,y:I}}.bind(this);this._onBodyTouchEndOrClick=function(event){__p&&__p();var G=event.getTarget();if(E._suggestion===G||this._element===G||this._element.contains(G)||E._suggestion.contains(G))return;var H=this._bodyTouchStartLocation;if(event.getType()==="touchend"&&H){this._bodyTouchStartLocation=null;var I=event.getTouch(),J=I.clientX,K=I.clientY,L={x:J,y:K};if(!D(H,L))return}this._blur()}.bind(this);this._hideSuggestion=function(G){if(this._suggestionShown){delete this._suggestionShown;clearTimeout(this._hideSuggestionTimer);if(G===true){delete this._hideSuggestionTimer;this._hideSuggestionInternal()}else this._hideSuggestionTimer=A(this._hideSuggestionInternal,350)}}.bind(this);this._hideSuggestionInternal=function(){__p&&__p();delete this._hideSuggestionTimer;if(this._isInstanceSuggestion()){this._releaseSuggestion();j.hide(E._suggestion);j.setContent(E._suggestion,"")}this._input.removeAttribute("spellcheck");this._input.removeAttribute("autocapitalize");this._input.removeAttribute("autocorrect");this._clearBottomMargin()}.bind(this);this._updatePosition=function(){__p&&__p();if(!this._suggestionShown)return;var G=E._suggestion,H=G.offsetHeight,I=this._input,J=I.offsetHeight,K=u.getElementPosition(I),L=I.getBoundingClientRect(),M=G.offsetParent,N;if(M===document.documentElement)N=new u(0,0);else N=u.getElementPosition(M);var O=L.left-N.x,P=K.y-N.y,Q=o.getHeight()/2,R=O,S=P+J,T=L.bottom+H>Q&&L.top-H>=0;if(T)S=P-H;s.apply(G,{left:R+"px",top:S+"px"})}.bind(this);this._onBeforeEdit=function(event){if(!this._focused)return;if(this._inputTimer)clearTimeout(this._inputTimer);switch(event.getRawEvent().keyCode){case 8:this._onBackSpaceKey(event);break}}.bind(this);this._onEdit=function(event){if(this._inputTimer)clearTimeout(this._inputTimer);switch(event.getRawEvent().keyCode){case 13:this._hideSuggestion();this._syncShadow();return;default:this._sync();this._inputTimer=A(this._processInput,160)}}.bind(this);this._processInput=function(){__p&&__p();if(this._disabled)return;this._sync();this._onQueryResult(null,null);this._hideSuggestion();this._query=null;this._inputTimer=null;var G=this._input,H=G.value,I=G.selectionStart;if(I!==G.selectionEnd)return;var J=H.charAt(I);if(J&&!/\s/.test(J))return;var K=G.value.substr(0,I),L=K.match(this._queryStringMatcher);if(!L)return;var M=L[0],N;if(M.charAt(0)==="@"){M=M.slice(1);N=M.length>0}else N=M.length>2&&(E._EN_NAMES.test(M)||E._JP_SYLLABARY_CHARS.test(M)||E._CJK_CHARS.test(M));var O=K.lastIndexOf("@");if(O>-1){M=K.substr(O+1);N=true}N=N&&!this._getTokenByCursorPosition(I);if(N){this._query=M;this._source.didChange(M);this._source.didStart()}}.bind(this);this._onQueryResult=function(G){__p&&__p();var H=G&&G.length>0,I=this._query&&this._input.value.indexOf(this._query)>=0;if(!I||!H||this._disposed)return;this._hideSuggestion();this._queryResult=null;if(this._enforceStringMatch&&!this._createRegex(this._query,"ig").test(G[0].getAttribute("display")))return;var J=[],K=document.createDocumentFragment(),L=0,M={};for(var N in this._uids){var O=this._uids[N];for(var P=0,Q=O.length;P<Q;P++)M[O[P]]=true}var R=function R(Z){__p&&__p();if(!M[Z.getAttribute("uid")]){Z.htmlFor=this._input.id;q.addSigil(Z,this._SUGGESTION_SIGIL);q.addSigil(Z,"touchable");i.set(Z,{nativeClick:true});Z.queryIndex=L;K.appendChild(Z);J[L]=Z;L++;if(L>5)return true}};if(this._typeObjects&&this._typeObjectsOrder){var S={};for(var T=0;T<G.length;T++){var U=G[T].getAttribute("renderType");if(!U)continue;if(!(U in S))S[U]=[];S[U].push(G[T])}for(var V=0;V<this._typeObjectsOrder.length;V++){U=this._typeObjectsOrder[V];var W=this._typeObjects[U],X=S[U],Y=X?X.filter(function(Z){return!M[Z.getAttribute("uid")]}):[];if(Y.length>0){K.appendChild(this._buildSectionHeader(W));Y.some(R,this)}else if(W.show_always){K.appendChild(this._buildSectionHeader(W));K.appendChild(this._buildNoResultEntry())}}}else G.some(R,this);if(L){j.setContent(E._suggestion,"");this._queryResult=J;E._suggestion.appendChild(K);this._showSuggestion();this._updatePosition()}}.bind(this);this._syncAndParse=function(){if(!this._disposed&&!this._disabled){if(this._input&&this._input.value)this._parse(this._input.value);this._sync()}}.bind(this);this._sync=function(){if(!this._disposed&&!this._disabled){this._syncMentionedUIDs();this._syncHashtags();this._syncShadow();this._syncMeasurer();this._syncValue()}}.bind(this);this._parse=function(G){__p&&__p();this._uids={};var H=/[0-9]+/,I=/^@\[(?:[0-9]+:){2}(.+)\]/,J=G.match(E._MENTIONS_REGEX);if(J){for(var K=0;K<J.length;K++){var L=J[K].match(H),M=J[K].match(I);M=M?M[1].replace(/\\([^\\])/g,"$1").replace(/\\\\/g,"\\"):null;if(!M)continue;if(!this._uids[M])this._uids[M]=[];this._uids[M].push(L);G=G.replace(J[K],M)}this._input.value=G}this._sync()}.bind(this);this._renderHashtags=function(G){if(!this._hasHashtags)return j.htmlize(G);var H=k.parseWithoutMentions(G),I=[],J=0;for(var K=0;K<H.length;K++){I.push(j.htmlize(G.substring(J,H[K].offset)),'<span class="mentions-highlight">',G.charAt(H[K].offset),H[K].hashtag,"</span>");J=H[K].offset+H[K].hashtag.length+1}I.push(j.htmlize(G.substring(J)));return I.join("")}.bind(this);this._syncShadow=function(G){__p&&__p();var H=this._input,I=H.value,J=this._shadow;if(!I){j.setContent(J,"");return}if(G&&(G.getType()==="scroll"||G.getType()==="touchmove")){p.setTop(J,p.getTop(H));p.setLeft(J,p.getLeft(H));return}var K="\u200b{\u200b",L="\u200b}",M="\u200b{\u200b\u200b}",N,O=function O(P,V){var W=this._uids[P][N],X=this._weakReferences[W]||this._initialWeakReferences[W];N++;return(X?M:K)+V+K};for(var P in this._uids){var Q=this._createRegex(P,"g");N=0;I=I.replace(Q,O.bind(this,P))}var R=I.split(K),S=[],T=false;for(var U=0;U<R.length;U++){if(T)if(R[U].startsWith(L))S.push('<span class="mentions-highlight-weak-reference">',j.htmlize(R[U].substr(L.length)),"</span>");else S.push('<span class="mentions-highlight">',j.htmlize(R[U]),"</span>");else S.push(this._renderHashtags(R[U]));T=!T}I=S.join("");I=I.replace(/\n+$/,C);if(this._shadowHTML!==I){this._shadowHTML=I;J.innerHTML=I}p.setTop(J,p.getTop(H));p.setLeft(J,p.getLeft(H))}.bind(this)};Object.assign(E,{_MENTIONS_REGEX:/@\[([0-9]+)\:(([^\\\]]*(?:\\.)*)*)\]/g,_EN_NAMES:/^[A-Z][a-z]{1}/,_CJK_ALTER_NAME:/\uff08[^\uff09]+\uff09(\u200B\u200B)?$/g,_LATIN_ALTER_NAME:/\([^\)]+\)(\u200B\u200B)?$/g,_JP_SYLLABARY_CHARS:/(^[\u3040-\u309F]{3,3})|(^[\u30A0-\u30FF]{3,3})/g,_CJK_CHARS:/^[\u4E00-\u9FFF\uF900-\uFAFF\u3400-\u4DBF]{2,2}/g,_REGEX_SPECIAL_CHARS:/[\/\.\*\+\?\}\(\)\[\]\{\}\\]/g,_HASHTAG_TRIGGER:/[#\uFF03]/,_MIN_DISTANCE:130});Object.assign(E.prototype,{_NAME_SUFFIX:"\u200b\u200b",_SUGGESTION_SIGIL:"mentionsSuggestionItem",_COMPOSER_SIGIL:"composer-textarea"});w(E,["change"]);f.exports=E}),null);
__d("MMentionsRenderer",["DOM"],(function a(b,c,d,e,f,g,h){__p&&__p();var i={createSuggestionNode:function j(k){__p&&__p();var l=h.create("img",{src:k.photo,className:"mentions-suggest-item-img"}),m=h.create("div",{className:"mentions-suggest-item-text"});m.appendChild(h.create("span",{className:"mentions-suggest-item-name"},k.display));if(k.subtext){var n=k.subtext;if(k.type&&k.type!="user")n=n?k.type+" \xb7 "+n:k.type;m.appendChild(h.create("span",{className:"mentions-suggest-item-subtext"},n))}var o=h.create("label",{className:"mentions-suggest-item",display:k.display,uid:k.id,rel:k.id,photo:k.photo,subtext:k.subtext},l,m);o.appendChild(l);o.appendChild(m);if(k.weak_reference)o.setAttribute("weak_reference","y");if(k.renderType)o.setAttribute("renderType",k.renderType);return o}};f.exports=i}),null);
__d("MTypeaheadTouchSourceShowOnFocus",["MRequest","MTypeaheadTouchSource","Stratcom"],(function a(b,c,d,e,f,g,h,i,j){__p&&__p();var k,l;k=babelHelpers.inherits(m,i);l=k&&k.prototype;function m(n,o,p){"use strict";__p&&__p();l.constructor.call(this,n,o);this.uri=n;this._bootstrapData=[];this._query=null;this._isFocused=false;this.maximumResultCount=p||5;if(o==="work_position_inference"){var q=j.listen("MProfileEditWork:dataChanged",null,function(r){var s=r.getData().existing_fields;if(s)this.updateBootstrapData(s)}.bind(this));j.listen("m:page:unload",null,function(){q.remove();j.removeCurrentListener()})}}m.prototype.updateBootstrapData=function(n){"use strict";var o=new h(this.uri);o.addData({existing_fields_json:JSON.stringify(n)});o.setMethod("POST");o.listen("done",function(p){this._bootstrapData=[];if(p.payload!==undefined)this.ondata(p.payload)}.bind(this));o.send()};m.prototype.showOnFocus=function(){"use strict";if(this._isFocused&&this._query===""){var n=this.renderNodes(null,this._bootstrapData);this.invoke("resultsready",n);this.invoke("complete")}};m.prototype.ondata=function(n){"use strict";i.prototype.ondata.call(this,n);var o=Math.min(n.length,this.getMaximumResultCount());for(var p=0;p<o;++p)if(n[p].uid)this._bootstrapData.push(n[p].uid);this.showOnFocus()};m.prototype.setQuery=function(n){"use strict";this._query=n};m.prototype.setIsFocused=function(n){"use strict";this._isFocused=n};m.prototype.didChange=function(n){"use strict";this._query=n};m.prototype.getMaximumResultCount=function(){"use strict";return this.maximumResultCount};f.exports=m}),null);
__d("MMentionsBootstrapDataSource",["MMentionsRenderer","MTypeaheadTouchSourceShowOnFocus"],(function a(b,c,d,e,f,g,h,i){__p&&__p();var j,k;j=babelHelpers.inherits(l,i);k=j&&j.prototype;function l(m,n){"use strict";k.constructor.call(this,m,n)}l.prototype.createNode=function(m){"use strict";return h.createSuggestionNode(m)};f.exports=l}),null);
__d("MMentionsOnDemandDataSource",["MMentionsRenderer","MTypeaheadOnDemandSource"],(function a(b,c,d,e,f,g,h,i){__p&&__p();var j,k;j=babelHelpers.inherits(l,i);k=j&&j.prototype;function l(m){"use strict";k.constructor.call(this,m)}l.prototype.createNode=function(m){"use strict";return h.createSuggestionNode(m)};f.exports=l}),null);
__d("InitMMentions",["MMentions","MMentionsBootstrapDataSource","MMentionsOnDemandDataSource","Stratcom","TypeaheadCompositeSource","MLegacyDataStore"],(function a(b,c,d,e,f,g,h,i,j,k,l,m){__p&&__p();var n={},o={},p={},q={main:function r(s){__p&&__p();var t=s.element;if(!t)return;if(!t.getBoundingClientRect)return;var u=[],v=s.sources.bootstrapped||[],w=s.sources.online||[],x=s.typeObjects,y=s.typeObjectsOrder,z=null,A="|",B="",C=[];v.forEach(function(E){z=new i(E.src,E.source_key);var F=E.source_key+A+E.src;if(!n[F])n[F]=z;u.push(n[F]);C.push(F)});w.forEach(function(E){var F=A+E.src;if(!o[F])o[F]=new j(E.src);u.push(o[F]);C.push(F)});if(!u.length)return;B=C.join(A);if(!(B in p))p[B]=new l(u);var D=new h(t,p[B]);D.setTypeObjects(x);D.setTypeObjectsOrder(y);D.shouldShowHashtags=s.shouldShowHashtags;if(!s.enforceStringMatch)D.disableStringMatch();m.set(t,{mentionsInstance:D});k.listen("m:page:unload-complete",null,function(event){if(!document.documentElement.contains(t)){k.removeCurrentListener();D.dispose();D=null;t=null}})}};f.exports=q}),null);